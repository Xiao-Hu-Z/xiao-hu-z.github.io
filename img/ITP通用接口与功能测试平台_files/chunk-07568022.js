(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-07568022"],{"0376":function(e,t,a){"use strict";a("a5fd")},"0690":function(e,t,a){},"086b":function(e,t,a){"use strict";a("2292")},"0ee2":function(e,t,a){"use strict";a("df28")},1160:function(e,t,a){"use strict";a("6dbb")},"129f":function(e,t){e.exports=Object.is||function(e,t){return e===t?0!==e||1/e===1/t:e!=e&&t!=t}},"17eb":function(e,t,a){},2292:function(e,t,a){},"25b8":function(e,t,a){"use strict";a.r(t);var i,s=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("a-tabs",{staticClass:"card-container",staticStyle:{marginTop:"-10px"},attrs:{animated:!1},on:{change:e.onChange},model:{value:e.activeKey,callback:function(t){e.activeKey=t},expression:"activeKey"}},[a("a-tab-pane",{key:"testGroup"},[a("span",{attrs:{slot:"tab"},slot:"tab"},[e._v(" 用例集合 "),a("a-tooltip",[a("template",{staticStyle:{fontSize:"10px"},slot:"title"},[e._v(" 点击切换版本 ")]),a("a-icon",{attrs:{type:e.showVersionIcon?"down-circle":"up-circle",theme:"twoTone"},on:{click:e.handleVersion}})],2)],1),a("case-group",{ref:"testGroup",staticClass:"detail-content"})],1),a("a-tab-pane",{key:"globalSetting",attrs:{tab:"全局设置"}},[a("global-setting",{ref:"globalSetting",staticClass:"detail-content"})],1),a("a-tab-pane",{key:"history",attrs:{tab:"操作记录"}},[a("history",{staticClass:"detail-content",attrs:{"record-data":e.recordData}})],1)],1)},n=[],o=a("1da1"),r=(a("96cf"),function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[e.showEditVersion?a("div",{staticClass:"top-bar"},[e.currentVersion?a("div",{staticClass:"basic-btn"},[a("a-select",{staticStyle:{width:"190px"},attrs:{"default-value":e.currentVersion.id,disabled:!e.ifExtraVersion},on:{change:e.changeVersion}},e._l(e.groupExistVersions,(function(t){return a("a-select-option",{key:t.id,attrs:{value:t.id,title:t.name}},[t.name.length>=20?a("a-tooltip",[a("template",{slot:"title"},[e._v(" "+e._s(t.name)+" ")]),e._v(" "+e._s(t.name)+" ")],2):a("span",[e._v(" "+e._s(t.name)+" ")])],1)})),1),a("a-button",{staticStyle:{"margin-left":"10px"},attrs:{icon:"branches",disabled:!e.ifExtraVersion},on:{click:e.handleBranchState}}),a("a-switch",{staticStyle:{margin:"5px 10px"},attrs:{"default-unchecked":"",disabled:!(""===e.versionId||"-1"===e.versionId),"checked-children":"已开启多版本","un-checked-children":"已停用多版本"},on:{change:e.onVersionSwitchChange},model:{value:e.ifExtraVersion,callback:function(t){e.ifExtraVersion=t},expression:"ifExtraVersion"}})],1):e._e()]):e._e(),a("split-pane",{attrs:{"min-percent":18,"default-percent":18,split:"vertical"}},[a("template",{slot:"paneL"},[a("tree-node",{ref:"treenode"})],1),a("template",{slot:"paneR"},[a("right-detail",{staticClass:"param-code-view",on:{updateTitleSuc:function(t){return e.$refs.treenode.updateTreeNodeName(t)},createSuiteSuc:function(t){return e.$refs.treenode.addSuite(t)},createCaseSuc:function(t){return e.$refs.treenode.addCase(t)},createSetupSuc:function(t){return e.$refs.treenode.addSetup(t)},createTearDownSuc:function(t){return e.$refs.treenode.addTearDown(t)},chooseSuiteSuc:function(t){return e.$refs.treenode.copyOrMove(t)},handleVersionSuc:function(t){return e.$refs.treenode.queryTreeNode()},clickMasterCase:function(t){return e.$refs.treenode.clickMasterCase()},clickVerisonCase:function(t){return e.$refs.treenode.clickVerisonCase(t)}}})],1)],2),a("a-modal",{attrs:{title:"分支管理",width:800,"body-style":{height:"500px",overflow:"auto"},footer:null},on:{cancel:e.branchCancle},model:{value:e.isBranchShow,callback:function(t){e.isBranchShow=t},expression:"isBranchShow"}},[a("div",{staticStyle:{"margin-bottom":"10px"}},[a("a-input",{staticStyle:{width:"300px"},attrs:{placeholder:"请输入分支名称"},model:{value:e.newVersionName,callback:function(t){e.newVersionName=t},expression:"newVersionName"}}),a("a-button",{staticStyle:{"margin-left":"10px"},attrs:{type:"primary"},on:{click:e.handleInputConfirm}},[e._v(" 创建 ")])],1),a("a-table",{attrs:{"data-source":e.ExistVersion,columns:e.branchColumn,"row-key":function(e){return e.id},pagination:!1},scopedSlots:e._u([{key:"name",fn:function(t,i){return a("div",{},[i.isEdit?e._e():a("span",[e._v(e._s(t))]),i.isEdit?a("a-input",{ref:"version"+i.id,model:{value:e.editVersionName,callback:function(t){e.editVersionName=t},expression:"editVersionName"}}):e._e()],1)}},{key:"action",fn:function(t,i){return a("div",{},[i.isEdit?e._e():a("div",[a("a",{on:{click:function(t){return e.dbclickEdit(i)}}},[e._v("编辑")]),a("a",{staticStyle:{"margin-left":"10px"},on:{click:function(t){return e.deleteVersion(i)}}},[e._v("删除")])]),i.isEdit?a("div",[a("a",{on:{click:function(a){return e.saveEditVersion(i,t)}}},[e._v("保存")]),a("a",{staticStyle:{"margin-left":"10px"},on:{click:function(t){return e.cancleEditVersion(i)}}},[e._v("取消")])]):e._e()])}}])})],1),a("a-modal",{attrs:{title:"Yapi",width:1e3,"body-style":{height:"500px",overflow:"auto"}},model:{value:e.isYapiUpdateShow,callback:function(t){e.isYapiUpdateShow=t},expression:"isYapiUpdateShow"}},[e.isYapiUpdateShow?a("div",[a("a-table",{attrs:{size:"middle","data-source":e.yapiTableData,columns:e.yapiColumn,"row-key":function(e){return e.apiId},pagination:e.yapiTableData.length>8&&{pageSize:8}},scopedSlots:e._u([{key:"caseId",fn:function(t,i){return a("div",{},[t.toString().startsWith("无")||0!==i.versionId?e._e():a("a",{attrs:{href:"#/testgroup/"+e.$route.params.id+"/"+t+"?productId="+e.$route.query.productId,target:"_blank"}},[e._v(" "+e._s(t)+" ")]),t.toString().startsWith("无")||0===i.versionId?e._e():a("a",{attrs:{href:"#/testgroup/"+e.$route.params.id+"/"+t+"?productId="+e.$route.query.productId+"&versionId="+i.versionId,target:"_blank"}},[e._v(" "+e._s(t)+" ")]),t.toString().startsWith("无")?a("span",[e._v(" "+e._s(t)+" ")]):e._e()])}},{key:"apiCheckbox",fn:function(t,i){return a("a-checkbox",{attrs:{checked:e.apiCheckbox[i.caseId],disabled:""}})}}],null,!1,3118669597)})],1):e._e(),a("div",{attrs:{slot:"footer"},slot:"footer"},[a("a-button",{attrs:{type:"primary"},on:{click:e.confirmUpdate}},[e._v(" 已更新确定按钮 ")]),a("a-button",{on:{click:e.handleCancel}},[e._v(" 不处理 ")])],1)])],1)}),c=[],l=a("5530"),d=(a("5319"),a("ac1f"),a("2ca0"),a("d3b7"),a("25f0"),a("b0c0"),a("159b"),a("2f62")),u=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"tree-node"},[a("a-input-search",{staticStyle:{margin:"5px 0px"},attrs:{placeholder:e.getSearchInpputPlaceholder(),disabled:"2"===this.treeSearchValue&&!e.uriSearchCheckedKeys.length},on:{search:e.getTreeDataSearch,change:e.getTreeDataSearch},model:{value:e.searchValue,callback:function(t){e.searchValue=t},expression:"searchValue"}},[a("a-select",{staticStyle:{width:"70px"},attrs:{slot:"addonBefore"},on:{change:e.changeTreeSearchValue},slot:"addonBefore",model:{value:e.treeSearchValue,callback:function(t){e.treeSearchValue=t},expression:"treeSearchValue"}},e._l(e.treeSearchOption,(function(t){return a("a-select-option",{key:t.id,attrs:{value:t.id}},[e._v(" "+e._s(t.name)+" ")])})),1)],1),a("div",{directives:[{name:"show",rawName:"v-show",value:!e.uriSearch,expression:"!uriSearch"}]},[e.handleTreeSearch&&e.curCaseTreeNodesSearch.length?a("a-tree",{staticClass:"leftTree",attrs:{multiple:e.isMultiple,"tree-data":e.curCaseTreeNodesSearch,"selected-keys":e.selectedKeys,"expanded-keys":e.SearchExpandedKeys,"auto-expand-parent":e.autoExpandParent,"default-expand-parent":e.defaultExpandParent,"show-line":e.showLine,"show-icon":e.showIcon,"block-node":!1},on:{"update:expandedKeys":function(t){e.SearchExpandedKeys=t},"update:expanded-keys":function(t){e.SearchExpandedKeys=t},expand:e.onExpand,select:e.onSelect},scopedSlots:e._u([{key:"title",fn:function(t){return[a("a-dropdown",{attrs:{trigger:["contextmenu"]},on:{visibleChange:function(a){return e.clickTitle(t,a)}}},[a("a-menu",{attrs:{slot:"overlay"},slot:"overlay"},[e.isSetupOrTeardown(t)||"-1"!==e.versionId?e._e():a("a-menu-item",{key:"1",attrs:{disabled:"true"}},[a("a",{on:{click:e.copyOrMoveTo}},[e._v("复制/移动")])]),e.isCase(t)?e._e():a("a-menu-item",{key:"2"},[a("a",{on:{click:e.createSuite}},[e._v("新建目录")])]),e.isCase(t)?e._e():a("a-menu-item",{key:"3"},[a("a",{on:{click:function(t){return e.createCase()}}},[e._v("新建用例")])]),e.isCase(t)||e.hasSetup(t)||"-1"!==t.dataRef.data.versionId&&""!==t.dataRef.data.versionId?e._e():a("a-menu-item",{key:"4"},[a("a",{on:{click:function(t){return e.createSetup()}}},[e._v("新建SETUP")])]),e.isCase(t)||e.hasTeardown(t)||"-1"!==t.dataRef.data.versionId&&""!==t.dataRef.data.versionId?e._e():a("a-menu-item",{key:"9"},[a("a",{on:{click:function(t){return e.createTearDown()}}},[e._v("新建TEARDOWN")])]),e.isCase(t)?e._e():a("a-menu-item",{key:"11"},[a("a",{on:{click:function(t){return e.$refs.detectionDlg.openCheck("suite")}}},[e._v("检测")])]),e.isCase(t)||"-1"===t.dataRef.data.versionId||""===t.dataRef.data.versionId||"root"!==t.dataRef.data.type?e._e():a("a-sub-menu",{key:"12"},[a("span",{staticStyle:{display:"inline-block","margin-right":"5px",color:"#333"},attrs:{slot:"title"},slot:"title"},[e._v(" 版本操作 ")]),e._l(e.versionBtns,(function(t){return[a("a-menu-item",{key:t.id,on:{click:e.changeVersionHandle}},[e._v(" "+e._s(t.name)+" ")])]}))],2),-1===["root","setup","teardown"].indexOf(t.data.type)?a("a-menu-item",{key:"5",staticClass:"copy-quick-key"},[a("a",{staticStyle:{display:"inline-block"},on:{click:function(t){return e.moveTreeNode(!0)}}},[e._v(" 快捷复制 ")]),a("span",{staticClass:"quick-key"},[e._v(" optionC")])]):e._e(),e.isSetupOrTeardown(t)?e._e():a("a-menu-item",{key:"6",staticClass:"copy-quick-key"},[a("a",{staticStyle:{display:"inline-block"},on:{click:function(t){return e.movePasteTreeNode(e.quickOptionType)}}},[e._v(" 快捷粘贴 ")]),a("span",{staticClass:"quick-key"},[e._v(" optionV")])]),e.isSetupOrTeardown(t)||"root"===t.data.type||"-1"!==e.versionId?e._e():a("a-menu-item",{key:"7",staticClass:"copy-quick-key"},[a("a",{staticStyle:{display:"inline-block"},on:{click:function(t){return e.moveTreeNode(!1)}}},[e._v(" 快捷剪切 ")]),a("span",{staticClass:"quick-key"},[e._v(" optionX")])]),e.isCase(t)?a("a-menu-item",{key:"14",staticClass:"copy-quick-key"},[a("a",{staticStyle:{display:"inline-block"},on:{click:e.dupCopy}},[e._v(" dup复制 ")]),a("span",{staticClass:"quick-key"},[e._v(" optionD")])]):e._e(),"-1"===e.versionId||"-1"!==e.versionId&&e.isCase(t)?a("a-menu-item",{key:"8"},["-1"===e.versionId?a("a",{on:{click:function(a){return e.treeNodeDelete(t)}}},[e._v(" 删除 "),a("span",{staticClass:"quick-key"},[e._v(" D")])]):a("a",{on:{click:function(a){return e.deleteApIBatchVersion(t)}}},[e._v(" 删除 "),a("span",{staticClass:"quick-key"},[e._v(" D")])])]):e._e()],1),a("span",[a("a",{ref:"title"+t.key},[0===t.isConflict?a("span",{staticClass:"tree-node-title",class:{"is-conflict":0!==t.isConflict,"is-stop":0!==t.data.status}},[e.searchMatch(t.title,e.searchValue)?a("span",[e._v(" "+e._s(e.getFirstSubStr(t.title,e.searchValue))+" "),a("span",{staticStyle:{color:"#f50"}},[e._v(e._s(e.searchValue))]),e._v(" "+e._s(e.getLastSubStr(t.title,e.searchValue))+" ")]):a("span",{staticStyle:{"{display":"none}"}},[e._v(" "+e._s(t.title)+" ")])]):a("span",{staticClass:"tree-node-title",class:{"is-conflict":0!==t.isConflict,"is-stop":0!==t.data.status}},[a("a-tooltip",[a("template",{slot:"title"},[e._v(" "+e._s(e.getTitleHover(t))+" ")]),e.searchMatch(t.title,e.searchValue)?a("span",[e._v(" "+e._s(e.getFirstSubStr(t.title,e.searchValue))+" "),a("span",{staticStyle:{color:"#f50"}},[e._v(e._s(e.searchValue))]),e._v(" "+e._s(e.getLastSubStr(t.title,e.searchValue))+" ")]):a("span",{staticStyle:{"{display":"none}"}},[e._v(" "+e._s(t.title)+" ")])],2)],1)])])],1),e.selectTreeNode&&t.key===e.selectTreeNode.dataRef.key&&e.selectedFalse?a("a-dropdown",[a("a-menu",{attrs:{slot:"overlay"},slot:"overlay"},[e._e(),e.isSetupOrTeardown(t)||"-1"!==e.versionId?e._e():a("a-menu-item",{key:"1"},[a("a",{on:{click:e.copyOrMoveTo}},[e._v("复制/移动")])]),e.isCase(t)?e._e():a("a-menu-item",{key:"2"},[a("a",{on:{click:e.createSuite}},[e._v("新建目录")])]),e.isCase(t)?e._e():a("a-menu-item",{key:"3"},[a("a",{on:{click:function(t){return e.createCase()}}},[e._v("新建用例")])]),e.isCase(t)||e.hasSetup(t)||"-1"!==t.dataRef.data.versionId&&""!==t.dataRef.data.versionId?e._e():a("a-menu-item",{key:"4"},[a("a",{on:{click:function(t){return e.createSetup()}}},[e._v("新建SETUP")])]),e.isCase(t)||e.hasTeardown(t)||"-1"!==t.dataRef.data.versionId&&""!==t.dataRef.data.versionId?e._e():a("a-menu-item",{key:"9"},[a("a",{on:{click:function(t){return e.createTearDown()}}},[e._v("新建TEARDOWN")])]),e.isCase(t)?e._e():a("a-menu-item",{key:"11"},[a("a",{on:{click:function(t){return e.$refs.detectionDlg.openCheck("suite")}}},[e._v("检测")])]),e.isCase(t)||"-1"===t.dataRef.data.versionId||""===t.dataRef.data.versionId||"root"!==t.dataRef.data.type?e._e():a("a-sub-menu",{key:"12"},[a("span",{staticStyle:{display:"inline-block","margin-right":"5px",color:"#333"},attrs:{slot:"title"},slot:"title"},[e._v(" 版本操作 ")]),e._l(e.versionBtns,(function(t){return[a("a-menu-item",{key:t.id,on:{click:e.changeVersionHandle}},[e._v(" "+e._s(t.name)+" ")])]}))],2),-1===["root","setup","teardown"].indexOf(t.data.type)?a("a-menu-item",{key:"5",staticClass:"copy-quick-key"},[a("a",{staticStyle:{display:"inline-block"},on:{click:function(t){return e.moveTreeNode(!0)}}},[e._v(" 快捷复制 ")]),a("span",{staticClass:"quick-key"},[e._v(" optionC")])]):e._e(),e.isSetupOrTeardown(t)?e._e():a("a-menu-item",{key:"6",staticClass:"copy-quick-key"},[a("a",{staticStyle:{display:"inline-block"},on:{click:function(t){return e.movePasteTreeNode(e.quickOptionType)}}},[e._v(" 快捷粘贴 ")]),a("span",{staticClass:"quick-key"},[e._v(" optionV")])]),e.isSetupOrTeardown(t)||"root"===t.data.type||"-1"!==e.versionId?e._e():a("a-menu-item",{key:"7",staticClass:"copy-quick-key"},[a("a",{staticStyle:{display:"inline-block"},on:{click:function(t){return e.moveTreeNode(!1)}}},[e._v(" 快捷剪切 ")]),a("span",{staticClass:"quick-key"},[e._v(" optionX")])]),e.isCase(t)?a("a-menu-item",{key:"14",staticClass:"copy-quick-key"},[a("a",{staticStyle:{display:"inline-block"},on:{click:e.dupCopy}},[e._v(" dup复制 ")]),a("span",{staticClass:"quick-key"},[e._v(" optionD")])]):e._e(),"-1"===e.versionId||"-1"!==e.versionId&&e.isCase(t)?a("a-menu-item",{key:"8"},["-1"===e.versionId?a("a",{on:{click:function(a){return e.treeNodeDelete(t)}}},[e._v(" 删除 "),a("span",{staticClass:"quick-key"},[e._v(" D")])]):a("a",{on:{click:function(a){return e.deleteApIBatchVersion(t)}}},[e._v(" 删除 "),a("span",{staticClass:"quick-key"},[e._v(" D")])])]):e._e()],1),a("a-icon",{staticClass:"more-btn",attrs:{type:"more"}})],1):e._e()]}}],null,!1,173019250)},[a("a-icon",{attrs:{slot:"case",theme:"-1"===e.versionId?"twoTone":"outlined",type:"play-circle"},slot:"case"}),a("a-icon",{attrs:{slot:"setup",type:"plus-circle",theme:"-1"===e.versionId?"twoTone":"outlined"},slot:"setup"}),a("a-icon",{attrs:{slot:"teardown",type:"minus-circle",theme:"-1"===e.versionId?"twoTone":"outlined"},slot:"teardown"}),a("a-icon",{attrs:{slot:"other",type:"folder",theme:"-1"===e.versionId?"twoTone":"outlined"},slot:"other"}),a("a-icon",{attrs:{slot:"expend",type:"folder-open",theme:"-1"===e.versionId?"twoTone":"outlined"},slot:"expend"})],1):e._e(),!e.handleTreeSearch&&!e.caseTreeNodes.length||e.handleTreeSearch&&!e.curCaseTreeNodesSearch.length?a("a-spin",{staticStyle:{margin:"60px"},attrs:{tip:e.handleTreeSearch?"搜索中...":"加载中..."}}):e._e(),!e.handleTreeSearch&&e.caseTreeNodes.length?a("a-tree",{staticClass:"leftTree",attrs:{multiple:e.isMultiple,"tree-data":e.caseTreeNodes,"selected-keys":e.selectedKeys,"expanded-keys":e.expandedKeys,"loaded-keys":e.loadedKeys,"auto-expand-parent":e.autoExpandParent,"default-expand-parent":e.defaultExpandParent,"show-line":e.showLine,"show-icon":e.showIcon,"load-data":e.onLoadData,"block-node":!1,draggable:""},on:{"update:expandedKeys":function(t){e.expandedKeys=t},"update:expanded-keys":function(t){e.expandedKeys=t},expand:e.onExpand,select:e.onSelect,dragenter:e.onDragEnter,drop:e.onDrop,dragstart:e.onDragStart},scopedSlots:e._u([{key:"title",fn:function(t){return[a("a-dropdown",{attrs:{trigger:["contextmenu"]},on:{visibleChange:function(a){return e.clickTitle(t,a)}}},[a("a-menu",{attrs:{slot:"overlay"},slot:"overlay"},[e.isSetupOrTeardown(t)||"-1"!==e.versionId?e._e():a("a-menu-item",{key:"1"},[a("a",{on:{click:e.copyOrMoveTo}},[e._v("复制/移动")])]),e.isCase(t)?e._e():a("a-menu-item",{key:"2"},[a("a",{on:{click:e.createSuite}},[e._v("新建目录")])]),e.isCase(t)?e._e():a("a-menu-item",{key:"3"},[a("a",{on:{click:function(t){return e.createCase()}}},[e._v("新建用例")])]),e.isCase(t)||e.hasSetup(t)||"-1"!==t.dataRef.data.versionId&&""!==t.dataRef.data.versionId?e._e():a("a-menu-item",{key:"4"},[a("a",{on:{click:function(t){return e.createSetup()}}},[e._v("新建SETUP")])]),e.isCase(t)||e.hasTeardown(t)||"-1"!==t.dataRef.data.versionId&&""!==t.dataRef.data.versionId?e._e():a("a-menu-item",{key:"9"},[a("a",{on:{click:function(t){return e.createTearDown()}}},[e._v("新建TEARDOWN")])]),e.isCase(t)?e._e():a("a-menu-item",{key:"11"},[a("a",{on:{click:function(t){return e.$refs.detectionDlg.openCheck("suite")}}},[e._v("检测")])]),e.isCase(t)||"-1"===t.dataRef.data.versionId||""===t.dataRef.data.versionId||"root"!==t.dataRef.data.type?e._e():a("a-sub-menu",{key:"12"},[a("span",{staticStyle:{display:"inline-block","margin-right":"5px",color:"#333"},attrs:{slot:"title"},slot:"title"},[e._v(" 版本操作 ")]),e._l(e.versionBtns,(function(t){return[a("a-menu-item",{key:t.id,on:{click:e.changeVersionHandle}},[e._v(" "+e._s(t.name)+" ")])]}))],2),-1===["root","setup","teardown"].indexOf(t.data.type)?a("a-menu-item",{key:"5",staticClass:"copy-quick-key"},[a("a",{staticStyle:{display:"inline-block"},on:{click:function(t){return e.moveTreeNode(!0)}}},[e._v(" 快捷复制 ")]),a("span",{staticClass:"quick-key"},[e._v(" optionC")])]):e._e(),e.isSetupOrTeardown(t)?e._e():a("a-menu-item",{key:"6",staticClass:"copy-quick-key"},[a("a",{staticStyle:{display:"inline-block"},on:{click:function(t){return e.movePasteTreeNode(e.quickOptionType)}}},[e._v(" 快捷粘贴 ")]),a("span",{staticClass:"quick-key"},[e._v(" optionV")])]),e.isSetupOrTeardown(t)||"root"===t.data.type||"-1"!==e.versionId?e._e():a("a-menu-item",{key:"7",staticClass:"copy-quick-key"},[a("a",{staticStyle:{display:"inline-block"},on:{click:function(t){return e.moveTreeNode(!1)}}},[e._v(" 快捷剪切 ")]),a("span",{staticClass:"quick-key"},[e._v(" optionX")])]),e.isCase(t)?a("a-menu-item",{key:"14",staticClass:"copy-quick-key"},[a("a",{staticStyle:{display:"inline-block"},on:{click:e.dupCopy}},[e._v(" dup复制 ")]),a("span",{staticClass:"quick-key"},[e._v(" optionD")])]):e._e(),"-1"===e.versionId||"-1"!==e.versionId&&e.isCase(t)?a("a-menu-item",{key:"8"},["-1"===e.versionId?a("a",{on:{click:function(a){return e.treeNodeDelete(t)}}},[e._v(" 删除 "),a("span",{staticClass:"quick-key"},[e._v(" D")])]):a("a",{on:{click:function(a){return e.deleteApIBatchVersion(t)}}},[e._v(" 删除 "),a("span",{staticClass:"quick-key"},[e._v(" D")])])]):e._e()],1),a("span",[a("a",{ref:"title"+t.key,attrs:{id:""+t.key}},[0===t.isConflict?a("span",{staticClass:"tree-node-title",class:{"is-conflict":0!==t.isConflict,"is-stop":0!==t.data.status}},[e._v(" "+e._s(t.title)+" ")]):a("span",{staticClass:"tree-node-title",class:{"is-conflict":0!==t.isConflict,"is-stop":0!==t.data.status}},[a("a-tooltip",[a("template",{slot:"title"},[e._v(" "+e._s(e.getTitleHover(t))+" ")]),e._v(" "+e._s(t.title)+" ")],2)],1)])])],1),e.selectTreeNode&&t.key===e.selectTreeNode.dataRef.key&&e.selectedFalse?a("a-dropdown",[a("a-menu",{attrs:{slot:"overlay"},slot:"overlay"},[e._e(),e.isSetupOrTeardown(t)||"-1"!==e.versionId?e._e():a("a-menu-item",{key:"1"},[a("a",{on:{click:e.copyOrMoveTo}},[e._v("复制/移动")])]),e.isCase(t)?e._e():a("a-menu-item",{key:"2"},[a("a",{on:{click:e.createSuite}},[e._v("新建目录")])]),e.isCase(t)?e._e():a("a-menu-item",{key:"3"},[a("a",{on:{click:function(t){return e.createCase()}}},[e._v("新建用例")])]),e.isCase(t)||e.hasSetup(t)||"-1"!==t.dataRef.data.versionId&&""!==t.dataRef.data.versionId?e._e():a("a-menu-item",{key:"4"},[a("a",{on:{click:function(t){return e.createSetup()}}},[e._v("新建SETUP")])]),e.isCase(t)||e.hasTeardown(t)||"-1"!==t.dataRef.data.versionId&&""!==t.dataRef.data.versionId?e._e():a("a-menu-item",{key:"9"},[a("a",{on:{click:function(t){return e.createTearDown()}}},[e._v("新建TEARDOWN")])]),e.isCase(t)?e._e():a("a-menu-item",{key:"11"},[a("a",{on:{click:function(t){return e.$refs.detectionDlg.openCheck("suite")}}},[e._v("检测")])]),e.isCase(t)||"-1"===t.dataRef.data.versionId||""===t.dataRef.data.versionId||"root"!==t.dataRef.data.type?e._e():a("a-sub-menu",{key:"12"},[a("span",{staticStyle:{display:"inline-block","margin-right":"5px",color:"#333"},attrs:{slot:"title"},slot:"title"},[e._v(" 版本操作 ")]),e._l(e.versionBtns,(function(t){return[a("a-menu-item",{key:t.id,on:{click:e.changeVersionHandle}},[e._v(" "+e._s(t.name)+" ")])]}))],2),-1===["root","setup","teardown"].indexOf(t.data.type)?a("a-menu-item",{key:"5",staticClass:"copy-quick-key"},[a("a",{staticStyle:{display:"inline-block"},on:{click:function(t){return e.moveTreeNode(!0)}}},[e._v(" 快捷复制 ")]),a("span",{staticClass:"quick-key"},[e._v(" optionC")])]):e._e(),e.isSetupOrTeardown(t)?e._e():a("a-menu-item",{key:"6",staticClass:"copy-quick-key"},[a("a",{staticStyle:{display:"inline-block"},on:{click:function(t){return e.movePasteTreeNode(e.quickOptionType)}}},[e._v(" 快捷粘贴 ")]),a("span",{staticClass:"quick-key"},[e._v(" optionV")])]),e.isSetupOrTeardown(t)||"root"===t.data.type||"-1"!==e.versionId?e._e():a("a-menu-item",{key:"7",staticClass:"copy-quick-key"},[a("a",{staticStyle:{display:"inline-block"},on:{click:function(t){return e.moveTreeNode(!1)}}},[e._v(" 快捷剪切 ")]),a("span",{staticClass:"quick-key"},[e._v(" optionX")])]),e.isCase(t)?a("a-menu-item",{key:"14",staticClass:"copy-quick-key"},[a("a",{staticStyle:{display:"inline-block"},on:{click:e.dupCopy}},[e._v(" dup复制 ")]),a("span",{staticClass:"quick-key"},[e._v(" optionD")])]):e._e(),"-1"===e.versionId||"-1"!==e.versionId&&e.isCase(t)?a("a-menu-item",{key:"8"},["-1"===e.versionId?a("a",{staticStyle:{display:"flex"},on:{click:function(a){return e.treeNodeDelete(t)}}},[a("span",[e._v("删除")]),a("span",{staticClass:"quick-key"},[e._v(" D")])]):a("a",{on:{click:function(a){return e.deleteApIBatchVersion(t)}}},[e._v(" 删除 "),a("span",{staticClass:"quick-key"},[e._v(" D")])])]):e._e()],1),a("a-icon",{staticClass:"more-btn",attrs:{type:"more"}})],1):e._e()]}}],null,!1,2172955713)},[a("a-icon",{attrs:{slot:"case",theme:"-1"===e.versionId?"twoTone":"outlined",type:"play-circle"},slot:"case"}),a("a-icon",{attrs:{slot:"setup",type:"plus-circle",theme:"-1"===e.versionId?"twoTone":"outlined"},slot:"setup"}),a("a-icon",{attrs:{slot:"teardown",type:"minus-circle",theme:"-1"===e.versionId?"twoTone":"outlined"},slot:"teardown"}),a("a-icon",{attrs:{slot:"other",type:"folder",theme:"-1"===e.versionId?"twoTone":"outlined"},slot:"other"}),a("a-icon",{attrs:{slot:"expend",type:"folder-open",theme:"-1"===e.versionId?"twoTone":"outlined"},slot:"expend"})],1):e._e()],1),a("uri-search-tree",{directives:[{name:"show",rawName:"v-show",value:e.uriSearch,expression:"uriSearch"}],attrs:{"case-tree-nodes-uri-search":e.caseTreeNodesUriSearch},on:{uriSearchCheckedKeys:function(t){return e.getUriSearchCheckedKeys(t)}}}),a("copy-or-move",{ref:"copyOrMove",on:{chooseSuiteSuc:function(t){return e.copyOrMove(t)},inCopyOrMoveSuc:function(t){return e.inCopyOrMove(t)}}}),a("create-suite",{ref:"createSuite",on:{createSuiteSuc:function(t){return e.addSuite(t)}}}),a("create-case",{ref:"createCase",on:{createCaseSuc:function(t){return e.addCase(t)}}}),a("dynamic-data",{ref:"dynamicData"}),a("detection-dlg",{ref:"detectionDlg"}),a("branch-version",{ref:"branchVersion",on:{handleSuc:function(t){return e.queryTreeNode()}}}),a("update-base-info",{ref:"updateBaseInfo",on:{updateTitleSuc:function(t){return e.updateTreeNodeName(t)}}})],1)},p=[],h=a("2909"),f=(a("1276"),a("a9e3"),a("a434"),a("99af"),a("c740"),a("841c9"),a("229c")),m=a("0f66"),y=a("b775"),v=function(e){return Object(y["a"])({method:"POST",url:"/itp/api/testgroup/uriDetect",data:e})},g=function(e){return Object(y["a"])({url:"/itp/caseStatistics/record?productId="+e.productId+"&nodeId="+e.nodeId+"&nodeType="+e.nodeType+"&opType="+e.opType+"&cost="+e.cost,method:"GET"})},b=a("9062"),S=a("4d7f"),k=a.n(S),x=a("2ef0"),w=a.n(x),T=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("a-modal",{staticStyle:{position:"relative"},attrs:{title:"复制/移动",width:800,"body-style":{height:"500px",overflow:"auto"},visible:e.visible,"confirm-loading":e.confirmLoading,"ok-text":"保存","cancel-text":"取消"},on:{ok:e.handleOk,cancel:e.handleCancel}},[a("div",[a("span",{staticStyle:{fontSize:"12px"}},[e._v("请选择操作方向:")]),a("a-radio-group",{staticStyle:{"margin-bottom":"10px","margin-left":"10px"},on:{change:e.changeDireaction},model:{value:e.form.direaction,callback:function(t){e.$set(e.form,"direaction",t)},expression:"form.direaction"}},[(e.isCase(e.currentSelectNode),e._e()),a("a-radio",{attrs:{value:0}},[e._v("从内向外")])],1)],1),1===e.form.direaction?a("div",[a("span",{staticStyle:{fontSize:"12px"}},[e._v("请选择模式:")]),a("a-radio-group",{staticStyle:{"margin-bottom":"10px","margin-left":"10px"},on:{change:function(t){return e.modeChange()}},model:{value:e.form.mode,callback:function(t){e.$set(e.form,"mode",t)},expression:"form.mode"}},[a("a-radio",{attrs:{value:0}},[e._v("case模式")]),a("a-radio",{attrs:{value:1}},[e._v("suite模式")])],1)],1):e._e(),a("div",[a("span",{staticStyle:{fontSize:"12px"}},[e._v("请选择操作:")]),a("a-radio-group",{staticStyle:{"margin-bottom":"10px","margin-left":"10px"},on:{change:e.changeOption},model:{value:e.form.isOppCopy,callback:function(t){e.$set(e.form,"isOppCopy",t)},expression:"form.isOppCopy"}},[a("a-radio",{attrs:{value:1}},[e._v("复制")]),a("a-radio",{attrs:{value:0,disabled:e.currentSelectNode&&"root"===e.currentSelectNode.data.type&&0===e.form.direaction}},[e._v("移动")])],1)],1),a("div",[a("span",{staticStyle:{fontSize:"12px"}},[e._v("请选择用例集合:")]),a("a-select",{staticStyle:{width:"600px","margin-bottom":"10px","margin-left":"10px"},attrs:{"show-search":"",mode:1===e.form.direaction?"multiple":"default",placeholder:1===e.form.direaction?"请选择用例集合；多选;":"请选择用例集合；单选;","filter-option":e.filterOption},on:{select:e.selectPlatformCase,deselect:e.deSelectPlatformCase},model:{value:e.selectGroupList,callback:function(t){e.selectGroupList=t},expression:"selectGroupList"}},e._l(e.testGroupsLists,(function(t){return a("a-select-option",{key:t.id},[e._v(" "+e._s(t.name)+" ")])})),1)],1),e.selectNode.length&&1===e.form.direaction?a("a-tabs",{on:{change:e.handleTabChange},model:{value:e.platFormCaseTabActiveKey,callback:function(t){e.platFormCaseTabActiveKey=t},expression:"platFormCaseTabActiveKey"}},e._l(e.selectNode,(function(t){return a("a-tab-pane",{key:t.id,attrs:{tab:t.name}},[e.selectNodeTree.length?a("a-tree",{staticClass:"right-tree",attrs:{"tree-data":e.selectNodeTree,"show-line":!0,checkable:""},on:{check:e.onCheck},model:{value:e.checkedKeysTab,callback:function(t){e.checkedKeysTab=t},expression:"checkedKeysTab"}}):a("div",[a("a-icon",{attrs:{type:"loading"}})],1)],1)})),1):e._e(),0===e.form.direaction&&e.selectGroupList.length?a("a-tree",{staticClass:"right-tree",attrs:{"tree-data":e.direactionSelectNodeTree,"show-line":!0,checkable:"",checkStrictly:""},on:{check:e.direactionOnCheck},model:{value:e.direactionCheckedKeysTab,callback:function(t){e.direactionCheckedKeysTab=t},expression:"direactionCheckedKeysTab"}}):e._e()],1)},C=[],N=a("ade3"),O=(a("b64b"),{data:function(){return{labelCol:{span:6},wrapperCol:{span:14},visible:!1,confirmLoading:!1,isMultiple:!1,form:{direaction:0,isOppCopy:1,selectSuite:[],targetNode:void 0,mode:0},rules:{selectSuite:[{required:!0,message:"请选择用例集合名称",trigger:"change"}],isOppCopy:[{required:!0,message:"请选择复制或移动",trigger:"change"}]},caseTreeNodes:[],expandedKeys:[],autoExpandParent:!1,testGroupsLists:[],selectNode:[],caseTreeNodesTemp:{},caseTreeNodesAll:{},selectNodeTree:[],platFormCaseTabActiveKey:"",checkedKeys:{},checkedKeysTab:[],direactionCheckedKeysTab:[],checkedTypeSendToBack:[],direactionSelectNodeTree:[],selectGroupList:[]}},computed:Object(l["a"])({},Object(d["b"])({currentSelectNode:function(e){return e.treenode.currentSelectTreeNode}})),methods:(i={modeChange:function(){this.selectGroupList=[],this.selectNode=[]},filterOption:function(e,t){return t.componentOptions.children[0].text.toLowerCase().indexOf(e.toLowerCase())>=0},handleTabChange:function(e){this.platFormCaseTabActiveKey=e,this.selectNodeTree=this.caseTreeNodesAll[e],this.checkedKeysTab=this.checkedKeys["".concat(e)]},selectPlatformCase:function(e){this.direactionCheckedKeysTab=[];for(var t=0;t<this.testGroupsLists.length;t++)this.testGroupsLists[t].id===e&&!this.selectNode.indexOf(this.testGroupsLists[t].id)>-1&&(0===this.form.direaction?(this.selectNode=[this.testGroupsLists[t]],this.selectGroupList=[this.testGroupsLists[t].id],this.getOnlySuite(e)):(this.selectNode.push(this.testGroupsLists[t]),-1===this.selectGroupList.indexOf(this.testGroupsLists[t].id)&&this.selectGroupList.push(this.testGroupsLists[t].id),this.getAllCaseTree(e)))},getOnlySuite:function(e){for(var t=0;t<this.suiteNodesTemp.length;t++)if(this.suiteNodesTemp[t].data.groupId===e){this.direactionSelectNodeTree=[this.handleAllData(this.suiteNodesTemp[t])];var a=this.getSelectNodeChild(this.direactionSelectNodeTree)||[];a.length&&Object(f["a"])(a,(function(e){e.disabled=!0}))}},getSelectNodeChild:function(e){var t,a=this;return Object(f["a"])(e,(function(e){+e.data.id===+a.currentSelectNode.data.id&&(e.disabled=!0,t=Object(h["a"])(e.children))})),t},deSelectPlatformCase:function(e){for(var t=0;t<this.testGroupsLists.length;t++)if(this.testGroupsLists[t].id===e){var a=this.selectNode.indexOf(this.testGroupsLists[t]);this.selectNode.splice(a,1),this.selectGroupList.splice(a,1),this.caseTreeNodesTemp[e]&&delete this.caseTreeNodesTemp[e],this.caseTreeNodesAll[e]&&delete this.caseTreeNodesAll[e]}this.selectNode.length&&this.handleTabChange(this.selectNode[0].id)},handleAllData:function(e){var t=this;return Object(f["a"])(e,(function(e){e.title=e.data.text,e.key=e.data.id,e.type=e.data.type,e.slots={icon:"other"},e.isLeaf=t.isLeafNode(e),e.disabled=0===t.form.direaction?t.isSetupOrTeardown(e):0===t.form.mode?!t.isOnlyCase(e):t.isCase(e)||"root"===e.data.type})),e},isOnlyCase:function(e){return["case"].indexOf(e&&e.data&&e.data.type)>-1},isSetupOrTeardown:function(e){return["setup","teardown"].indexOf(e&&e.data&&e.data.type)>-1},getAllCaseTree:function(e){var t=this;return Object(o["a"])(regeneratorRuntime.mark((function a(){var i;return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:return i={groupId:e,type:2},a.next=3,Object(m["t"])(i).then((function(a){if(!a.status){if(t.caseTreeNodesTemp[e]=a.data,t.caseTreeNodesAll[e]=[t.handleAllData(t.caseTreeNodesTemp[e])],0===t.form.isOppCopy){var i=t.getExpendIds(t.currentSelectNode,[],e);i.length&&i.forEach((function(e){e.disabled=!0}))}t.handleTabChange(e),t.platFormCaseTabActiveKey=e}})).catch((function(e){}));case 3:case"end":return a.stop()}}),a)})))()},getExpendIds:function(e,t,a){var i=this;return Object(f["a"])(this.caseTreeNodesAll[a],(function(s,n){+s.data.id===+e.data.id&&(t.push(s),n&&i.getExpendIds(n,t,a))})),t},direactionOnCheck:function(e,t){t.checked?this.direactionCheckedKeysTab=[t.node.dataRef.key]:this.direactionCheckedKeysTab=[]},onCheck:function(e,t){this.checkedKeys["".concat(this.platFormCaseTabActiveKey)]=e},findChildByKey:function(e,t){var a=[];return Object(f["a"])(e,(function(e){+e.data.id===+t&&(a=e.children)})),a},getTreeNodeType:function(e){return["case","setup","teardown"].indexOf(e.data.type)>-1?e.data.type:"other"},onLoadData:function(e){var t=this;return new Promise((function(a){e.dataRef.children?a():setTimeout((function(){var i=t.findChildByKey(t.suiteNodesTemp,e.eventKey)||[];e.dataRef.children=[],i.forEach((function(a){e.dataRef.children.push({title:a.data.text,key:a.data.id,data:a.data,isLeaf:t.isLeafNode(a),type:a.data.type,scopedSlots:{title:"title"},slots:{icon:t.getTreeNodeType(a)}})})),t.caseTreeNodes=Object(h["a"])(t.caseTreeNodes),t.$forceUpdate(),a()}),10)}))},onExpand:function(e){this.expandedKeys=e,this.autoExpandParent=!1}},Object(N["a"])(i,"findChildByKey",(function(e,t){var a=[];return Object(f["a"])(e,(function(e){+e.data.id===+t&&(a=e.children)})),a})),Object(N["a"])(i,"isLeafNode",(function(e){return["case","setup","teardown"].indexOf(e.data.type)>-1||0===e.children.length})),Object(N["a"])(i,"getFirstSuite",(function(e){var t=this;this.caseTreeNodes=[],e.forEach((function(e){var a={};a.data=e.data,a.title=e.data.text,a.key=e.data.id,a.type=e.data.type,a.slots={icon:"suite"},a.scopedSlots={title:"title"},a.isLeaf=t.isLeafNode(e),t.caseTreeNodes.push(a)}))})),Object(N["a"])(i,"getNode",(function(){var e=this;Object(m["p"])(this.$route.query.productId).then((function(t){t.status||(e.suiteNodesTemp=t.data)})).catch((function(e){}))})),Object(N["a"])(i,"changeDireaction",(function(e){if(this.isCase(this.currentSelectNode)&&1===e.target.value)return this.$message.warn("从外向内复制/移动时,当前所选节点只能为suite或root！"),void(this.form.direaction=0);this.form.direaction=e.target.value,this.selectGroupList=[],this.selectNode=[]})),Object(N["a"])(i,"isCase",(function(e){return["case","setup","teardown"].indexOf(e&&e.data&&e.data.type)>-1})),Object(N["a"])(i,"changeOption",(function(e){this.form.isOppCopy=e.target.value,this.selectNode=[],this.selectGroupList=[]})),Object(N["a"])(i,"handleOk",(function(){var e={};if(0===this.form.direaction){if(!this.direactionCheckedKeysTab.length)return void this.$message.warn("请至少选择一个要复制的节点！");e={id:this.currentSelectNode.data.id,parentId:this.direactionCheckedKeysTab,type:this.currentSelectNode.data.type,isOppCopy:this.form.isOppCopy,versionId:this.currentSelectNode.data.versionId},this.$emit("chooseSuiteSuc",e),this.direactionCheckedKeysTab=[],this.selectGroupList=[],this.direactionSelectNodeTree=[],this.visible=!1}else{if(!Object.keys(this.checkedKeys).length)return void this.$message.warn("请至少选择一个要复制的节点！");var t=this.checkedKeys;if(0===this.form.mode){var a=[];for(var i in this.checkedKeys)a.push.apply(a,this.checkedKeys[i]);t=a}e={mode:this.form.mode,insideId:this.currentSelectNode.data.id,outsideIds:t,isOppCopy:this.form.isOppCopy},this.$emit("inCopyOrMoveSuc",e),this.visible=!1}})),Object(N["a"])(i,"handleCancel",(function(){this.visible=!1})),Object(N["a"])(i,"add",(function(){this.getNode(),this.getListTestGroups(),this.form.selectSuite=[],this.form.isOppCopy=1,this.form.direaction=0,this.form.mode=0,this.visible=!0,this.direactionCheckedKeysTab=[],this.selectGroupList=[],this.checkedKeys={}})),Object(N["a"])(i,"getListTestGroups",(function(){var e=this;Object(b["m"])({productId:this.$route.query.productId}).then((function(t){t.status||(e.testGroupsLists=t.data)})).catch((function(){}))})),Object(N["a"])(i,"getTitle",(function(){return this.currentSelectNode?this.from.isOppCopy?"复制到【".concat(this.currentSelectNode.data.text,"】"):"移动到【".concat(this.currentSelectNode.data.text,"】"):"复制/移动"})),i)}),I=O,$=(a("927e"),a("2877")),D=Object($["a"])(I,T,C,!1,null,"1d34e8f3",null),E=D.exports,L=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("a-modal",{staticStyle:{position:"relative"},attrs:{title:e.getTitle(),width:500,"body-style":{height:"200px",overflow:"auto"},visible:e.visible,"confirm-loading":e.confirmLoading,"ok-text":"保存","cancel-text":"取消"},on:{ok:e.handleOk,cancel:e.handleCancel}},[a("a-form-model",{ref:"ruleForm",attrs:{model:e.suiteForm,"label-col":e.labelCol,"wrapper-col":e.wrapperCol}},[a("a-form-model-item",{ref:"text",attrs:{label:"目录名称",prop:"text"}},[a("a-input",{attrs:{palceholder:"用于描述用例"},model:{value:e.suiteForm.text,callback:function(t){e.$set(e.suiteForm,"text",t)},expression:"suiteForm.text"}})],1),a("a-form-model-item",{ref:"note",attrs:{label:"测试用途",prop:"note"}},[a("a-textarea",{attrs:{"auto-size":{minRows:2,maxRows:5},placeholder:"用于描述用例用途"},model:{value:e.suiteForm.note,callback:function(t){e.$set(e.suiteForm,"note",t)},expression:"suiteForm.note"}})],1)],1)],1)},V=[],R={data:function(){return{labelCol:{span:6},wrapperCol:{span:14},visible:!1,confirmLoading:!1,suiteForm:{text:"",note:""}}},computed:Object(l["a"])({},Object(d["b"])({currentSelectNode:function(e){return e.treenode.currentSelectTreeNode}})),methods:{handleOk:function(){var e=this;this.confirmLoading=!0,Object(m["a"])({groupId:this.$route.params.id,parentId:this.currentSelectNode.data.id,type:1,text:this.suiteForm.text,note:this.suiteForm.note,versionId:this.currentSelectNode.data.versionId},"suite").then((function(t){t.status||(e.$emit("createSuiteSuc",{key:t.data,title:e.suiteForm.text}),e.visible=!1,e.confirmLoading=!1)})).catch((function(e){}))},handleCancel:function(){this.visible=!1},add:function(){this.visible=!0,this.suiteForm={text:"",note:""}},getTitle:function(){return this.currentSelectNode?"新增目录-在【"+this.currentSelectNode.data.text+"】下":"新增目录"}}},M=R,P=Object($["a"])(M,L,V,!1,null,"d3df55a4",null),A=P.exports,j=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("a-modal",{staticStyle:{position:"relative"},attrs:{title:e.getTitle(),width:500,"body-style":{height:"300px",overflow:"auto"},visible:e.visible,"confirm-loading":e.confirmLoading,"ok-text":"保存","cancel-text":"取消"},on:{ok:e.handleOk,cancel:e.handleCancel}},[a("a-form-model",{ref:"ruleForm",attrs:{model:e.caseForm,"label-col":e.labelCol,"wrapper-col":e.wrapperCol}},[a("a-form-model-item",{ref:"text",attrs:{label:"CASE名称",prop:"text"}},[a("a-input",{attrs:{palceholder:"用于描述CASE"},model:{value:e.caseForm.text,callback:function(t){e.$set(e.caseForm,"text",t)},expression:"caseForm.text"}})],1),a("a-form-model-item",{ref:"note",attrs:{label:"测试用途",prop:"note"}},[a("a-textarea",{attrs:{"auto-size":{minRows:1,maxRows:5},placeholder:"用于描述用例用途"},model:{value:e.caseForm.note,callback:function(t){e.$set(e.caseForm,"note",t)},expression:"caseForm.note"}})],1),a("a-form-model-item",{ref:"level",attrs:{label:"优先级",prop:"level"}},[a("a-select",{model:{value:e.caseForm.level,callback:function(t){e.$set(e.caseForm,"level",t)},expression:"caseForm.level"}},e._l(e.caseLevels,(function(t){return a("a-select-option",{key:t.id,attrs:{value:t.id}},[e._v(" "+e._s(t.name)+" ")])})),1)],1),a("a-form-model-item",{ref:"readOnly",attrs:{label:"读写权限",prop:"readOnly"}},[a("a-select",{model:{value:e.caseForm.readOnly,callback:function(t){e.$set(e.caseForm,"readOnly",t)},expression:"caseForm.readOnly"}},e._l(e.auths,(function(t){return a("a-select-option",{key:t.id,attrs:{value:t.id}},[e._v(" "+e._s(t.name)+" ")])})),1)],1),a("a-form-model-item",{ref:"status",attrs:{label:"状态",prop:"status"}},[a("a-select",{model:{value:e.caseForm.status,callback:function(t){e.$set(e.caseForm,"status",t)},expression:"caseForm.status"}},e._l(e.statuses,(function(t){return a("a-select-option",{key:t.id,attrs:{value:t.id}},[e._v(" "+e._s(t.name)+" ")])})),1)],1)],1)],1)},q=[],K={data:function(){return{labelCol:{span:6},wrapperCol:{span:14},visible:!1,confirmLoading:!1,caseForm:{text:"",note:"",level:1,readOnly:1,status:0},caseLevels:[{id:1,name:"L1(高)"},{id:2,name:"L2(中)"},{id:4,name:"L3(低)"},{id:8,name:"L4(极低)"}],auths:[{id:1,name:"读写"},{id:2,name:"只读"}],statuses:[{id:0,name:"启用"},{id:1,name:"暂停"}]}},computed:Object(l["a"])({},Object(d["b"])({currentSelectNode:function(e){return e.treenode.currentSelectTreeNode},versionId:function(e){return e.treenode.versionId}})),methods:{changeCaseLevel:function(e){this.caseForm.level=e},handleOk:function(){var e=this;this.visible=!1,this.confirmLoading=!0;var t=Object.assign({groupId:this.$route.params.id,parentId:this.currentSelectNode.data.id,versionId:this.versionId,type:2},Object(l["a"])({},this.caseForm));Object(m["a"])(t,"case").then((function(t){t.status||(e.addStep(t.data),e.visible=!1,e.$emit("createCaseSuc",{key:t.data,caseForm:e.caseForm}))})).catch((function(e){}))},addStep:function(e){var t=this,a={groupId:this.$route.params.id,parentId:e,type:3,text:"STEP",versionId:this.versionId};Object(m["a"])(a,"step").then((function(e){e.status||t.addStepCallback(e.data)})).catch((function(e){}))},addStepCallback:function(e){var t=this,a="Operation";Object(b["q"])(this.$route.params.id).then((function(i){var s=["apiOpName"],n=i.data.caseDefaultSet;if(null==n||""===n)for(var o in n={},s)n[s[o]]="";else for(var r in n=JSON.parse(n),s)null==n[s[r]]&&(n[s[r]]="");""!==n.apiOpName&&(a=n.apiOpName);var c={parentId:e,type:4,groupId:t.$route.params.id,text:a,versionId:t.versionId};Object(m["b"])(c,"api"),t.confirmLoading=!1})).catch((function(e){}))},handleCancel:function(){this.visible=!1},add:function(){this.visible=!0,this.caseForm={text:"",note:"",level:1,readOnly:1,status:0}},getTitle:function(){return this.currentSelectNode?"新增CASE-在【"+this.currentSelectNode.data.text+"】目录下":"新增CASE"}}},z=K,G=Object($["a"])(z,j,q,!1,null,"866334f4",null),B=G.exports,F=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("a-modal",{staticStyle:{position:"relative"},attrs:{title:"数据驱动设置",width:1200,"body-style":{height:"500px",overflow:"auto"},visible:e.visible,"confirm-loading":e.confirmLoading,"ok-text":"确定","cancel-text":"取消"},on:{ok:e.handleOk,cancel:e.handleCancel}},[a("a-radio-group",{on:{change:e.ondynamicTypeChange},model:{value:e.dynamicType,callback:function(t){e.dynamicType=t},expression:"dynamicType"}},[a("a-radio",{attrs:{value:0,disabled:""!==e.dynamicDataSql||""!==e.dynamicDataApi}},[e._v(" 页面填写 ")]),a("a-radio",{attrs:{value:1,disabled:e.dynamicArgs.length>0||""!==e.dynamicDataApi}},[e._v(" sql ")]),a("a-radio",{attrs:{value:2,disabled:e.dynamicArgs.length>0||""!==e.dynamicDataSql||!0}},[e._v(" 接口读入 ")])],1),a("div",{directives:[{name:"show",rawName:"v-show",value:0===e.dynamicType,expression:"dynamicType === 0"}],staticStyle:{"margin-top":"10px"}},[a("div",{staticStyle:{marginTop:"5px"}},[a("a-icon",{attrs:{type:"alert",theme:"twoTone"}}),e._v(" tips:针对请求中配置的动态变量("),a("b",[e._v("$[变量名]")]),e._v(")进行参数替换，以实现数据驱动测试。每条数据均会运行一次Case。可以在【名称】字段对一组数据进行描述。 ")],1),a("div",{staticStyle:{marginTop:"5px"}},[a("a-icon",{attrs:{type:"alert",theme:"twoTone"}}),e._v(" tips:填写英文减号"),a("b",[e._v("(-)")]),e._v("，表示不需要传递该参数；不填表示传递空字符串 ")],1),a("div",{staticClass:"top-bar"},[a("div",{staticClass:"basic-btn"},[a("a",{attrs:{disabled:0===e.dynamicArgTitles.length},on:{click:e.clickDynamicArgInput}},[e._v(" 新增 ")]),a("a-divider",{attrs:{type:"vertical"}}),e._e(),e._e(),a("a",{attrs:{disabled:0===e.dynamicArgTitles.length},on:{click:e.show}},[e._v(" "+e._s(e.isShow?"关闭":"展开")+"批量导入 ")]),a("a-divider",{attrs:{type:"vertical"}}),a("a",{attrs:{disabled:0===e.dynamicArgTitles.length},on:{click:function(t){return e.importArgs(!0)}}},[e._v(" 导入(覆盖) ")]),a("a-divider",{attrs:{type:"vertical"}}),a("a",{attrs:{disabled:0===e.dynamicArgTitles.length},on:{click:function(t){return e.importArgs(!1)}}},[e._v(" 导入(追加) ")])],1)]),a("div",{staticClass:"dynamicdata-content"},[a("a-table",{attrs:{"row-selection":e.rowSelection,columns:e.columns,"data-source":e.dynamicArgs,"row-key":function(e){return e.sequence},pagination:!1,scroll:{x:1500,y:800}},scopedSlots:e._u([{key:"descr",fn:function(t,i){return a("a-input",{staticStyle:{border:"none",padding:"0px"},model:{value:i.descr,callback:function(t){e.$set(i,"descr",t)},expression:"record.descr"}})}},{key:"options",fn:function(t,i,s){return a("span",{},[a("a",{on:{click:function(t){return e.remove(s)}}},[e._v(" 删除 ")]),a("a-divider",{attrs:{type:"vertical"}}),a("a",{on:{click:function(t){return e.moveUp(s)}}},[e._v(" 上移 ")]),a("a-divider",{attrs:{type:"vertical"}}),a("a",{on:{click:function(t){return e.moveDown(s)}}},[e._v(" 下移 ")])],1)}},e._l(e.dynamicArgTitles,(function(t,i){return{key:t,fn:function(t,s){return[s&&s.param?a("span",{key:i},[a("a-input",{staticStyle:{border:"none",padding:"0px"},model:{value:s.param[i].value,callback:function(t){e.$set(s.param[i],"value",t)},expression:"record.param[index].value"}})],1):e._e()]}}}))],null,!0)})],1),a("div",{directives:[{name:"show",rawName:"v-show",value:e.isShow,expression:"isShow"}],staticStyle:{"padding-top":"35px"}},[a("h4",{staticStyle:{display:"inline-block"}},[e._v("批量导入")]),a("a",{staticStyle:{margin:"0px 5px"},on:{click:function(t){return e.importArgs(!1)}}},[e._v(" 确定批量导入(追加) ")]),a("a-textarea",{attrs:{id:"tab-indent-batch","auto-size":{minRows:5,maxRows:11},placeholder:"每行一条记录，制表符分隔，第一列为描述，如果参数个数不够，则后面补空。可以在excel里写导出为txt，或者直接写在文件里拷贝进来。",value:e.importData},on:{change:function(t){e.importData=t.target.value},keydown:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"tab",9,t.key,"Tab")?null:e.forbidTab(t)},keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"tab",9,t.key,"Tab")?null:e.replaceSpacing(t)}}})],1),a("div",{directives:[{name:"show",rawName:"v-show",value:e.isShowGen,expression:"isShowGen"}],staticStyle:{"padding-top":"35px"}},[a("div",{staticStyle:{"padding-bottom":"20px"}},[a("h4",{staticStyle:{display:"inline-block"}},[e._v("参数列表及约束")]),a("a",{on:{click:e.refreshRule}},[e._v(" 刷新约束 ")]),a("a-divider",{attrs:{type:"vertical"}}),a("a",{on:{click:e.cal}},[e._v(" 计算 ")]),a("a-table",{staticStyle:{margin:"10px 0px"},attrs:{columns:e.genColumns,"data-source":e.rules,"row-key":function(e){return e.key},pagination:!1},scopedSlots:e._u([{key:"key",fn:function(t){return a("h3",{},[e._v(e._s(t))])}},{key:"isCalculate",fn:function(t,i){return a("a-dropdown",{},[a("a",{staticClass:"ant-dropdown-link",on:{click:function(e){return e.preventDefault()}}},[e._v(" "+e._s(i.paramRule.isCalculate?"否":"是")),a("a-icon",{attrs:{type:"down"}})],1),a("a-menu",{attrs:{slot:"overlay"},on:{click:function(t){return e.isCalculateChange(t,i,"isCalculate")}},slot:"overlay"},[e._l(e.booleanList,(function(t){return[a("a-menu-item",{key:t.id},[e._v(" "+e._s(t.name)+" ")])]}))],2)],1)}},{key:"isMustHave",fn:function(t,i){return 0===i.paramRule.isCalculate?a("a-dropdown",{},[a("a",{staticClass:"ant-dropdown-link",on:{click:function(e){return e.preventDefault()}}},[e._v(" "+e._s(i.paramRule.isMustHave?"否":"是")),a("a-icon",{attrs:{type:"down"}})],1),a("a-menu",{attrs:{slot:"overlay"},on:{click:function(t){return e.isCalculateChange(t,i,"isMustHave")}},slot:"overlay"},[e._l(e.booleanList,(function(t){return[a("a-menu-item",{key:t.id},[e._v(" "+e._s(t.name)+" ")])]}))],2)],1):e._e()}},{key:"canBeNull",fn:function(t,i){return 0===i.paramRule.isCalculate?a("a-dropdown",{},[a("a",{staticClass:"ant-dropdown-link",on:{click:function(e){return e.preventDefault()}}},[e._v(" "+e._s(i.paramRule.canBeNull?"否":"是")),a("a-icon",{attrs:{type:"down"}})],1),a("a-menu",{attrs:{slot:"overlay"},on:{click:function(t){return e.isCalculateChange(t,i,"canBeNull")}},slot:"overlay"},[e._l(e.booleanList,(function(t){return[a("a-menu-item",{key:t.id},[e._v(" "+e._s(t.name)+" ")])]}))],2)],1):e._e()}},{key:"canBeEmpty",fn:function(t,i){return 0===i.paramRule.isCalculate?a("a-dropdown",{},[a("a",{staticClass:"ant-dropdown-link",on:{click:function(e){return e.preventDefault()}}},[e._v(" "+e._s(i.paramRule.canBeEmpty?"否":"是")),a("a-icon",{attrs:{type:"down"}})],1),a("a-menu",{attrs:{slot:"overlay"},on:{click:function(t){return e.isCalculateChange(t,i,"canBeEmpty")}},slot:"overlay"},[e._l(e.booleanList,(function(t){return[a("a-menu-item",{key:t.id},[e._v(" "+e._s(t.name)+" ")])]}))],2)],1):e._e()}},{key:"rule",fn:function(t,i){return 0===i.paramRule.isCalculate?a("a-dropdown",{},[a("a",{staticClass:"ant-dropdown-link",on:{click:function(e){return e.preventDefault()}}},[e._v(" "+e._s(e.getParamRule(i.paramRule.rule))),a("a-icon",{attrs:{type:"down"}})],1),a("a-menu",{attrs:{slot:"overlay"},on:{click:function(t){return e.isCalculateChange(t,i,"rule")}},slot:"overlay"},[e._l(e.paramRuleList,(function(t){return[a("a-menu-item",{key:t.id},[e._v(" "+e._s(t.name)+" ")])]}))],2)],1):e._e()}},{key:"specialValue",fn:function(t,i,s){return[a("span",{directives:[{name:"show",rawName:"v-show",value:0===i.paramRule.isCalculate&&(void 0===i.specialValueShow||!i.specialValueShow),expression:"record.paramRule.isCalculate === 0\n                                && (record.specialValueShow === undefined\n                                    || !record.specialValueShow)"}],staticStyle:{cursor:"pointer","min-width":"10px"},on:{click:function(t){return e.openEditSpeciaValue(s)}}},[e._v(" "+e._s(i.paramRule.specialValue)+" "),a("a-icon",{attrs:{type:"edit"}})],1),a("a-input",{directives:[{name:"show",rawName:"v-show",value:0===i.paramRule.isCalculate&&i.specialValueShow,expression:"record.paramRule.isCalculate === 0 && record.specialValueShow"}],staticStyle:{"max-width":"100px"},attrs:{placeholder:"英文逗号分隔"},on:{blur:function(t){return e.closeInput(i)}},model:{value:i.paramRule.specialValue,callback:function(t){e.$set(i.paramRule,"specialValue",t)},expression:"record.paramRule.specialValue"}})]}}],null,!0)})],1),e.showResult&&e.analyseParamData?a("div",{staticStyle:{"padding-bottom":"20px"}},[a("h4",{staticStyle:{display:"inline-block"}},[e._v("建议补充的参数组合")]),a("a",{staticStyle:{margin:"0px 5px"},on:{click:e.add}},[e._v(" 补充用例 ")]),a("a-table",{attrs:{"row-selection":e.rowSelectionAdd,columns:e.addColumns,"data-source":e.tableData,"row-key":function(e){return e.id},pagination:!1}})],1):e._e()])]),a("div",{directives:[{name:"show",rawName:"v-show",value:1===e.dynamicType,expression:"dynamicType === 1"}],staticStyle:{"margin-top":"10px"}},[a("a-textarea",{staticStyle:{width:"60%"},attrs:{placeholder:"sql","allow-clear":"","auto-size":{minRows:10,maxRows:15}},model:{value:e.dynamicDataSql,callback:function(t){e.dynamicDataSql=t},expression:"dynamicDataSql"}})],1),a("div",{directives:[{name:"show",rawName:"v-show",value:2===e.dynamicType,expression:"dynamicType === 2"}],staticStyle:{"margin-top":"10px"}},[a("a-input",{staticStyle:{width:"60%"},attrs:{placeholder:"接口地址","allow-clear":""},model:{value:e.dynamicDataApi,callback:function(t){e.dynamicDataApi=t},expression:"dynamicDataApi"}})],1)],1)},U=[],J=(a("498a2"),{data:function(){return{labelCol:{span:6},wrapperCol:{span:14},visible:!1,confirmLoading:!1,dynamicArgTitles:[],dynamicArgs:[],data:null,allCheck:!1,rules:[],columns:[],dynamicType:0,dynamicData:"",dynamicDataSql:"",dynamicDataApi:"",booleanList:[{id:0,name:"是"},{id:1,name:"否"}],paramRuleList:[{id:0,name:"任意值"},{id:1,name:"固定值"},{id:3,name:"任意数字"},{id:4,name:"任意浮点数"},{id:5,name:"任意整数"},{id:6,name:"任意字符串"}],genColumns:[{title:"参数名",dataIndex:"key",align:"center",scopedSlots:{customRender:"key"}},{title:"需要考虑",dataIndex:"paramRule.isCalculate",align:"center",scopedSlots:{customRender:"isCalculate"}},{title:"必传",dataIndex:"paramRule.isMustHave",align:"center",scopedSlots:{customRender:"isMustHave"}},{title:"允许为NULL",dataIndex:"paramRule.canBeNull",align:"center",scopedSlots:{customRender:"canBeNull"}},{title:"允许为空串",dataIndex:"paramRule.canBeEmpty",align:"center",scopedSlots:{customRender:"canBeEmpty"}},{title:"类型",dataIndex:"paramRule.rule",align:"center",scopedSlots:{customRender:"rule"}},{title:"特殊值",dataIndex:"paramRule.specialValue",align:"center",scopedSlots:{customRender:"specialValue"}}],selectedRowKeys:[],isShowGen:!1,isShow:!1,showResult:!1,analyseParamData:null,resultCheckList:[],analyseAllParamData:null,importData:"",addSelectedRowKeys:[],tableData:[],addColumns:[]}},computed:Object(l["a"])(Object(l["a"])({},Object(d["b"])({currentSelectNode:function(e){return e.treenode.currentSelectTreeNode}})),{},{rowSelection:function(){var e=this;return{selectedRowKeys:this.selectedRowKeys,onChange:function(t){e.selectedRowKeys=t},onSelect:function(t,a){e.$set(t,"checked",a)},onSelectAll:function(t,a,i){for(var s=0;s<i.length;s++)e.$set(i[s],"checked",t)}}},rowSelectionAdd:function(){var e=this;return{selectedRowKeys:this.addSelectedRowKeys,onChange:function(t){e.addSelectedRowKeys=t},onSelect:function(t,a,i){e.clickCheckResult(t.id)},onSelectAll:function(t,a,i){for(var s=0;s<i.length;s++)e.clickCheckResult(i[s].id)}}}}),methods:{ondynamicTypeChange:function(e){this.dynamicArgs=[],this.dynamicDataSql="",this.dynamicDataApi=""},importArgs:function(e){for(var t=this.importData.split("\n"),a=[],i=0;i<t.length;i++){for(var s=t[i].split("\t"),n=[],o=0;o<this.dynamicArgTitles.length;o++){var r={key:this.dynamicArgTitles[0],value:s.length>o+1?s[o+1]:""};n.push(r)}var c={descr:s[0],param:n,sequence:this.dynamicArgs.length+1,checked:!0};e?c.sequence=1:this.dynamicArgs.length>0?c.sequence=this.dynamicArgs[this.dynamicArgs.length-1].sequence+1:c.sequence=1,e||this.dynamicArgs.push(c),a.push(c)}e&&(this.dynamicArgs=a),this.importData=""},replaceSpacing:function(){var e=document.getElementById("tab-indent-batch"),t=e.selectionStart,a=e.selectionEnd;if(void 0!==t&&void 0!==a){var i=e.value,s=i.substring(0,t)+"\t"+i.substring(a);e.value=s,e.focus(),e.selectionStart=t+"\t".length,e.selectionEnd=t+"\t".length}},forbidTab:function(e){e.preventDefault()},show:function(){this.isShow=!this.isShow},add:function(){for(var e=0;e<this.resultCheckList.length;e++)if(this.resultCheckList[e]){var t={};t.descr="auto"+e;for(var a=[],i=0;i<this.analyseParamData.keyList.length;i++){var s={key:this.analyseParamData.keyList[i],value:this.analyseParamData.resultParamList[e][i]};a.push(s)}t.param=a,t.sequence=this.dynamicArgs.length+1,this.dynamicArgs.push(t)}},clickCheckResult:function(e){this.resultCheckList[e]?this.$set(this.resultCheckList,e,!1):this.$set(this.resultCheckList,e,!0)},cal:function(){for(var e=this,t=[],a=0,i=0;i<this.rules.length;i++)if(0===this.rules[i].paramRule.isCalculate){for(var s=[],n=0;n<this.dynamicArgs.length;n++)s.push(this.dynamicArgs[n].param[a].value);this.rules[i].valueList=s,t.push(this.rules[i]),a++}Object(m["A"])({_list:t,groupId:0,productId:0,path:""}).then((function(t){if(t.status)e.$message.error(t.message);else{var a=t.data;e.showResult=!0,e.analyseParamData=a.resultMore,e.genAddColunms(),e.handleAnalyseParamData(),e.resultCheckList=[];for(var i=0;i<e.analyseParamData.resultParamList.length;i++)e.resultCheckList[i]=!0;e.analyseAllParamData=a.resultAll}})).catch((function(e){}))},handleAnalyseParamData:function(){this.tableData=[],this.addSelectedRowKeys=[];for(var e=0;e<this.analyseParamData.resultParamList.length;e++){for(var t={},a=0;a<this.analyseParamData.resultParamList[e].length;a++)t[this.analyseParamData.keyList[a]]=this.analyseParamData.resultParamList[e][a];t.id=e,this.addSelectedRowKeys.push(e),this.tableData.push(t)}},genAddColunms:function(){this.addColumns=[];for(var e=0;e<this.analyseParamData.keyList.length;e++)this.addColumns.push({title:this.analyseParamData.keyList[e],dataIndex:this.analyseParamData.keyList[e],align:"center",scopedSlots:{customRender:this.analyseParamData.keyList[e]}})},refreshRule:function(){this.calRules(this.dynamicArgs,this.dynamicArgTitles)},closeInput:function(e){this.$set(e,"specialValueShow",!1)},openEditSpeciaValue:function(e){for(var t=0;t<this.rules.length;t++)this.$set(this.rules[t],"specialValueShow",!1);this.$set(this.rules[e],"specialValueShow",!0)},getParamRule:function(e){return{0:"任意值",1:"固定值",3:"任意数字",4:"任意浮点数",5:"任意整数",6:"任意字符串"}[e]},isCalculateChange:function(e,t,a){this.$set(t.paramRule,a,e.key)},showGen:function(){this.isShowGen?(this.isShowGen=!1,this.showResult=!1):this.isShowGen=!0},moveUp:function(e){if(0!==e){var t=this.dynamicArgs[e],a=this.dynamicArgs[e-1],i=t.sequence;t.sequence=a.sequence,a.sequence=i,this.dynamicArgs.splice(e,1),this.dynamicArgs.splice(Math.max(0,e-1),0,t)}},remove:function(e){this.dynamicArgs.splice(e,1)},moveDown:function(e){if(e<this.dynamicArgs.length-1){var t=this.dynamicArgs[e],a=this.dynamicArgs[e+1],i=t.sequence;t.sequence=a.sequence,a.sequence=i,this.dynamicArgs.splice(e,1),this.dynamicArgs.splice(e+1,0,t)}},clickDynamicArgInput:function(){for(var e={descr:"",param:[],sequence:"",checked:!0},t=0;t<this.dynamicArgTitles.length;t++)e.param.push({key:this.dynamicArgTitles[t],value:""});this.dynamicArgs.length>0?e.sequence=this.dynamicArgs[this.dynamicArgs.length-1].sequence+1:e.sequence=1,this.dynamicArgs.push(e),this.selectedRowKeys.push(e.sequence)},getTableColumns:function(){var e=this;this.columns=[],this.columns.push({title:"名称",dataIndex:"descr",align:"left",width:200,scopedSlots:{customRender:"descr"}}),this.dynamicArgTitles.forEach((function(t){for(var a,i=0;i<e.dynamicArgs.length;i++)for(var s=0;s<e.dynamicArgs[i].param.length;s++)t===e.dynamicArgs[i].param[s].key&&(a=s);var n={title:t,align:"left",dataIndex:"param[".concat(a,"].value"),width:300,scopedSlots:{customRender:t}};e.columns.push(n)})),this.columns.push({title:"options",align:"center",fixed:"right",width:200,scopedSlots:{customRender:"options"}})},checkOrCancelAll:function(){var e=document.getElementById("checkAll"),t=e.checked,a=document.getElementsByName("checkItem");if(t)for(var i=0;i<a.length;i++)a[i].checked=!0,this.dynamicArgs[i].checked=!0;else for(var s=0;s<a.length;s++)a[s].checked=!1,this.dynamicArgs[s].checked=!1},handleOk:function(){var e=this,t=[];if(0===this.dynamicType)for(var a=!1,i=0;i<this.dynamicArgs.length;i++){for(var s={descr:"",param:[],sequence:"",checked:""},n=0,o=0;o<this.dynamicArgs[i].param.length;o++)if(s.descr=this.dynamicArgs[i].descr,s.sequence=this.dynamicArgs[i].sequence,s.checked=this.dynamicArgs[i].checked,void 0===this.dynamicArgs[i].param[o].value||null===this.dynamicArgs[i].param[o].value||""===this.dynamicArgs[i].param[o].value.trim()){if(n++,n===this.dynamicArgs[i].param.length&&(""===this.dynamicArgs[i].descr||void 0===this.dynamicArgs[i].descr||null===this.dynamicArgs[i].descr)){a=!0;break}}else s.param.push({key:this.dynamicArgTitles[o],value:this.dynamicArgs[i].param[o].value});a?a=!1:t.push(s)}else 1===this.dynamicType?this.dynamicData=this.dynamicDataSql:2===this.dynamicType&&(this.dynamicData=this.dynamicDataApi);Object(m["P"])({dynamicData:0===this.dynamicType?JSON.stringify(t):this.dynamicData,versionId:this.currentSelectNode.data.versionId,dynamicType:this.dynamicType},{id:this.currentSelectNode.data.id,typeTag:this.currentSelectNode.data.type}).then((function(t){t.status?e.$message.error(t.message):e.visible=!1})).catch((function(e){}))},handleCancel:function(){this.visible=!1},openDynamicData:function(){this.visible=!0,this.isShowGen=!1,this.isShow=!1,this.showResult=!1,this.dynamicArgs=[],this.dynamicDataSql="",this.dynamicDataApi="",this.queryNode()},queryDynamicArgsCallback:function(e,t){if(this.dynamicArgTitles=t||[],this.dynamicArgs=[],this.data=e,this.allCheck=!1,e.length>0){for(var a=0;a<e.length;a++)e[a].sequence=a+1;if(e[0].hasOwnProperty("sequence")||e[0].hasOwnProperty("checked"))if(e[0].hasOwnProperty("sequence")){if(!e[0].hasOwnProperty("checked")){for(var i=0;i<e.length;i++)e[i].checked=!0;this.allCheck=!0}}else for(var s=0;s<e.length;s++)e[s].sequence=s+1;else{for(var n=0;n<e.length;n++)e[n].sequence=n+1,e[n].checked=!0;this.allCheck=!0}}e.sort((function(e,t){return e.sequence<t.sequence?-1:e.sequence===t.sequence?0:1}));for(var o=0,r=0;r<e.length;r++){var c={descr:"",param:[],sequence:"",checked:""};c.descr=e[r].descr,c.sequence=e[r].sequence,c.checked=e[r].checked,!0===e[r].checked&&o++;for(var l=0;l<this.dynamicArgTitles.length;l++){for(var d=!1,u=0;u<e[r].param.length;u++)e[r].param[u].key===this.dynamicArgTitles[l]&&(c.param.push({key:this.dynamicArgTitles[l],value:e[r].param[u].value}),d=!0);d||c.param.push({key:this.dynamicArgTitles[l],value:""})}0!==c.param.length&&this.dynamicArgs.push(c)}0!==o&&o===e.length&&(this.allCheck=!0),this.selectedRowKeys=[];for(var p=0;p<this.dynamicArgs.length;p++)this.dynamicArgs[p].checked&&this.selectedRowKeys.push(this.dynamicArgs[p].sequence);this.calRules(e,t),this.getTableColumns()},calRules:function(e,t){this.rules=[];for(var a=0;a<t.length;a++){var i={};i.key=t[a];for(var s={isCalculate:0,isMustHave:0,canBeNull:1,canBeEmpty:1,rule:1,specialValueShow:!1,specialValue:""},n=[],o=0;o<e.length;o++){for(var r=!1,c=0;c<e[o].param.length;c++)if(e[o].param[c].key!==i.key);else{if(r=!0,"-"===e[o].param[c].value){s.isMustHave=1;continue}if(null===e[o].param[c].value||"null"===e[o].param[c].value){s.canBeNull=0;continue}if(""===e[o].param[c].value){s.canBeEmpty=0;continue}n.push(e[o].param[c].value)}r||(s.canBeEmpty=0)}n=this.uniq(n);for(var l=0;l<n.length;l++)s.specialValue=s.specialValue+n[l],l!=n.length-1&&(s.specialValue=s.specialValue+",");i.paramRule=s,this.rules.push(i)}},uniq:function(e){for(var t=[],a=0;a<e.length;a++)-1==t.indexOf(e[a])&&t.push(e[a]);return t},getDynamicData:function(e){var t=this;return Object(o["a"])(regeneratorRuntime.mark((function a(){var i;return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:if(t.dynamicType=e.dynamicType,0!==t.dynamicType){a.next=7;break}try{i=JSON.parse(e.dynamicData)}catch(s){i=[]}return a.next=5,Object(m["D"])({id:t.currentSelectNode.data.id,versionId:t.currentSelectNode.data.versionId}).then((function(e){e.status?t.$message.error(e.message):t.queryDynamicArgsCallback(i,e.data)})).catch((function(e){}));case 5:a.next=8;break;case 7:1===t.dynamicType?t.dynamicDataSql=e.dynamicData:2===t.dynamicType&&(t.dynamicDataApi=e.dynamicData);case 8:case"end":return a.stop()}}),a)})))()},queryNode:function(){var e=this;return Object(o["a"])(regeneratorRuntime.mark((function t(){var a;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return a={typeTag:"case",id:e.currentSelectNode.data.id,versionId:e.currentSelectNode.data.versionId},t.next=3,Object(m["F"])(a).then((function(t){t.status?e.$message.error(t.message):e.getDynamicData(t.data)})).catch((function(e){}));case 3:case"end":return t.stop()}}),t)})))()}}}),H=J,W=(a("ee83"),Object($["a"])(H,F,U,!1,null,"39d544ac",null)),Y=W.exports,Q=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("a-modal",{staticStyle:{position:"relative"},attrs:{title:"检测",width:1200,"body-style":{height:"500px",overflow:"auto"},visible:e.visible,"confirm-loading":e.confirmLoading,"cancel-text":"取消","mask-closable":!1},on:{cancel:e.handleCancel}},[a("a-row",{attrs:{gutter:16}},[a("a-col",{staticClass:"edit-checker-container",attrs:{span:12,order:1}},e._l(e.checkerVars,(function(t,i){return a("div",{key:i,staticStyle:{"margin-bottom":"20px"}},[a("a-card",{attrs:{size:"small"}},[a("a-checkbox",{staticStyle:{display:"block"},attrs:{slot:"title",checked:e.isAllSelected(t.children),disabled:e.checkDisabled},on:{change:function(a){return e.updateAllSelection(a,t.children)}},slot:"title"},[a("h3",{staticStyle:{display:"inline-block"}},[e._v(e._s(t.name))])]),e._l(t.children,(function(i,s){return a("span",{key:s},["个性化规则"!==t.name?a("a-checkbox",{attrs:{checked:e.isSelected(i.id),disabled:e.checkDisabled},on:{change:function(t){return e.updateSelection(t,i.id)}}},[a("h4",{staticStyle:{display:"inline-block"}},[e._v(e._s(i.name))])]):a("div",[a("a-card",{staticStyle:{marginBottom:"10px"},attrs:{size:"small"}},[a("div",{attrs:{slot:"title"},slot:"title"},[a("a-checkbox",{attrs:{disabled:19===i.id||e.checkDisabled,checked:e.isSelected(i.id)},on:{change:function(t){return e.updateSelection(t,i.id)}}},[a("h4",{staticStyle:{display:"inline-block"}},[e._v(e._s(i.name))])]),-1!==e.globalVerifyMap&&16===i.id||-1!==e.paramVerifyMap&&19===i.id?a("a-button",{attrs:{type:"link",shape:"circle",icon:"plus-circle",disabled:e.checkDisabled||e.checkDisabledBySelectedID(i.id)},on:{click:function(t){return t.stopPropagation(),e.clickArgInput(i.id)}}}):e._e(),(e.globalVerifyMap.length&&i.id,e._e())],1),-1!==e.nameVerifyMap&&15===i.id?a("div",e._l(e.nameVerifyMap,(function(t,s){return a("div",{key:s,staticStyle:{margin:"5px 0px"}},[a("a-row",{staticStyle:{"margin-bottom":"10px"},attrs:{type:"flex"}},[a("a-col",{staticStyle:{margin:"auto 0"},attrs:{span:5}},[a("a-checkbox",{attrs:{disabled:e.checkDisabled||e.checkDisabledBySelectedID(i.id)},model:{value:t.ifCheck,callback:function(a){e.$set(t,"ifCheck",a)},expression:"nameItem.ifCheck"}},[e._v(" "+e._s(t.type)+"命名: ")])],1),a("a-col",{attrs:{span:16}},[a("a-input",{attrs:{placeholder:t.type+"命名",disabled:e.checkDisabled||e.checkDisabledBySelectedID(i.id)},model:{value:t.rule,callback:function(a){e.$set(t,"rule",a)},expression:"nameItem.rule"}})],1)],1)],1)})),0):e._e(),-1!==e.globalVerifyMap&&16===i.id?a("div",e._l(e.globalVerifyMap,(function(t,s){return a("a-input-group",{key:s,attrs:{compact:""}},[a("a-input",{staticStyle:{width:"30%"},attrs:{placeholder:"参数名称",disabled:e.checkDisabled||e.checkDisabledBySelectedID(i.id)},model:{value:t.param,callback:function(a){e.$set(t,"param",a)},expression:"varItem.param"}}),a("a-input",{staticStyle:{width:"30%"},attrs:{placeholder:"豁免case命名",disabled:e.checkDisabled||e.checkDisabledBySelectedID(i.id)},model:{value:t.outOfCaseName,callback:function(a){e.$set(t,"outOfCaseName",a)},expression:"varItem.outOfCaseName"}}),a("a-input",{staticStyle:{width:"30%"},attrs:{placeholder:"豁免op命名",disabled:e.checkDisabled||e.checkDisabledBySelectedID(i.id)},model:{value:t.outOfOpName,callback:function(a){e.$set(t,"outOfOpName",a)},expression:"varItem.outOfOpName"}}),a("a-button",{attrs:{type:"link",shape:"circle",icon:"close-circle",disabled:e.checkDisabled||e.checkDisabledBySelectedID(i.id)},on:{click:function(t){return e.removeArg(i.id,s)}}})],1)})),1):e._e(),-1!==e.textVerifyMap&&21===i.id?a("div",e._l(e.textVerifyMap,(function(t,s){return a("span",{key:s},[a("a-checkbox",{attrs:{disabled:e.checkDisabled||e.checkDisabledBySelectedID(i.id)},model:{value:t.caseIf,callback:function(a){e.$set(t,"caseIf",a)},expression:"textItem.caseIf"}},[e._v(" 检测case用途 ")]),a("a-checkbox",{attrs:{disabled:e.checkDisabled||e.checkDisabledBySelectedID(i.id)},model:{value:t.suiteIf,callback:function(a){e.$set(t,"suiteIf",a)},expression:"textItem.suiteIf"}},[e._v(" 检测suite用途 ")])],1)})),0):e._e(),-1!==e.recoveryVerifyMap&&18===i.id?a("div",e._l(e.recoveryVerifyMap,(function(t,s){return a("div",{key:s},[a("a-row",{staticStyle:{"margin-bottom":"10px"},attrs:{type:"flex"}},[a("a-col",{staticStyle:{margin:"auto 0",fontSize:"12px"},attrs:{span:5}},[a("span",[e._v("setUpRegex:")])]),a("a-col",{attrs:{span:16}},[a("a-input",{attrs:{placeholder:"setUpRegex",disabled:e.checkDisabled||e.checkDisabledBySelectedID(i.id)},model:{value:t.setUp,callback:function(a){e.$set(t,"setUp",a)},expression:"recovItem.setUp"}})],1)],1),a("a-row",{staticStyle:{"margin-bottom":"10px"},attrs:{type:"flex"}},[a("a-col",{staticStyle:{margin:"auto 0",fontSize:"12px"},attrs:{span:5}},[e._v(" tearDownRegex: ")]),a("a-col",{attrs:{span:16}},[a("a-input",{attrs:{placeholder:"tearDownRegex",disabled:e.checkDisabled||e.checkDisabledBySelectedID(i.id)},model:{value:t.tearDown,callback:function(a){e.$set(t,"tearDown",a)},expression:"recovItem.tearDown"}})],1)],1),a("a-checkbox",{attrs:{disabled:e.checkDisabled||e.checkDisabledBySelectedID(i.id)},model:{value:t.matchEqualVerify,callback:function(a){e.$set(t,"matchEqualVerify",a)},expression:"recovItem.matchEqualVerify"}},[e._v(" 量级对等 ")])],1)})),0):e._e(),-1!==e.paramVerifyMap&&19===i.id?a("div",e._l(e.paramVerifyMap,(function(t,s){return a("div",{key:s},[a("a-input-group",{attrs:{compact:""}},[a("a-input",{staticStyle:{width:"25%"},attrs:{placeholder:"字段名称",disabled:e.checkDisabled||e.checkDisabledBySelectedID(i.id)},model:{value:t.param,callback:function(a){e.$set(t,"param",a)},expression:"paramItem.param"}}),a("a-input",{staticStyle:{width:"40%"},attrs:{placeholder:"取值范围:以-分隔，如：1.1-2.4",disabled:e.checkDisabled||e.checkDisabledBySelectedID(i.id)},model:{value:t.range,callback:function(a){e.$set(t,"range",a)},expression:"paramItem.range"}}),a("a-checkbox",{staticStyle:{display:"inline-block",margin:"5px",width:"25%"},attrs:{disabled:e.checkDisabled||e.checkDisabledBySelectedID(i.id)},model:{value:t.eachOpVerify,callback:function(a){e.$set(t,"eachOpVerify",a)},expression:"paramItem.eachOpVerify"}},[e._v(" 每个op均满足 ")]),a("a-button",{staticStyle:{width:"5%"},attrs:{type:"link",shape:"circle",icon:"close-circle",disabled:e.checkDisabled||e.checkDisabledBySelectedID(i.id)},on:{click:function(t){return e.removeArg(i.id,s)}}})],1)],1)})),0):e._e(),-1!==e.relationVerifyMap&&20===i.id?a("div",e._l(e.relationVerifyMap,(function(t,s){return a("div",{key:s},[a("a-row",{staticStyle:{"margin-bottom":"10px"},attrs:{type:"flex"}},[a("a-col",{staticStyle:{margin:"auto 0",fontSize:"12px"},attrs:{span:8}},[a("span",[e._v("case中至少有一个op命名为:")])]),a("a-col",{attrs:{span:13}},[a("a-input",{attrs:{placeholder:"请输入",disabled:e.checkDisabled||e.checkDisabledBySelectedID(i.id)},model:{value:t.opNameRule,callback:function(a){e.$set(t,"opNameRule",a)},expression:"relationItem.opNameRule"}})],1)],1),a("a-row",{staticStyle:{"margin-bottom":"10px","font-size":"12px"},attrs:{type:"flex"}},[a("a-col",{staticStyle:{margin:"auto 0"},attrs:{span:8}},[a("a-checkbox",{attrs:{disabled:e.checkDisabled||e.checkDisabledBySelectedID(i.id)},model:{value:t.assertVerify,callback:function(a){e.$set(t,"assertVerify",a)},expression:"relationItem.assertVerify"}},[e._v(" 该命名op存在 ")])],1),a("a-col",{attrs:{span:13}},[a("a-select",{staticStyle:{width:"80%"},attrs:{disabled:e.checkDisabled||e.checkDisabledBySelectedID(i.id)},model:{value:t.assertType,callback:function(a){e.$set(t,"assertType",a)},expression:"relationItem.assertType"}},[a("a-select-option",{attrs:{value:"kv"}},[e._v("kv包含")]),a("a-select-option",{attrs:{value:"unKv"}},[e._v("kv不包含")]),a("a-select-option",{attrs:{value:"include"}},[e._v("json包含")]),a("a-select-option",{attrs:{value:"header"}},[e._v("header")]),a("a-select-option",{attrs:{value:"sql"}},[e._v("sql")])],1),e._v(" 断言 ")],1)],1)],1)})),0):e._e(),-1!==e.scriptVerifyMap&&40===i.id?a("div",[a("a-input-group",{attrs:{compact:""}},[a("a-input",{staticStyle:{width:"40%"},attrs:{placeholder:"脚本获取路径(wget命令获取)",disabled:e.checkDisabled||e.checkDisabledBySelectedID(i.id)},model:{value:e.scriptVerifyMap.cloneCmd,callback:function(t){e.$set(e.scriptVerifyMap,"cloneCmd",t)},expression:"scriptVerifyMap.cloneCmd"}}),a("a-input",{staticStyle:{width:"30%"},attrs:{placeholder:"脚本名",disabled:e.checkDisabled||e.checkDisabledBySelectedID(i.id)},model:{value:e.scriptVerifyMap.scriptName,callback:function(t){e.$set(e.scriptVerifyMap,"scriptName",t)},expression:"scriptVerifyMap.scriptName"}}),a("a-input",{staticStyle:{width:"30%"},attrs:{placeholder:"脚本类名",disabled:e.checkDisabled||e.checkDisabledBySelectedID(i.id)},model:{value:e.scriptVerifyMap.scriptClassName,callback:function(t){e.$set(e.scriptVerifyMap,"scriptClassName",t)},expression:"scriptVerifyMap.scriptClassName"}})],1)],1):e._e()])],1)],1)}))],2)],1)})),0),a("a-col",{staticClass:"edit-checker-container",attrs:{span:12,order:2}},[e.showCheckerDetails?a("a-spin"):a("div",[0===e.checkerDetails.length?a("a-empty"):a("div",e._l(e.checkerDetails,(function(t,i){return a("a-card",{key:i,staticStyle:{marginBottom:"10px"},attrs:{size:"small"}},[a("span",{attrs:{slot:"title"},slot:"title"},[e._v(e._s(t.name))]),a("a-collapse",{attrs:{bordered:!1}},e._l(t.children,(function(t,i){return a("a-collapse-panel",{key:i,attrs:{disabled:t.result}},[a("div",{attrs:{slot:"header"},slot:"header"},[a("span",[e._v("测试选项："+e._s(t.name))]),a("a-tag",{staticStyle:{margin:"auto 10px"},attrs:{color:t.result?"green":"red"}},[e._v(" "+e._s(t.result?"success":"fail")+" ")]),a("a",{directives:[{name:"show",rawName:"v-show",value:0!==t.logTraceId,expression:"cItem.logTraceId !== 0"}],attrs:{href:e.getHref(t.logTraceId),target:"_blank"}},[e._v(" "+e._s(t.logTraceId)+" ")])],1),a("a-list",{staticStyle:{margin:"0 10px"},attrs:{"data-source":t.detail},scopedSlots:e._u([{key:"renderItem",fn:function(t){return a("a-list-item",{},[a("a-list-item-meta",[a("a",{attrs:{slot:"title",href:e.getCaseIdHref(t),target:"_blank"},slot:"title"},[a("h5",{staticStyle:{display:"inline-block"}},[e._v(" CASEID: ")]),e._v(" "+e._s(t.caseId)+" ")]),a("div",{attrs:{slot:"description"},slot:"description"},[a("h5",{staticStyle:{display:"inline-block"}},[e._v("CASE链接:")]),a("a",{attrs:{href:e.getCaseLink(t),target:"_blank"}},[e._v(" "+e._s(e.window.location.href.split("#")[0])+" #/testgroup/"+e._s(t.groupId)+"/ "+e._s(t.caseId)+"?productId="+e._s(t.productId)+" ")]),a("div",{staticStyle:{"max-width":"500px"}},[a("h5",{staticStyle:{display:"inline-block"}},[e._v(" 错误信息: ")]),a("span",[e._v(e._s(t.failedMsg))])])])])],1)}}],null,!0)})],1)})),1)],1)})),1)],1)],1)],1),a("div",{attrs:{slot:"footer"},slot:"footer"},[e.window.checkObject&&!e.checkDisabled?a("a-button",{attrs:{type:"primary"},on:{click:e.paste}},[e._v(" 粘贴参数 ")]):e._e(),e.checkDisabled?e._e():a("a-button",{attrs:{type:"primary"},on:{click:e.copy}},[e._v(" 复制参数 ")]),e.checkerShow&&!e.checkDisabled?a("a-button",{attrs:{type:"primary"},on:{click:e.saveCheck}},[e._v(" 保存 ")]):e._e(),e.checkerShow&&!e.checkDisabled?a("a-button",{attrs:{type:"primary"},on:{click:function(t){return e.check("suite")}}},[e._v(" 检测 ")]):e._e(),e.checkerShow||e.checkDisabled?e._e():a("a-button",{attrs:{type:"primary"},on:{click:e.recheck}},[e._v(" 重新检测 ")]),a("a-button",{on:{click:e.handleCancel}},[e._v(" 取消 ")])],1)],1)},X=[],Z=(a("a15b"),{data:function(){return{labelCol:{span:6},wrapperCol:{span:14},visible:!1,confirmLoading:!1,nameVerifyMap:[],globalVerifyMap:[],textVerifyMap:[],recoveryVerifyMap:[],paramVerifyMap:[],relationVerifyMap:[],scriptVerifyMap:null,checkerVars:[],checkerShow:!1,selected:[],window:window,detectionGroup:"",checkerDetails:[],showCheckerDetails:!1,checkDisabled:!1}},computed:Object(l["a"])({},Object(d["b"])({currentSelectNode:function(e){return e.treenode.currentSelectTreeNode},currentSuite:function(e){return e.treenode.currentSuite}})),methods:{checkDisabledBySelectedID:function(e){return-1===this.selected.indexOf(e)},recheck:function(){this.checkerShow=!0},paste:function(){this.selected=window.checkObject.selected,this.nameVerifyMap=window.checkObject.specificData.nameVerifyMap,this.globalVerifyMap=window.checkObject.specificData.globalVerifyMap,this.paramVerifyMap=window.checkObject.specificData.paramVerifyMap,this.textVerifyMap=window.checkObject.specificData.textVerifyMap,this.recoveryVerifyMap=window.checkObject.specificData.recoveryVerifyMap,this.relationVerifyMap=window.checkObject.specificData.relationVerifyMap,this.scriptVerifyMap=window.checkObject.specificData.scriptVerifyMap,this.$message.success("粘贴成功")},copy:function(){if(this.detectionGroup=this.selected.join(),this.detectionGroup){var e={nameVerifyMap:this.nameVerifyMap,globalVerifyMap:this.globalVerifyMap,paramVerifyMap:this.paramVerifyMap,textVerifyMap:this.textVerifyMap,recoveryVerifyMap:this.recoveryVerifyMap,relationVerifyMap:this.relationVerifyMap,scriptVerifyMap:this.scriptVerifyMap};window.checkObject=JSON.parse(JSON.stringify({selected:this.selected,specificData:e})),this.$forceUpdate(),this.$message.success("复制成功")}},getCaseLink:function(e){return"#/testgroup/".concat(e.groupId,"/").concat(e.caseId,"?productId=").concat(e.productId)},getCaseIdHref:function(e){return"#/testgroup/".concat(e.groupId,"/").concat(e.caseId,"?productId=").concat(e.productId)},getHref:function(e){return"http://eplog.baidu-int.com:8091/index.html?logId=".concat(e)},check:function(e){var t=this,a={};if("suite"===e)if(this.detectionGroup=this.selected.join(),this.detectionGroup){this.showCheckerDetails=!0,this.checkerShow=!1;var i={nameVerifyMap:this.nameVerifyMap,globalVerifyMap:this.globalVerifyMap,paramVerifyMap:this.paramVerifyMap,textVerifyMap:this.textVerifyMap,recoveryVerifyMap:this.recoveryVerifyMap,relationVerifyMap:this.relationVerifyMap,scriptVerifyMap:this.scriptVerifyMap};a=this.currentSelectNode.data.versionId?{suiteId:this.currentSelectNode.data.id,checkerTypes:this.detectionGroup,specific:i,versionId:this.currentSelectNode.data.versionId}:{suiteId:this.currentSelectNode.data.id,checkerTypes:this.detectionGroup,specific:i}}else this.$message.warn("请至少选择一个");else if("run"===e){this.detectionGroup=this.selected.join(),console.log(this.detectionGroup,589);var s={nameVerifyMap:this.nameVerifyMap,globalVerifyMap:this.globalVerifyMap,paramVerifyMap:this.paramVerifyMap,textVerifyMap:this.textVerifyMap,recoveryVerifyMap:this.recoveryVerifyMap,relationVerifyMap:this.relationVerifyMap};a={suiteId:this.currentSuite.data.id,caseId:this.currentSelectNode.data.id,checkerTypes:this.detectionGroup,specific:s}}this.detectionGroup?Object(b["e"])(this.$route.params.id,a).then((function(a){if(a.status)t.$message.error(a.message);else if("suite"===e)t.checkerDetails=JSON.parse(a.data).checkerItemList,t.showCheckerDetails=!1;else if("run"===e){var i=JSON.parse(a.data).checkerItemList,s=[];for(var n in i){var o=i[n].children,r=!0;if(o&&o.length>0){for(var c=0;c<o.length;c++)o[c].result||(r=!1);r||s.push(i[n])}}s&&s.length>0?(t.visible=!0,t.checkerDetails=s):(t.$emit("isCheckSuc",t.visible),t.$message.success("检测成功，运行中..."))}})).catch((function(e){})):(this.$emit("isCheckSuc",this.visible),this.$message.success("检测成功，运行中..."))},saveCheck:function(){var e=this;if(this.detectionGroup=this.selected.join(),this.detectionGroup){var t={nameVerifyMap:this.nameVerifyMap,globalVerifyMap:this.globalVerifyMap,paramVerifyMap:this.paramVerifyMap,textVerifyMap:this.textVerifyMap,recoveryVerifyMap:this.recoveryVerifyMap,relationVerifyMap:this.relationVerifyMap,scriptVerifyMap:this.scriptVerifyMap},a={};a=this.currentSelectNode.data.versionId?{suiteId:this.currentSelectNode.data.id,checkerTypes:this.detectionGroup,specific:t,versionId:this.currentSelectNode.data.versionId}:{suiteId:this.currentSelectNode.data.id,checkerTypes:this.detectionGroup,specific:t},Object(b["c"])(this.$route.params.id,a).then((function(t){t.status?e.$message.success(t.message):(e.visible=!1,e.$message.success("保存成功！"))})).catch((function(e){}))}},removeArg:function(e,t){16===e&&(this.globalVerifyMap.splice(t,1),this.globalVerifyMap.length||this.clickArgInput(e)),19===e&&(this.paramVerifyMap.splice(t,1),this.paramVerifyMap.length||this.clickArgInput(e))},clickArgInput:function(e){if(16===e){var t={param:"",outOfCaseName:"",outOfOpName:""};this.globalVerifyMap.push(t)}if(19===e){var a={param:"",range:"",eachOpVerify:!1};this.paramVerifyMap.push(a)}},updateSelection:function(e,t){var a=e.target,i=a.checked?"add":"remove";this.updateSelected(i,t)},updateAllSelection:function(e,t){var a=e.target,i=a.checked?"add":"remove";for(var s in t)19!==t[s].id&&this.updateSelected(i,t[s].id)},isSelected:function(e){return this.selected.indexOf(e)>=0},isAllSelected:function(e){var t=!0;for(var a in e){var i=e[a];19!==i.id&&-1===this.selected.indexOf(i.id)&&(t=!1)}return t},openCheck:function(e){var t=this;if(this.checkerDetails=[],this.selected=[],"suite"===e){var a=[];a=this.currentSelectNode.data.versionId?[{suiteId:this.currentSelectNode.data.id,groupId:this.$route.params.id,versionId:this.currentSelectNode.data.versionId}]:[{suiteId:this.currentSelectNode.data.id,groupId:this.$route.params.id}],Object(b["d"])(this.$route.params.id,{checkItemList:a}).then((function(e){e.status?t.$message.error(e.message):(t.prettyDetectData(e.data),t.checkDisabled=!1,t.visible=!0)})).catch()}else if("run"===e){var i=this.currentSuite.data.id,s=[{suiteId:i}];Object(b["f"])(this.$route.params.id,{checkItemList:s}).then((function(e){e.status?t.$message.error(e.message):(t.prettyDetectData(e.data),t.checkDisabled=!0,t.check("run"))})).catch((function(e){}))}},prettyDetectData:function(e){var t=this,a=JSON.parse(e);this.nameVerifyMap=[{ifCheck:!1,type:"case",rule:""},{ifCheck:!1,type:"suite",rule:""}],this.globalVerifyMap=[{param:"",outOfCaseName:"",outOfOpName:""}],this.textVerifyMap=[{caseIf:!1,suiteIf:!1}],this.recoveryVerifyMap=[{setUp:"",tearDown:"",matchEqualVerify:!1}],this.paramVerifyMap=[{param:"",range:"",eachOpVerify:!1}],this.relationVerifyMap=[{opNameRule:"",assertVerify:!1,assertType:"kv"}],this.scriptVerifyMap={gitPath:"",cloneCmd:"",scriptName:"",scriptClassName:""},this.checkerVars=a,console.log(this.checkerVars,844),this.checkerShow=!0,this.checkerVars.forEach((function(e){e.children&&e.children.forEach((function(e){if(+e.isDefault||(t.selected.push(e.id),t.updateSelected("add",e.id)),e.hasOwnProperty("verifyMap"))switch(e.id){case 15:t.nameVerifyMap=e.verifyMap;break;case 16:t.globalVerifyMap=e.verifyMap;break;case 21:t.textVerifyMap=e.verifyMap;break;case 18:t.recoveryVerifyMap=e.verifyMap;break;case 19:t.paramVerifyMap=e.verifyMap;break;case 20:t.relationVerifyMap=e.verifyMap;break;case 40:t.scriptVerifyMap=e.verifyMap;break}}))}))},updateSelected:function(e,t){"add"===e&-1===this.selected.indexOf(t)&&this.selected.push(t),"remove"===e&&-1!==this.selected.indexOf(t)&&this.selected.splice(this.selected.indexOf(t),1)},handleOk:function(){this.visible=!1},handleCancel:function(){this.visible=!1}}}),ee=Z,te=(a("c219"),Object($["a"])(ee,Q,X,!1,null,"15178b82",null)),ae=te.exports,ie=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("a-modal",{staticStyle:{position:"relative"},attrs:{title:"批量操作",width:800,"body-style":{height:"500px",overflow:"auto"},visible:e.visible,"confirm-loading":e.confirmLoading,"ok-text":"提交","cancel-text":"取消"},on:{ok:e.handleOk,cancel:e.handleCancel}},[a("div",{staticClass:"label-radio-group"},[a("h4",[e._v("请勾选相应的文件，进行 "),a("span",{staticStyle:{color:"#00688B"}},[e._v(" "+e._s(e.showTitleTips)+" ")]),e._v(" 操作")])]),e.caseTreeNodes.length?a("a-tree",{attrs:{checkable:"","tree-data":e.caseTreeNodes,"show-line":!0,"show-icon":!0,"selected-keys":e.selectedKeys,"expanded-keys":e.expandedKeys,"load-data":e.onLoadData},on:{expand:e.onExpand,select:e.onSelect,check:e.onCheck}},[a("a-icon",{attrs:{slot:"case",theme:"twoTone",type:"play-circle"},slot:"case"}),a("a-icon",{attrs:{slot:"setup",type:"plus-circle",theme:"twoTone"},slot:"setup"}),a("a-icon",{attrs:{slot:"teardown",type:"minus-circle",theme:"twoTone"},slot:"teardown"}),a("a-icon",{attrs:{slot:"other",type:"folder",theme:"twoTone"},slot:"other"}),a("a-icon",{attrs:{slot:"expend",type:"folder-open",theme:"twoTone"},slot:"expend"})],1):e._e(),e.caseTreeNodes.length?e._e():a("a-spin",{staticStyle:{margin:"60px"},attrs:{tip:"加载中..."}})],1)},se=[],ne={data:function(){return{labelCol:{span:6},wrapperCol:{span:14},visible:!1,confirmLoading:!1,versionHandle:null,showTitleTips:"",caseTreeNodesTemp:null,caseTreeNodes:[],expandedKeys:[],selectedKeys:[],checkedKeys:[],halfCheckedKeys:[],haveCase:!1,targetNode:[]}},computed:Object(l["a"])({},Object(d["b"])({versionId:function(e){return e.treenode.versionId}})),watch:{},methods:{onCheck:function(e,t){this.checkedKeys=Object(h["a"])(e),this.halfCheckedKeys=Object(h["a"])(t.halfCheckedKeys);for(var a=[],i=0;i<this.checkedKeys.length;i++){var s=this.findChildByKey(this.caseTreeNodesTemp,this.checkedKeys[i]);Object(f["a"])(s,(function(e){-1===a.indexOf(e.data.id)&&a.push(e.data.id)}))}for(var n=0;n<a.length;n++)-1===this.checkedKeys.indexOf(a[n])&&this.checkedKeys.push(a[n])},initNodeTree:function(){var e=this;switch(this.versionHandle.prop){case"PUT":Object(m["t"])({groupId:this.$route.params.id,type:2}).then((function(t){t.status?e.$message.error(t.message):(e.caseTreeNodesTemp=t.data,e.getFirstSuite(e.caseTreeNodesTemp))})).catch((function(e){}));break;case"POST":case"DELETE":Object(b["n"])({versionId:this.versionId,groupId:this.$route.params.id}).then((function(t){t.status?e.$message.error(t.message):(e.caseTreeNodesTemp=t.data,e.getFirstSuite(e.caseTreeNodesTemp))})).catch((function(e){}));break}},getFirstSuite:function(e){var t=this;this.caseTreeNodes=[];var a={};a.data=e.data,a.title=e.data.text,a.key=e.data.id,a.type=e.data.type,a.slots={icon:"expend"},a.scopedSlots={title:"title"},a.isLeaf=this.isLeafNode(e),a.children=[],e.children.forEach((function(e){a.children.push({key:e.data.id,title:e.data.text,type:e.data.type,data:e.data,isLeaf:t.isLeafNode(e),scopedSlots:{title:"title"},slots:{icon:t.getTreeNodeType(e)}})})),this.caseTreeNodes.push(a),this.expandedKeys=[a.key]},onSelect:function(e,t){},onExpand:function(e,t){this.expandedKeys=e,this.autoExpandParent=!1,t.expanded?this.$set(t.node.dataRef.slots,"icon","expend"):this.$set(t.node.dataRef.slots,"icon","other")},findChildByKey:function(e,t){var a=[];return Object(f["a"])(e,(function(e){+e.data.id===+t&&(a=e.children)})),a},onLoadData:function(e){var t=this;return new Promise((function(a){var i=t.findChildByKey(t.caseTreeNodesTemp,e.eventKey)||[];e.dataRef.children||0===i.length?a():setTimeout((function(){e.dataRef.children=[],i.forEach((function(a){e.dataRef.children.push({title:a.data.text,key:a.data.id,data:a.data,isLeaf:t.isLeafNode(a),type:a.data.type,scopedSlots:{title:"title"},slots:{icon:t.getTreeNodeType(a)}})})),t.caseTreeNodes=Object(h["a"])(t.caseTreeNodes),a()}),10)}))},isLeafNode:function(e){return["case","setup","teardown"].indexOf(e.data.type)>-1||0===e.children.length},getTreeNodeType:function(e){return["case","setup","teardown"].indexOf(e.data.type)>-1?e.data.type:this.expandedKeys.indexOf(e.data.id)>-1?"expend":"other"},open:function(e){this.caseTreeNodesTemp=null,this.caseTreeNodes=[],this.checkedKeys=[],this.expandedKeys=[],this.halfCheckedKeys=[],this.versionHandle=e,this.showTitleTips=this.versionHandle.name,this.initNodeTree(),this.visible=!0},handleOk:function(){if(this.checkedKeys.length){var e=this.checkedKeys.concat(this.halfCheckedKeys);this.getTargetNode(e);var t=this.fromatIdsList(this.targetNode),a=this.fromatIdsListAll(this.targetNode),i={groupId:this.$route.params.id,versionId:this.versionId,idList:t},s={groupId:this.$route.params.id,versionId:this.versionId,idList:a};if(t.length){switch(this.versionHandle.prop){case"PUT":this.getApIBatchVersionPut(s);break;case"POST":this.postApIBatchVersion(i);break;case"DELETE":this.deleteApIBatchVersion(i);break}this.visible=!1}else this.$message.warn("无法对空目录进行提交～请重新选择")}else this.$message.error("请选择目标目录后再提交")},postApIBatchVersion:function(e){var t=this,a={versionId:e.versionId,groupId:e.groupId},i={idList:e.idList},s=Object.assign({skipCheck:1},i);Object(b["o"])(a,s).then((function(e){e.status||(+e.data.mergeStatus?t.$message.error("部分节点存在合入冲突"+e.data.mergeConflict+"，建议这些节点手动合入"):t.$message.success("合入成功"))})).catch((function(e){}))},deleteApIBatchVersion:function(e){var t=this,a=e.idList.join(),i={versionId:e.versionId,groupId:e.groupId,ids:a};Object(b["h"])(i,{idList:e.idList}).then((function(e){e.status||(+e.data.deleteStatus?t.$message.error("部分节点删除失败"+e.data.deleteConflict):t.$message.success("删除成功"),t.$emit("handleSuc"))})).catch((function(e){}))},getApIBatchVersionPut:function(e){var t=this;Object(b["l"])({versionId:e.versionId,groupId:e.groupId},{idList:e.idList}).then((function(e){e.status||(+e.data.pullStatus?t.$message.error("部分节点拉取失败"+e.data.pullConflict):t.$message.success("\b拉取成功"),t.$emit("handleSuc"))})).catch((function(e){}))},fromatIdsList:function(e){var t=[];for(var a in e)"root"!==e[a].data.type&&"suite"!==e[a].data.type&&t.push(e[a].data.id);return t},fromatIdsListAll:function(e){var t=[];for(var a in e)t.push(e[a].data.id);return t},getTargetNode:function(e){var t=this;this.targetNode=[];for(var a=function(a){Object(f["a"])(t.caseTreeNodesTemp,(function(i){i.data.id===e[a]&&t.targetNode.push(i)}))},i=0;i<e.length;i++)a(i)},handleCancel:function(){this.visible=!1}}},oe=ne,re=Object($["a"])(oe,ie,se,!1,null,"397e2758",null),ce=re.exports,le=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("a-modal",{staticStyle:{position:"relative"},attrs:{title:"修改基本信息",width:800,"body-style":{height:"400px",overflow:"auto"},visible:e.visible,"confirm-loading":e.confirmLoading,"ok-text":"保存","cancel-text":"取消",footer:null},on:{ok:e.handleOk,cancel:e.handleCancel}},[e.currentSelectNode?a("a-descriptions",{staticStyle:{maxWidth:"800px"},attrs:{title:"基本信息",size:"small"}},[e.isSetupOrTeardown(e.currentSelectNode)?e._e():a("a-descriptions-item",{attrs:{label:e.isCase(e.currentSelectNode)?"用例":"目录名称"}},[e.showEditName?a("a",{on:{click:e.changeShowEditName}},[e._v(" "+e._s(e.currentSelectNode.data.text)+" ")]):a("a-input",{attrs:{size:"small"},on:{blur:function(t){return e.saveTitle(e.currentSelectNode)}},model:{value:e.currentSelectNode.data.text,callback:function(t){e.$set(e.currentSelectNode.data,"text",t)},expression:"currentSelectNode.data.text"}})],1),a("a-descriptions-item",{attrs:{label:"生命周期"}},[e._v(" "+e._s(e.getDisplayLife(e.currentSelectNode.data.life))+" ")]),e.isCase(e.currentSelectNode)?e._e():a("a-descriptions-item",{attrs:{label:"case数"}},[e._v(" "+e._s(e.currentSelectNode.data.caseNum?e.currentSelectNode.data.caseNum:"--")+" ")]),a("a-descriptions-item",{attrs:{label:"创建人"}},[e._v(" "+e._s(e.currentSelectNode.data.owner?e.currentSelectNode.data.owner:"--")+" ")]),a("a-descriptions-item",{attrs:{label:"最近更新人"}},[e._v(" "+e._s(e.currentSelectNode.data.lastUpdatePerson?e.currentSelectNode.data.lastUpdatePerson:"--")+" ")]),a("a-descriptions-item",{attrs:{label:"最近更新时间"}},[e._v(" "+e._s(e.getTime(e.currentSelectNode.data.lastUpdateTime))+" ")]),a("a-descriptions-item",{attrs:{label:"等级"}},[a("a-dropdown",{class:{"is-hidden":e.isSetupOrTeardown(e.currentSelectNode)},attrs:{trigger:["click"],disabled:e.isSetupOrTeardown(e.currentSelectNode)}},[a("a",{staticClass:"ant-dropdown-link",on:{click:function(e){return e.preventDefault()}}},[e._v(" "+e._s(e.getNodeLevel(e.currentSelectNode.data.level))+" "),a("a-icon",{attrs:{type:"down"}})],1),a("a-menu",{attrs:{slot:"overlay"},on:{click:e.changeCaseLevel},slot:"overlay"},[e._l(e.caseLevels,(function(t){return[a("a-menu-item",{key:t.id},[e._v(" "+e._s(t.name)+" ")])]}))],2)],1)],1),a("a-descriptions-item",{attrs:{label:"类型"}},[a("a-dropdown",{class:{"is-hidden":e.isSetupOrTeardown(e.currentSelectNode)},attrs:{trigger:["click"],disabled:e.isSetupOrTeardown(e.currentSelectNode)}},[a("a",{staticClass:"ant-dropdown-link",on:{click:function(e){return e.preventDefault()}}},[e._v(" "+e._s(e.getReadType(e.currentSelectNode.data.readOnly))+" "),a("a-icon",{attrs:{type:"down"}})],1),a("a-menu",{attrs:{slot:"overlay"},on:{click:e.changeAuth},slot:"overlay"},[e._l(e.auths,(function(t){return[a("a-menu-item",{key:t.id},[e._v(" "+e._s(t.name)+" ")])]}))],2)],1)],1),e.isCase(e.currentSelectNode)?a("a-descriptions-item",{attrs:{label:"并发"}},[a("a-dropdown",{class:{"is-hidden":!e.isCase(e.currentSelectNode)},attrs:{trigger:["click"]}},[a("a",{staticClass:"ant-dropdown-link",on:{click:function(e){return e.preventDefault()}}},[e._v(" "+e._s(e.getConcurrencyTag(e.currentSelectNode.data.concurrencyTag))+" "),a("a-icon",{attrs:{type:"down"}})],1),a("a-menu",{attrs:{slot:"overlay"},on:{click:e.oncurrencyTagChange},slot:"overlay"},[[a("a-menu-item",{key:0},[e._v("否")]),a("a-menu-item",{key:1},[e._v("是")])]],2)],1)],1):e._e(),e.isRoot(e.currentSelectNode)?e._e():a("a-descriptions-item",{attrs:{label:"测试用途"}},[e.isShowEditDescr?a("a",{on:{click:e.changeShowEditDescr}},[e._v(" "+e._s(e.currentSelectNode.data.note||"--")+" ")]):a("a-textarea",{staticStyle:{"min-width":"250px"},attrs:{"auto-size":{minRows:1,maxRows:5},placeholder:"请输入测试用途"},on:{blur:e.saveDescr},model:{value:e.currentSelectNode.data.note,callback:function(t){e.$set(e.currentSelectNode.data,"note",t)},expression:"currentSelectNode.data.note"}})],1),e.isSuite(e.currentSelectNode)?a("a-descriptions-item",{attrs:{label:"特殊Tag"}},[e.isShowEditSpeciTag?a("a",{on:{click:e.changeShowEditSpecialTag}},[e._v(" "+e._s(e.currentSelectNode.data.specialNote||"--")+" ")]):a("a-textarea",{staticStyle:{"min-width":"250px"},attrs:{"auto-size":{minRows:1,maxRows:5},placeholder:"请输入特殊tag"},on:{blur:e.saveDescr},model:{value:e.currentSelectNode.data.specialNote,callback:function(t){e.$set(e.currentSelectNode.data,"specialNote",t)},expression:"currentSelectNode.data.specialNote"}})],1):e._e()],1):e._e()],1)},de=[],ue=a("cf45"),pe={data:function(){return{visible:!1,confirmLoading:!1,showEditName:!0,isShowEditDescr:!0,isShowEditSpeciTag:!0,auths:[{id:1,name:"读写"},{id:2,name:"只读"}],caseLevels:[{id:1,name:"L1(高)"},{id:2,name:"L2(中)"},{id:4,name:"L3(低)"},{id:8,name:"L4(极低)"}]}},computed:Object(l["a"])({},Object(d["b"])({currentSelectNode:function(e){return e.treenode.currentSelectTreeNode}})),methods:{open:function(){this.visible=!0},handleOk:function(){this.visible=!1},handleCancel:function(){this.visible=!1},saveTitle:function(){var e=this;this.currentSelectNode.data.text?(Object(m["P"])({text:this.currentSelectNode.data.text,versionId:this.currentSelectNode.data.versionId},{id:this.currentSelectNode.data.id,typeTag:this.currentSelectNode.data.type}).then((function(t){t.status||e.$emit("updateTitleSuc",{title:e.currentSelectNode.data.text})})).catch((function(e){})),this.showEditName=!0):this.$message.warn("名称不能为空")},isCase:function(e){return["case","setup","teardown"].indexOf(e&&e.data&&e.data.type)>-1},isSetupOrTeardown:function(e){return["setup","teardown"].indexOf(e&&e.data&&e.data.type)>-1},isRoot:function(e){return["root"].indexOf(e&&e.data&&e.data.type)>-1},isSuite:function(e){return["suite"].indexOf(e&&e.data&&e.data.type)>-1},changeShowEditName:function(){this.showEditName=!this.showEditName},changeCaseLevel:function(e){var t=this;Object(m["P"])({level:e.key,versionId:this.currentSelectNode.data.versionId},{id:this.currentSelectNode.data.id,typeTag:"case"}).then((function(a){a.status||(t.currentSelectNode.data.level=e.key)})).catch((function(e){}))},changeShowEditDescr:function(){this.isShowEditDescr=!this.isShowEditDescr},getDisplayLife:function(e){return{0:"new",1:"stable",2:"unstable",3:"death"}[e]||"--"},getTime:function(e){return Object(ue["i"])(e)},getNodeLevel:function(e){return{1:"L1(高)",2:"L2(中)",4:"L3(低)",8:"L4(极低)"}[e]||"--"},getReadType:function(e){return{1:"读写",2:"只读"}[e]||"--"},getConcurrencyTag:function(e){return{0:"否",1:"是"}[e]||"--"},changeShowEditSpecialTag:function(){this.isShowEditSpeciTag=!this.isShowEditSpeciTag},changeAuth:function(e){var t=this;Object(m["P"])({readOnly:e.key,versionId:this.currentSelectNode.data.versionId},{id:this.currentSelectNode.data.id,typeTag:"case"}).then((function(a){a.status||t.$set(t.currentSelectNode.data,"readOnly",e.key)})).catch((function(e){}))},oncurrencyTagChange:function(e){var t=this;Object(m["P"])({concurrencyTag:e.key,versionId:this.currentSelectNode.data.versionId},{id:this.currentSelectNode.data.id,typeTag:"case"}).then((function(a){a.status||(t.$set(t.currentSelectNode.data,"concurrencyTag",+e.key),t.$forceUpdate())})).catch((function(e){}))},saveDescr:function(){var e=this;Object(m["P"])({specialNote:this.currentSelectNode.data.specialNote,note:this.currentSelectNode.data.note,versionId:this.currentSelectNode.data.versionId},{id:this.currentSelectNode.data.id,typeTag:this.currentSelectNode.data.type}).then((function(t){e.isShowEditDescr=!0,e.isShowEditSpeciTag=!0})).catch((function(e){}))}}},he=pe,fe=Object($["a"])(he,le,de,!1,null,null,null),me=fe.exports,ye=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("div",{staticStyle:{color:"red"}},[e._v(" 请先选择目录结构，再输入搜索 ")]),e.caseTreeNodesUriSearch.length?a("a-tree",{attrs:{"tree-data":e.caseTreeNodesUriSearch,checkable:"","show-line":!0,"show-icon":!0,"expanded-keys":e.expandedKeys,"check-strictly":""},on:{"update:expandedKeys":function(t){e.expandedKeys=t},"update:expanded-keys":function(t){e.expandedKeys=t},expand:e.onExpand,check:e.onCheck}},[a("a-icon",{attrs:{slot:"other",type:"folder",theme:"twoTone"},slot:"other"}),a("a-icon",{attrs:{slot:"expend",type:"folder-open",theme:"twoTone"},slot:"expend"})],1):a("a-spin",{staticStyle:{margin:"60px"},attrs:{tip:"加载中..."}})],1)},ve=[],ge={props:{caseTreeNodesUriSearch:{type:Array,default:function(){return[]}}},data:function(){return{expandedKeys:[],checkedKeys:[]}},methods:{onExpand:function(e,t){this.expandedKeys=e,t.expanded?this.$set(t.node.dataRef.slots,"icon","expend"):this.$set(t.node.dataRef.slots,"icon","other")},onCheck:function(e){this.checkedKeys=e.checked,this.$emit("uriSearchCheckedKeys",this.checkedKeys)}}},be=ge,Se=Object($["a"])(be,ye,ve,!1,null,"c16e6358",null),ke=Se.exports,xe=a("eeed"),we={computed:Object(l["a"])({},Object(d["b"])({currentProductLine:function(e){return e.productline.currentProductLine},versionId:function(e){return e.treenode.versionId},currentSelectNode:function(e){return e.treenode.currentSelectTreeNode},ifExtraVersion:function(e){return e.treenode.ifExtraVersion}})),components:{CopyOrMove:E,CreateSuite:A,CreateCase:B,DynamicData:Y,DetectionDlg:ae,branchVersion:ce,UpdateBaseInfo:me,uriSearchTree:ke},watch:{versionId:function(){this.caseTreeNodes=[],this.selectedKeys=[],this.queryTreeNode(),this.addQuickKey()},searchValue:function(){if(""===this.searchValue&&"1"===this.treeSearchValue)this.handleTreeSearch=!1,this.uriSearch=!1,this.uriSearchCheckedKeys=[],this.treeSearchValue,this.queryTreeNode();else{if(this.handleTreeSearch=!0,"2"===this.treeSearchValue){if(!this.uriSearchCheckedKeys.length)return;this.uriSearch=!1}this.getTreeDataSearch()}}},destroyed:function(){k.a.unbind("option+c, alt+c"),k.a.unbind("option+x, alt+x"),k.a.unbind("option+v, alt+v"),k.a.unbind("d"),k.a.unbind("option+d, alt+d")},mounted:function(){var e=this;this.queryTreeNode(),this.addQuickKey();var t=window.localStorage.getItem("treeOptions")||"";this.treeOptions="isKnow"!==t,window.addEventListener("popstate",(function(t){setTimeout((function(){e.$nextTick((function(){e.$refs["title".concat(e.$route.params.caseId)]&&e.$refs["title".concat(e.$route.params.caseId)].click()}))}),200)}),!1)},data:function(){return{selectTreeNode:null,caseTreeNodes:[],selectedKeys:[],expandedKeys:[],SearchExpandedKeys:[],loadedKeys:[],defaultExpandParent:!0,autoExpandParent:!0,searchValue:"",treeSearchValue:"1",treeSearchOption:[{id:"1",name:"CASE"},{id:"2",name:"URI"}],showLine:!0,showIcon:!0,isMultiple:!1,onlyKey:"",selectedFalse:!0,expandedKeysTemp:[],steps:[],childs:[],versionControl:null,beforeTreeLoadDate:void 0,caseTreeNodesSearch:[],handleTreeSearch:!1,curCaseTreeNodesSearch:[],searchInputLastTime:0,moveLastTime:0,movePasteLastTime:0,delLastTime:0,dupLastTime:0,copyLastTime:0,copyPasteLastTime:0,quickOptionType:void 0,versionBtns:[{id:1,name:"拉取",prop:"PUT"},{id:2,name:"合入",prop:"POST"},{id:3,name:"删除",prop:"DELETE"}],versionHandle:null,treeOptions:void 0,uriSearch:!1,uriSearchTreeNode:[],caseTreeNodesUriSearch:[],uriSearchCheckedKeys:[]}},methods:{onDragEnter:function(e){console.log(e,1009)},onDragStart:function(e){+this.selectTreeNode.dataRef.key!==+e.node.dataRef.data.id&&this.$refs["title".concat(e.node.dataRef.data.id)].click()},onDrop:function(e){var t=this,a=e.dragNode.dataRef,i=e.node.dataRef,s=this.findParent(this.caseTreeNodes,a.data.id),n=this.findParent(this.caseTreeNodes,i.data.id);if("case"===a.data.type&&s.data.id===n.data.id){+this.selectTreeNode.dataRef.key!==+a.data.id&&this.$refs["title".concat(e.node.dataRef.data.id)].click();var o=1;n.children.forEach((function(e){"suite"===e.data.type&&"root"===e.data.type||(e.sequence=o,o+=1)}));for(var r,c,l=e.dropToGap,d=e.dropPosition,u=e.node.pos.split("-"),p=d-Number(u[u.length-1]),h={id:a.data.id,parentId:s.data.id,type:2},f=0;f<n.children.length;f++)+n.children[f].data.id===+a.data.id&&(r=n.children[f].sequence,f),+n.children[f].data.id===+i.data.id&&(c=n.children[f].sequence,f);var y=!1;+r>+c&&(y=!0),h.sequence=l?-1===p?y?c:c-1:y?c+1:c:d+1,Object(m["c"])(h).then((function(e){var a=e.status,i=e.message;a?t.$message.error(i):t.queryTreeNode()})).catch()}else this.$message.warn("只能在同SUITE下拖拽CASE！")},getUriSearchCheckedKeys:function(e){this.uriSearchCheckedKeys=e},treeOptionsHandle:function(){window.localStorage.setItem("treeOptions","isKnow"),this.treeOptions=!1},clickTitle:function(e,t){t&&this.selectTreeNode.dataRef.key!==e.eventKey&&this.$refs["title".concat(e.eventKey)].click()},addQuickKey:function(){var e=this;k()("option+d, alt+d",(function(){return 0===e.dupLastTime||clearTimeout(e.dupLastTime),e.dupLastTime=setTimeout((function(){e.dupCopy()}),1e3),!1})),k()("d",(function(){return 0===e.delLastTime||clearTimeout(e.delLastTime),e.delLastTime=setTimeout((function(){"-1"===e.versionId||""===e.versionId?e.treeNodeDelete(e.currentSelectNode):e.deleteApIBatchVersion(e.currentSelectNode)}),1e3),!1})),k()("option+c, alt+c",(function(){return 0===e.moveLastTime||clearTimeout(e.moveLastTime),e.moveLastTime=setTimeout((function(){e.moveTreeNode(!0)}),1e3),!1})),k()("option+x, alt+x",(function(){return 0===e.movePasteLastTime||clearTimeout(e.movePasteLastTime),e.movePasteLastTime=setTimeout((function(){e.moveTreeNode(!1)}),1e3),!1})),k()("option+v, alt+v",(function(){return 0===e.copyPasteLastTime||clearTimeout(e.copyPasteLastTime),e.copyPasteLastTime=setTimeout((function(){e.movePasteTreeNode(e.quickOptionType)}),1e3),!1}))},deleteApIBatchVersion:function(e){var t=this;"root"!==e.data.type?this.$confirm({title:"提示",content:"真的要删除【"+e.title+"】吗？",onOk:function(){var a={versionId:e.data.versionId,groupId:t.$route.params.id,ids:e.data.id.toString()};Object(b["h"])(a,{idList:[e.data.id]}).then((function(e){e.status||(+e.data.deleteStatus?t.$message.error("部分节点删除失败"+e.data.deleteConflict):(t.$message.success("删除成功"),t.queryTreeNode()))})).catch((function(e){}))},onCancel:function(){}}):this.$message.error("根节点无法删除, 若要删除请到【平台用例集合】中删除测试集合。")},changeVersionHandle:function(e){for(var t=0;t<this.versionBtns.length;t++)if(+e.key===+this.versionBtns[t].id){this.versionHandle=this.versionBtns[t];break}this.versionHandle&&this.$refs.branchVersion.open(this.versionHandle)},hasTeardown:function(e){for(var t=e.children||[],a=0;a<t.length;a++)if("teardown"===t[a].data.type)return!0;return!1},hasSetup:function(e){for(var t=e.children||[],a=0;a<t.length;a++)if("setup"===t[a].data.type)return!0;return!1},createCase:function(){this.$refs.createCase.add()},createSuite:function(){this.$refs.createSuite.add()},copyOrMoveTo:function(){this.$refs.copyOrMove.add()},movePasteTreeNode:function(e){var t=this;if(void 0!==e)if(window.moveTreeNode&&void 0!==window.moveTreeNode){if(window.moveTreeNode.key===this.selectTreeNode.dataRef.key)return void this.$message.warn("目标节点和复制移动节点不能一样！");"root"===this.selectTreeNode.dataRef.data.type||"suite"===this.selectTreeNode.dataRef.data.type?e?Object(m["f"])({id:window.moveTreeNode.key,parentId:this.selectTreeNode.dataRef.key},{type:window.moveTreeNode.data.type,versionId:window.moveTreeNode.data.versionId}).then((function(e){if(!e.status){if(t.queryTreeNode(),"suite"===window.moveTreeNode.data.type){var a={productId:t.$route.query.productId,nodeId:e.data.id,nodeType:1,opType:0,cost:0};g(a)}else{var i={productId:t.$route.query.productId,nodeId:e.data.id,nodeType:2,opType:0,cost:0};g(i)}setTimeout((function(){t.$refs["title".concat(e.data.id)].click()}),3e3)}})).catch((function(e){})):Object(m["y"])({id:window.moveTreeNode.key,parentId:this.selectTreeNode.dataRef.key}).then((function(e){e.status?t.$message.error("移动失败"):t.queryTreeNode()})).catch((function(e){})):this.$message.warn("请选择root或suite节点进行复制/移动")}else this.$message.warn("请先选择要复制或移动的节点");else this.$message.warn("请先进行复制或剪切操作！")},dupCopy:function(){var e=this,t=this.findParent(this.caseTreeNodes,this.currentSelectNode.key);Object(m["f"])({id:this.currentSelectNode.key,parentId:t.key},{type:this.currentSelectNode.type,versionId:this.currentSelectNode.data.versionId}).then((function(t){if(t.status)e.$message.error(t.message);else{e.queryTreeNode();var a={productId:e.$route.query.productId,nodeId:t.data.id,nodeType:2,opType:0,cost:0};g(a)}})).catch((function(e){}))},moveTreeNode:function(e){-1===["root","setup","teardown"].indexOf(this.currentSelectNode.type)?(this.quickOptionType=e,window.moveTreeNode=Object(l["a"])({},this.currentSelectNode),window.moveTreeNodeParent=this.findParent(this.caseTreeNodes,this.currentSelectNode.key),e?this.$message.success("复制成功！"):this.$message.success("剪切成功！")):this.$message.warn("root, setup, teardown不可复制/移动！")},walkThroughNodesChildFirst:function(e,t,a){for(var i=0;i<e.length;i++){var s=Object(h["a"])(e[i].children);if(s){this.walkThroughNodesChildFirst(s,e[i],a);var n=e[i].data.text.toLowerCase();if(-1===n.indexOf(a)){if(this.isCase(e[i])||!this.isCase(e[i])&&(!e[i].children||!e[i].children.length)){var o=void 0;for(o=0;o<t.children.length;o++)if(t.children[o].data.id===e[i].data.id)break;t.children.splice(o,1)}this.isCase(e[i]&&e[i].children&&e[i].children.length)||this.SearchExpandedKeys.push(e[i].data.id)}else this.isCase(e[i])||this.SearchExpandedKeys.push(e[i].data.id)}}return e},uriSearchWalkThroughNodesChildFirst:function(e,t,a){for(var i=0;i<e.length;i++){var s=Object(h["a"])(e[i].children);if(s&&(this.uriSearchWalkThroughNodesChildFirst(s,e[i],a),-1===a.indexOf(e[i].data.id))){if(this.isCase(e[i])||!this.isCase(e[i])&&(!e[i].children||!e[i].children.length)){var n=void 0;for(n=0;n<t.children.length;n++)if(t.children[n].data.id===e[i].data.id)break;t.children.splice(n,1)}this.isCase(e[i]&&e[i].children&&e[i].children.length)||this.SearchExpandedKeys.push(e[i].data.id)}}return e},searchMatch:function(e,t){var a=e.toLowerCase(),i=t.toLowerCase();return a.indexOf(i)>-1&&i},getLastSubStr:function(e,t){var a=e.toLowerCase(),i=t.toLowerCase();return a.substr(a.indexOf(i)+t.length)},getFirstSubStr:function(e,t){var a=e.toLowerCase(),i=t.toLowerCase();return a.substr(0,a.indexOf(i))},clickVerisonCase:function(e){var t=this;this.versionControl=e,this.selectedKeys=[],this.$nextTick((function(){t.$refs["title".concat(t.currentSelectNode.data.id)].click(),t.versionControl=null}))},clickMasterCase:function(){var e=this;this.selectedKeys=[],this.$nextTick((function(){e.$refs["title".concat(e.currentSelectNode.data.id)].click()}))},queryTreeNode:function(){this.beforeTreeLoadDate=(new Date).getTime(),this.versionId&&("-1"===this.versionId?this.getAllCaseTree():this.getVersionCaseTree())},getVersionCaseTree:function(){var e=this;return Object(o["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,Object(b["n"])({versionId:e.versionId,groupId:e.$route.params.id}).then((function(t){if(!t.status){e.caseTreeNodesTemp=t.data;var a=e.$route.params.caseId?e.$route.params.caseId:e.caseTreeNodesTemp.data.id;e.$router.push({path:"/testgroup/".concat(e.$route.params.id,"/").concat(a),query:{productId:e.$route.query.productId,versionId:e.versionId}}),e.firstInTreeNode(),e.caseTreeNodesSearch=[e.formatCaseTree(e.caseTreeNodesTemp)]}})).catch((function(e){}));case 2:case"end":return t.stop()}}),t)})))()},firstInTreeNode:function(){var e=this,t=this.$route.params.caseId?this.$route.params.caseId:this.caseTreeNodesTemp.data.id;this.expandedKeys=this.getExpendIds(+t),this.getFirstSuite(this.caseTreeNodesTemp),this.expandedKeys=this.expandedKeys.reverse(),this.expandedKeys.forEach((function(t){e.fillChild(t)})),this.$nextTick((function(){try{e.selectTreeNode?(e.$refs["title".concat(e.selectTreeNode.dataRef.data.id)].click(),document.getElementById("".concat(e.selectTreeNode.dataRef.data.id)).scrollIntoView({behavior:"smooth",block:"center",inline:"end"})):(e.$refs["title".concat(t)].click(),document.getElementById("".concat(t)).scrollIntoView({behavior:"smooth",block:"center",inline:"end"}))}catch(a){t=e.caseTreeNodesTemp.data.id,e.$nextTick((function(){e.$refs["title".concat(t)]&&e.$refs["title".concat(t)].click()}))}})),this.doneTreeLoadDate=(new Date).getTime(),console.log("左侧的树形结构加载时间",this.doneTreeLoadDate-this.beforeTreeLoadDate),_hmt.push(["_trackEvent","左侧的树形结构加载时间",this.doneTreeLoadDate-this.beforeTreeLoadDate])},getAllCaseTree:function(){var e=this;return Object(o["a"])(regeneratorRuntime.mark((function t(){var a;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return a={groupId:e.$route.params.id,type:2},t.next=3,Object(m["t"])(a).then((function(t){if(!t.status){e.caseTreeNodesTemp=t.data;var a=e.$route.params.caseId?e.$route.params.caseId:e.caseTreeNodesTemp.data.id;e.$router.push({path:"/testgroup/".concat(e.$route.params.id,"/").concat(a),query:{productId:e.$route.query.productId}}),e.firstInTreeNode(),e.caseTreeNodesSearch=[e.formatCaseTree(e.caseTreeNodesTemp)]}})).catch((function(e){}));case 3:case"end":return t.stop()}}),t)})))()},getCaseTree:function(){var e=this,t={groupId:this.$route.params.id,type:2};Object(m["t"])(t).then((function(t){t.status||e.$store.dispatch("setAllCaseNode",t.data)})).catch((function(e){}))},copyOrMove:function(e){var t=this;1===e.isOppCopy?Object(m["f"])({id:e.id,parentId:e.parentId},{type:e.type}).then((function(a){if(a.data)if(t.findTreeNodeById(e.parentId[0])?(t.queryTreeNode(),t.$message.success("复制成功！")):(console.log("不在当前树节点"),t.$message.success("复制成功！")),"case"===e.type){var i={productId:t.$route.query.productId,nodeId:a.data.id,nodeType:2,opType:0,cost:0};g(i)}else{var s={productId:t.$route.query.productId,nodeId:a.data.id,nodeType:1,opType:0,cost:0};g(s)}})).catch((function(e){})):0===e.isOppCopy&&Object(m["y"])({id:this.selectTreeNode.dataRef.data.id,parentId:e.parentId}).then((function(e){e.status?t.$message.error(e.status):(t.queryTreeNode(),t.$message.success("移动成功！"))})).catch((function(e){}))},inCopyOrMove:function(e){var t=this;0===e.mode?1===e.isOppCopy?Object(m["d"])({outsideIds:e.outsideIds,insideId:e.insideId}).then((function(e){e.status?t.$message.error(e.message):(t.$message.success("复制成功！"),t.queryTreeNode())})).catch():Object(m["x"])({outsideIds:e.outsideIds,insideId:e.insideId}).then((function(e){e.status?t.$message.error(e.message):(t.$message.success("移动成功！"),t.queryTreeNode())})).catch():1===e.isOppCopy?(console.log({outsideIds:e.outsideIds,insideId:e.insideId},1723),Object(m["h"])({outsideIds:e.outsideIds,insideId:e.insideId}).then((function(e){e.status?t.$message.error(e.message):t.$message.success("复制成功！")})).catch()):Object(m["z"])({outsideIds:e.outsideIds,insideId:e.insideId}).then((function(e){e.status?t.$message.error(e.message):(t.$message.success("移动成功！"),t.queryTreeNode())})).catch()},findTreeNodeById:function(e){var t=!1;return Object(f["a"])(this.caseTreeNodesTemp,(function(a){a.data.id===e&&(t=!0)})),t},fillChildDig:function(e){var t=this;return Object(o["a"])(regeneratorRuntime.mark((function a(){var i;return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:return i={groupId:t.$route.params.id,id:e,ifDig:!1},a.next=3,Object(m["w"])(i).then((function(a){a.status||(Object(f["a"])(t.caseTreeNodes,(function(i){if(i.data.id===e){var s=a.data.children;i.children||(i.children=[],s.forEach((function(e){i.children.push({title:e.data.text,key:e.data.id,data:e.data,isLeaf:t.isLeafNode(e),isConflict:t.isConflict(e),type:e.data.type,scopedSlots:{title:"title"},slots:{icon:t.getTreeNodeType(e)}})})))}})),t.caseTreeNodes=Object(h["a"])(t.caseTreeNodes))})).catch((function(e){}));case 3:case"end":return a.stop()}}),a)})))()},fillChild:function(e){var t=this;Object(f["a"])(this.caseTreeNodes,(function(a){if(+e===+a.data.id){var i=t.findChildByKey(t.caseTreeNodesTemp,e);a.children||(a.children=[],i.forEach((function(e){a.children.push({title:e.data.text,key:e.data.id,data:e.data,isLeaf:t.isLeafNode(e),isConflict:t.isConflict(e),type:e.data.type,scopedSlots:{title:"title"},slots:{icon:t.getTreeNodeType(e)}})})))}}))},getExpendIds:function(e){var t=this;return this.expandedKeysTemp.push(e),Object(f["a"])(this.caseTreeNodesTemp,(function(a,i){a.data.id===e&&i&&t.getExpendIds(i.data.id)})),this.expandedKeysTemp},addCase:function(e){if(this.selectTreeNode){var t=this.selectTreeNode.dataRef;t.children||(this.$set(t,"children",[]),this.$set(t,"isLeaf",!1)),t.children.push({title:e.caseForm.text,key:e.key,isLeaf:!0,isConflict:0,scopedSlots:{title:"title"},slots:{icon:"case"},data:{id:e.key,type:"case",text:e.caseForm.text,status:e.caseForm.status,readOnly:e.caseForm.readOnly,note:e.caseForm.note},status:e.caseForm.status}),this.$forceUpdate(),this.selectTreeNode.dataRef.data.caseNum++,g({productId:this.$route.query.productId,nodeId:e.key,nodeType:2,opType:0,cost:0}).then((function(e){})).catch((function(e){})),this.updateCaseNum(this.caseTreeNodes,this.selectTreeNode.dataRef.key,1,"add"),t.isConflict=this.isConflict(t)}},addSuite:function(e){var t=this;if(this.selectTreeNode){var a=this.selectTreeNode.dataRef;a.children||(this.$set(a,"children",[]),this.$set(a,"isLeaf",!1)),a.children.push({title:e.title,key:e.key,isLeaf:!0,isConflict:0,scopedSlots:{title:"title"},slots:{icon:"other"},data:{id:e.key,type:"suite",text:e.title,status:0,versionId:""}}),this.$forceUpdate(),this.$nextTick((function(){t.$refs["title".concat(e.key)].click()}))}},addTearDown:function(e){var t=this,a=this.selectTreeNode.dataRef;a.children||(this.$set(a,"children",[]),this.$set(a,"isLeaf",!1)),a.children.push({title:e.text,key:e.id,isLeaf:!0,isConflict:0,scopedSlots:{title:"title"},slots:{icon:"teardown"},data:Object.assign(e,{type:"teardown"}),status:e.status}),a.isConflict=this.isConflict(a),this.$forceUpdate(),this.$nextTick((function(){t.$refs["title".concat(e.id)].click()}))},createTearDown:function(){var e=this;Object(m["I"])(this.currentSelectNode.data.id).then((function(t){t.data?e.addTearDown(t.data):e.$message.error("糟糕:( /itp/node/".concat(e.currentSelectNode.data.id,"返回的结果为空"))})).catch((function(e){}))},createSetup:function(){var e=this;Object(m["G"])(this.currentSelectNode.data.id).then((function(t){t.data?e.addSetup(t.data):e.$message.error("糟糕:( /itp/node/".concat(e.currentSelectNode.data.id,"返回的结果为空"))})).catch((function(e){}))},addSetup:function(e){var t=this,a=this.selectTreeNode.dataRef;a.children||(this.$set(a,"children",[]),this.$set(a,"isLeaf",!1)),a.children.unshift({title:e.text,key:e.id,isLeaf:!0,isConflict:0,scopedSlots:{title:"title"},slots:{icon:"setup"},data:Object.assign(e,{type:"setup"}),status:e.status}),a.isConflict=this.isConflict(a),this.$forceUpdate(),this.$nextTick((function(){t.$refs["title".concat(e.id)].click()}))},getSuiteInfo:function(e){var t=this.selectTreeNode.dataRef,a=Object(l["a"])({},t);return t.data&&this.isCase(t)&&(a=this.findParent(this.caseTreeNodesTemp,t.data.id)),e?a[e]:a},isCase:function(e){return["case","setup","teardown"].indexOf(e&&e.data&&e.data.type)>-1},isSetupOrTeardown:function(e){return["setup","teardown"].indexOf(e&&e.data&&e.data.type)>-1},getSelectNodeDetail:function(e){var t=this,a=this.getSuiteInfo();this.$store.dispatch("setCurrentSuite",a);var i={};i="-1"===e?{typeTag:this.selectTreeNode.dataRef.data.type,id:this.onlyKey}:{typeTag:this.selectTreeNode.dataRef.data.type,id:this.onlyKey,versionId:e},Object(m["F"])(i).then((function(a){a.data?(a.data.type=t.getNodeTypeString(a.data.type),t.selectTreeNode.dataRef.data=Object.assign(t.selectTreeNode.dataRef.data,Object(l["a"])({},a.data)),t.$store.dispatch("setCurrentSelectTreeNode",t.selectTreeNode.dataRef),t.isCase(t.selectTreeNode.dataRef)&&Object(m["l"])({groupId:t.$route.params.id,id:t.onlyKey,versionId:"-1"===e?"":e}).then((function(e){e.status||s(e.data)})).catch((function(e){}))):t.$message.error("糟糕:/itp/node/".concat(t.selectTreeNode.dataRef.data.type,"/").concat(t.onlyKey,")返回的结果为空"))})).catch((function(e){}));var s=function(e){t.steps=[],t.preStep(e),t.steps.shift(),t.$store.dispatch("setSteps",t.steps)}},preStep:function(e){e=e||{data:{text:"STEP"},children:[]},e.data.showEdit=!1,this.steps.push(e.data);for(var t=0;t<e.children.length;t++)"step"===e.children[t].data.type&&this.preStep(e.children[t])},getTitleHover:function(e){return 1===e.isConflict?"case和suite不能在同一层级并存！冲突的case将被忽略，无法执行，请做进一步调整":2===e.isConflict?"suite, setup和teardown不能在同一层级并存！冲突的case将被忽略，无法执行，请做进一步调整":e.title},getSearchInpputPlaceholder:function(){return"1"===this.treeSearchValue?"请输入case名称":"检测正则，以英文逗号分隔即可 eg: .*yes.*,.*xx.*"},treeNodeDelete:function(e){var t=this;"root"!==e.data.type?this.$confirm({title:"提示",content:"真的要删除【"+e.title+"】吗？",onOk:function(){if("suite"===e.data.type){var a={productId:t.$route.query.productId,nodeId:e.data.id,nodeType:1,opType:2,cost:0};g(a)}if("case"===e.data.type){var i={productId:t.$route.query.productId,nodeId:e.data.id,nodeType:2,opType:2,cost:0};g(i)}Object(m["K"])({id:e.data.id,versionId:-1}).then((function(a){if(a.status)t.$message.error("".concat(a.message));else{if("case"===e.data.type||"suite"===e.data.type){var i=e.data.caseNum?e.data.caseNum:1;t.updateCaseNum(t.caseTreeNodes,e.data.id,i,"remove")}var s=t.findParent(t.caseTreeNodes,e.data.id);t.onlyKey!==e.data.id&&t.onlyKey||t.$refs["title".concat(s.data.id)].click();var n=s.children,o=n.findIndex((function(t){return t.key===e.data.id}));n.splice(o,1),s.isConflict=t.isConflict(s),t.$message.info("已成功删除【".concat(e.title,"】")),0===s.children.length&&(s.isLeaf=!0),t.$forceUpdate()}})).catch((function(e){}))},onCancel:function(){}}):this.$message.error("根节点无法删除, 若要删除请到【平台用例集合】中删除测试集合。")},updateCaseNum:function(e,t,a,i){var s=this;a&&Object(f["a"])(e,(function(n,o){+n.data.id===+t&&o&&("add"===i?o.data.caseNum+=a:o.data.caseNum-=a,s.updateCaseNum(e,o.data.id,a,i))}))},findParent:function(e,t){var a;return Object(f["a"])(e,(function(e,i){+e.data.id===+t&&i&&(a=i)})),a},findChildByKey:function(e,t){var a=[];return Object(f["a"])(e,(function(e){+e.data.id===+t&&(a=e.children)})),a},onLoadData:function(e){var t=this;return new Promise((function(a){var i=t.findChildByKey(t.caseTreeNodesTemp,e.eventKey)||[];if(e.dataRef.children||0===i.length){try{setTimeout((function(){Object(xe["a"])({key:"tree-node-title"}).setOptions({doneLabel:"知道了",prevLabel:"上一个",nextLabel:"下一个",exitOnOverlayClick:!1,exitOnEsc:!1,steps:[{element:document.querySelector(".tree-node-title"),intro:"点击右键可出现操作弹窗哦~"}]}).start()}),1e3)}catch(s){}a()}else setTimeout((function(){e.dataRef.children=[],i.forEach((function(a){e.dataRef.children.push({title:a.data.text,key:a.data.id,data:a.data,isLeaf:t.isLeafNode(a),isConflict:t.isConflict(a),type:a.data.type,scopedSlots:{title:"title"},slots:{icon:t.getTreeNodeType(a)}})})),t.caseTreeNodes=Object(h["a"])(t.caseTreeNodes),a()}),10)}))},isLeafNode:function(e){return["case","setup","teardown"].indexOf(e.data.type)>-1||0===e.children.length},isConflict:function(e){if(!e)return!1;var t=!1,a=!1,i=!1,s=!1,n=0;return e.children.forEach((function(e){"case"===e.data.type&&(t=!0),"suite"===e.data.type&&(a=!0),"setup"===e.data.type&&(i=!0),"teardown"===e.data.type&&(s=!0),t&&a&&(n=1),a&&i&&s&&(n=2)})),n},changeTreeSearchValue:function(e){var t=this;this.treeSearchValue=e,"2"===this.treeSearchValue?(this.searchValue="",this.caseTreeNodesUriSearch=[],this.uriSearch=!0,Object(m["p"])(this.$route.query.productId).then((function(e){if(e.status)t.$message.error(e.message);else{var a=e.data;if(!a.length)return void t.$message.error("接口数据返回为空");for(var i=0;i<a.length;i++)if(a[i].data.groupId===+t.$route.params.id){t.uriSearchTreeNode=a[i];break}t.caseTreeNodesUriSearch=[t.handleAllData(t.uriSearchTreeNode)]}})).catch()):"1"===this.treeSearchValue&&(this.searchValue="",this.handleTreeSearch=!1,this.uriSearch=!1,this.uriSearchCheckedKeys=[],this.queryTreeNode())},handleAllData:function(e){var t=this;return Object(f["a"])(e,(function(e){e.title=e.data.text,e.key=e.data.id,e.type=e.data.type,e.slots={icon:"other"},e.isLeaf=t.isLeafNode(e)})),e},getTreeDataSearch:function(){var e=this;this.curCaseTreeNodesSearch=[],this.SearchExpandedKeys=[],0===this.searchInputLastTime||clearTimeout(this.searchInputLastTime),this.searchInputLastTime=setTimeout((function(){e.search()}),2e3)},search:function(){var e=this;if("1"===this.treeSearchValue){var t=this.searchValue.toLowerCase(),a=w.a.cloneDeep(this.caseTreeNodesSearch);this.curCaseTreeNodesSearch=this.walkThroughNodesChildFirst(a,a[0],t)}else if("2"===this.treeSearchValue){for(var i="",s=0;s<this.uriSearchCheckedKeys.length;s++)s!==this.uriSearchCheckedKeys.length-1?i=i+this.uriSearchCheckedKeys[s]+",":i+=this.uriSearchCheckedKeys[s];var n=this.searchValue.split(",");v({suiteIds:i,uriList:n,groupId:this.$route.params.id}).then((function(t){if(t.status)e.$message.error(t.message);else{e.uriSearch=!1;var a=w.a.cloneDeep(e.caseTreeNodesSearch);e.curCaseTreeNodesSearch=e.uriSearchWalkThroughNodesChildFirst(a,a[0],t.data.caseList)}})).catch()}},onSelect:function(e,t){if(this.selectedFalse=t.selected,null===this.versionControl){if(t.selected&&(this.selectTreeNode=t.node),this.selectedKeys=e,this.onlyKey=e[0],this.onlyKey){var a="";this.getSelectNodeDetail(this.versionId),"-1"!==this.versionId?(this.$router.push({path:"/testgroup/".concat(this.$route.params.id,"/").concat(this.onlyKey),query:{productId:this.$route.query.productId,versionId:this.versionId}}),a="/testgroup/"+this.$route.params.id+"/"+this.onlyKey+"?productId="+this.$route.query.productId+"&versionId="+this.versionId):(this.$router.push({path:"/testgroup/".concat(this.$route.params.id,"/").concat(this.onlyKey),query:{productId:this.$route.query.productId}}),a="/testgroup/"+this.$route.params.id+"/"+this.onlyKey+"?productId="+this.$route.query.productId),this.isCase(t.node.dataRef)||(this.onLoadData(t.node),-1===this.expandedKeys.indexOf(e[0])&&this.expandedKeys.push(e[0]),t.expanded=!0,this.onExpand(this.expandedKeys,t)),this.$store.dispatch("setTestGroupPath",a)}}else t.selected&&(this.selectTreeNode=t.node),this.selectedKeys=e,this.onlyKey=e[0],this.onlyKey&&this.getSelectNodeDetail(this.versionControl.id)},updateTreeNodeName:function(e){var t=this.selectTreeNode.dataRef;t.title=e.title},onExpand:function(e,t){this.expandedKeys=e,this.autoExpandParent=!1,t.expanded?this.$set(t.node.dataRef.slots,"icon","expend"):this.$set(t.node.dataRef.slots,"icon","other")},formatCaseTree:function(e){var t=this;return Object(f["a"])(e,(function(e,a){e.key=e.data.id,e.title=e.data.text,e.scopedSlots={title:"title"},e.type=t.getTreeNodeType(e),e.slots={icon:t.getTreeNodeType(e)},e.isConflict=t.isConflict(e),e.isLeaf=t.isLeafNode(e)})),e},getTreeNodeType:function(e){return["case","setup","teardown"].indexOf(e.data.type)>-1?e.data.type:this.expandedKeys.indexOf(e.data.id)>-1?"expend":"other"},getNodeTypeString:function(e){if("number"===typeof e)return["root","suite","case","step","api","sql","setup","teardown","redis","shell","mongo","es"][e]},getFirstSuite:function(e){var t=this;this.caseTreeNodes=[];var a={};a.data=e.data,a.title=e.data.text,a.key=e.data.id,a.isConflict=this.isConflict(e),a.type=e.data.type,a.slots={icon:"expend"},a.scopedSlots={title:"title"},a.isLeaf=this.isLeafNode(e),a.children=[],e.children.forEach((function(e){a.children.push({key:e.data.id,title:e.data.text,type:e.data.type,data:e.data,isConflict:t.isConflict(e),isLeaf:t.isLeafNode(e),scopedSlots:{title:"title"},slots:{icon:t.getTreeNodeType(e)}})})),this.caseTreeNodes.push(a)}}},Te=we,Ce=(a("715e"),Object($["a"])(Te,u,p,!1,null,"925e2950",null)),_e=Ce.exports,Ne=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[e.currentSelectNode?a("div",[a("a-collapse",{scopedSlots:e._u([{key:"expandIcon",fn:function(e){return[a("a-icon",{attrs:{type:"caret-right",rotate:e.isActive?90:0}})]}}],null,!1,766930589)},[a("a-collapse-panel",{key:"1"},[a("div",{attrs:{slot:"header"},slot:"header"},[e.currentSelectNode.data.text.length>=20?a("a-tooltip",[a("template",{slot:"title"},[e._v(" "+e._s(e.currentSelectNode.data.text)+" ")]),a("span",{staticStyle:{margin:"10px","font-size":"16px","font-weight":"700"}},[e._v(" "+e._s(e.getTitle(e.currentSelectNode.data.text))+" ")])],2):a("span",{staticStyle:{margin:"10px","font-size":"16px","font-weight":"700"}},[e._v(" "+e._s(e.getTitle(e.currentSelectNode.data.text))+" ")]),a("a-tag",{directives:[{name:"show",rawName:"v-show",value:e.isCase(e.currentSelectNode),expression:"isCase(currentSelectNode)"}],staticStyle:{"vertical-align":"baseline"},attrs:{color:e.getLiftColor(e.currentSelectNode.data.life)},nativeOn:{click:function(e){e.stopPropagation()}}},[e._v(" "+e._s(e.getDisplayLife(e.currentSelectNode.data.life))+" ")]),a("a-tag",{directives:[{name:"show",rawName:"v-show",value:!e.isCase(e.currentSelectNode),expression:"!isCase(currentSelectNode)"}],staticStyle:{"vertical-align":"baseline"},attrs:{color:"cyan"},nativeOn:{click:function(e){e.stopPropagation()}}},[e._v(" "+e._s(e.currentSelectNode.data.caseNum)+" ")]),a("a-tag",{directives:[{name:"show",rawName:"v-show",value:!e.isSetupOrTeardown(e.currentSelectNode)&&!e.isSuite(e.currentSelectNode)&&e.currentSelectNode.data.level,expression:"!isSetupOrTeardown(currentSelectNode) &&\n                            !isSuite(currentSelectNode) &&\n                            currentSelectNode.data.level"}],staticStyle:{"vertical-align":"baseline"},attrs:{color:"blue"},nativeOn:{click:function(e){e.stopPropagation()}}},[e._v(" "+e._s(e.getNodeLevel(e.currentSelectNode.data.level))+" ")]),a("a-tag",{directives:[{name:"show",rawName:"v-show",value:!e.isSetupOrTeardown(e.currentSelectNode)&&!e.isSuite(e.currentSelectNode),expression:"!isSetupOrTeardown(currentSelectNode) && !isSuite(currentSelectNode)"}],staticStyle:{"vertical-align":"baseline"},attrs:{color:"purple"},nativeOn:{click:function(e){e.stopPropagation()}}},[e._v(" "+e._s(e.getReadType(e.currentSelectNode.data.readOnly))+" ")]),a("a-tag",{directives:[{name:"show",rawName:"v-show",value:e.isOnlyCase(e.currentSelectNode)&&(""===e.versionId||"-1"===e.versionId),expression:"isOnlyCase(currentSelectNode) && (versionId === '' || versionId === '-1')"}],attrs:{color:"#87d068"},nativeOn:{click:function(e){e.stopPropagation()}}},[e._v(" "+e._s(e.currentVerisonName)+" ")]),a("a-tag",{directives:[{name:"show",rawName:"v-show",value:e.isOnlyCase(e.currentSelectNode),expression:"isOnlyCase(currentSelectNode)"}],attrs:{color:"#2db7f5"},nativeOn:{click:function(e){e.stopPropagation()}}},[e._v(" "+e._s(1===e.currentSelectNode.data.concurrencyTag?"并发":"不并发")+" ")]),e.ifExtraVersion&&e.isOnlyCase(e.currentSelectNode)&&(""===e.versionId||"-1"===e.versionId)?a("a-dropdown",{staticStyle:{float:"right"},attrs:{trigger:["click"]},nativeOn:{click:function(e){e.stopPropagation()}}},[a("span",[a("a-divider",{attrs:{type:"vertical"}}),a("h3",{staticStyle:{display:"inline-block"}},[e._v(e._s(e.currentVerisonName))]),a("a-divider",{attrs:{type:"vertical"}}),a("a",{on:{click:function(t){return e.clickVersionNav()}}},[e._v(" 版本选择 "),a("a-icon",{attrs:{type:"down"}})],1)],1),a("a-menu",{attrs:{slot:"overlay"},slot:"overlay"},[a("a-menu-item",{key:"-1"},[a("a",{staticStyle:{display:"inline-block"},on:{click:function(t){return e.clickMasterCase()}}},[e._v(" MASTER ")]),a("a-divider",{attrs:{type:"vertical"}}),a("span",{staticStyle:{color:"#c0c0c0"}},[e._v("Tag: "+e._s(e.masterTag))])],1),a("a-menu-divider"),e._l(e.ExistVersion,(function(t,i){return[a("a-menu-item",{key:t.id},[a("a",{staticStyle:{display:"inline-block"},on:{click:function(a){return e.clickVerisonCase(t)}}},[e._v(" "+e._s(t.name)+" ")]),a("span",{staticClass:"options"},[a("a-divider",{attrs:{type:"vertical"}}),a("a",{on:{click:function(a){return e.verisonPull(t)}}},[e._v(" 拉取 ")]),a("a-divider",{attrs:{type:"vertical"}}),a("a",{on:{click:function(a){return e.versionPush(t)}}},[e._v(" 合入 ")]),a("a-divider",{attrs:{type:"vertical"}}),a("a",{on:{click:function(a){return e.versionDelete(t)}}},[e._v(" 删除 ")])],1),t.tag?a("div",{staticStyle:{color:"#c0c0c0"}},[e._v(" Tag: "+e._s(t.tag)+" ")]):e._e()]),a("a-menu-divider",{key:i})]}))],2)],1):e._e(),e.isCase(e.currentSelectNode)?a("a-switch",{staticStyle:{float:"right",marginTop:"4px"},attrs:{"checked-children":"启用","un-checked-children":"暂停",size:"small"},on:{change:function(t){return e.changCasesStatus(e.currentSelectNode)}},nativeOn:{click:function(e){e.stopPropagation()}},model:{value:0===e.currentSelectNode.data.status,callback:function(t){e.$set(e.currentSelectNode.data,"status === 0 ? true : false",t)},expression:"currentSelectNode.data.status === 0 ? true : false"}}):e._e(),e.isCase(e.currentSelectNode)?a("a-tag",{staticStyle:{float:"right",marginRight:"5px"},attrs:{color:"#1890ff"},on:{click:function(t){return t.stopPropagation(),e.$refs.dynamicData.openDynamicData()}}},[e._v(" 数据驱动 ")]):e._e()],1),a("a-descriptions",{staticStyle:{margin:"0 10px","font-size":"10px"},attrs:{title:"",size:"small"}},[e.isSetupOrTeardown(e.currentSelectNode)?e._e():a("a-descriptions-item",{attrs:{label:(e.isCase(e.currentSelectNode)?"用例":"目录")+"名称"}},[e.showEditName?a("a",{on:{click:e.changeShowEditName}},[e.currentSelectNode.data.text.length>=20?a("a-tooltip",[a("template",{slot:"title"},[e._v(" "+e._s(e.currentSelectNode.data.text)+" ")]),e._v(" "+e._s(e.getTitle(e.currentSelectNode.data.text))+" ")],2):a("span",[e._v(" "+e._s(e.currentSelectNode.data.text)+" ")])],1):a("a-input",{ref:"titleInput",staticStyle:{width:"250px"},attrs:{size:"small"},on:{blur:function(t){return e.saveTitle(e.currentSelectNode)}},model:{value:e.currentSelectNode.data.text,callback:function(t){e.$set(e.currentSelectNode.data,"text",t)},expression:"currentSelectNode.data.text"}})],1),e._e(),e.isCase(e.currentSelectNode)?e._e():a("a-descriptions-item",{attrs:{label:"case数"}},[e._v(" "+e._s(e.currentSelectNode.data.caseNum?e.currentSelectNode.data.caseNum:"--")+" ")]),a("a-descriptions-item",{attrs:{label:"创建人"}},[e._v(" "+e._s(e.currentSelectNode.data.owner?e.currentSelectNode.data.owner:"--")+" ")]),a("a-descriptions-item",{attrs:{label:"最近更新人"}},[e._v(" "+e._s(e.currentSelectNode.data.lastUpdatePerson?e.currentSelectNode.data.lastUpdatePerson:"--")+" ")]),a("a-descriptions-item",{attrs:{label:"最近更新时间"}},[e._v(" "+e._s(e.getTime(e.currentSelectNode.data.lastUpdateTime))+" ")]),e.isSuite(e.currentSelectNode)?e._e():a("a-descriptions-item",{attrs:{label:"等级"}},[a("a-dropdown",{class:{"is-hidden":e.isSetupOrTeardown(e.currentSelectNode)},attrs:{trigger:["click"],disabled:e.isSetupOrTeardown(e.currentSelectNode)}},[a("a",{staticClass:"ant-dropdown-link",on:{click:function(e){return e.preventDefault()}}},[e._v(" "+e._s(e.getNodeLevel(e.currentSelectNode.data.level))+" "),a("a-icon",{attrs:{type:"down"}})],1),a("a-menu",{attrs:{slot:"overlay"},on:{click:e.changeCaseLevel},slot:"overlay"},[e._l(e.caseLevels,(function(t){return[a("a-menu-item",{key:t.id},[e._v(" "+e._s(t.name)+" ")])]}))],2)],1)],1),e.isSuite(e.currentSelectNode)?e._e():a("a-descriptions-item",{attrs:{label:"类型"}},[a("a-dropdown",{class:{"is-hidden":e.isSetupOrTeardown(e.currentSelectNode)},attrs:{trigger:["click"],disabled:e.isSetupOrTeardown(e.currentSelectNode)}},[a("a",{staticClass:"ant-dropdown-link",on:{click:function(e){return e.preventDefault()}}},[e._v(" "+e._s(e.getReadType(e.currentSelectNode.data.readOnly))+" "),a("a-icon",{attrs:{type:"down"}})],1),a("a-menu",{attrs:{slot:"overlay"},on:{click:e.changeAuth},slot:"overlay"},[e._l(e.auths,(function(t){return[a("a-menu-item",{key:t.id},[e._v(" "+e._s(t.name)+" ")])]}))],2)],1)],1),e.isCase(e.currentSelectNode)?a("a-descriptions-item",{attrs:{label:"并发"}},[a("a-dropdown",{class:{"is-hidden":!e.isCase(e.currentSelectNode)},attrs:{trigger:["click"]}},[a("a",{staticClass:"ant-dropdown-link",on:{click:function(e){return e.preventDefault()}}},[e._v(" "+e._s(1===e.currentSelectNode.data.concurrencyTag?"是":"否")+" "),a("a-icon",{attrs:{type:"down"}})],1),a("a-menu",{attrs:{slot:"overlay"},on:{click:e.oncurrencyTagChange},slot:"overlay"},[[a("a-menu-item",{key:"0"},[e._v("否")]),a("a-menu-item",{key:"1"},[e._v("是")])]],2)],1)],1):e._e(),e.isRoot(e.currentSelectNode)?e._e():a("a-descriptions-item",{attrs:{label:"测试用途"}},[e.isShowEditDescr?a("a",{on:{click:e.changeShowEditDescr}},[e.currentSelectNode.data.note.length>=40?a("a-tooltip",[a("template",{slot:"title"},[e._v(" "+e._s(e.currentSelectNode.data.note)+" ")]),e._v(" "+e._s(e.currentSelectNode.data.note.substring(0,40)+"...")+" ")],2):a("span",[e._v(" "+e._s(e.currentSelectNode.data.note||"--")+" ")])],1):a("a-textarea",{ref:"noteInput",staticStyle:{width:"300px"},attrs:{"auto-size":{minRows:1,maxRows:5},placeholder:"请输入测试用途"},on:{blur:e.saveDescr},model:{value:e.currentSelectNode.data.note,callback:function(t){e.$set(e.currentSelectNode.data,"note",t)},expression:"currentSelectNode.data.note"}})],1),e.isSuite(e.currentSelectNode)?a("a-descriptions-item",{attrs:{label:"特殊Tag"}},[e.isShowEditSpeciTag?a("a",{on:{click:e.changeShowEditSpecialTag}},[e.currentSelectNode.data.specialNote.length>=40?a("a-tooltip",[a("template",{slot:"title"},[e._v(" "+e._s(e.currentSelectNode.data.specialNote)+" ")]),e._v(" "+e._s(e.currentSelectNode.data.specialNote.substring(0,40)+"...")+" ")],2):a("span",[e._v(" "+e._s(e.currentSelectNode.data.specialNote||"--")+" ")])],1):a("a-textarea",{ref:"specialNoteInput",staticStyle:{width:"300px"},attrs:{"auto-size":{minRows:1,maxRows:5},placeholder:"请输入特殊tag"},on:{blur:e.saveDescr},model:{value:e.currentSelectNode.data.specialNote,callback:function(t){e.$set(e.currentSelectNode.data,"specialNote",t)},expression:"currentSelectNode.data.specialNote"}})],1):e._e()],1)],1)],1),a("div",{staticStyle:{width:"100%",background:"#eee",height:"1px",margin:"3px 0px"}}),e.isCase(e.currentSelectNode)?a("note-editor",{staticClass:"current-select-detail"}):e._e()],1):e._e(),a("create-suite",{ref:"createSuite",on:{createSuiteSuc:function(t){return e.createSuiteSuc(t)}}}),a("create-case",{ref:"createCase",on:{createCaseSuc:function(t){return e.createCaseSuc(t)}}}),a("copy-or-move",{ref:"copyOrMove",on:{chooseSuiteSuc:function(t){return e.chooseSuiteSuc(t)}}}),a("dynamic-data",{ref:"dynamicData"}),a("detection-dlg",{ref:"detectionDlg"}),a("branch-version",{ref:"branchVersion",on:{handleSuc:function(t){return e.handleVersionSuc()}}})],1)},Oe=[],Ie=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("split-pane",{staticStyle:{height:"calc(100vh - 100px)",margin:"0 5px"},attrs:{"min-percent":5,"default-percent":e.defaultPercent,split:"horizontal"},on:{resize:e.resize}},[a("div",{staticStyle:{height:"100%",overflow:"hidden"},attrs:{slot:"paneL",id:"paneL-node-editor"},slot:"paneL"},[a("div",{attrs:{id:"request-content"}},[e.ops.length?a("span",{staticStyle:{fontSize:"14px",fontWeight:"900",color:"rgba(0, 0, 0, 0.45)"}},[e.ops.length?a("a-icon",{staticClass:"trigger",attrs:{title:e.opBoxCollapsed?"展开OP面板":"折叠OP面板",id:"op-dashboard",type:e.opBoxCollapsed?"menu-unfold":"menu-fold"},on:{click:function(){return e.opBoxCollapsed=!e.opBoxCollapsed}}}):e._e(),a("a-divider",{attrs:{type:"vertical"}}),a("div",{staticStyle:{display:"inline-block"},attrs:{id:"add-and-copy-btn"}},[a("a-dropdown",[a("a-menu",{attrs:{slot:"overlay"},on:{click:e.addOp},slot:"overlay"},[a("a-menu-item",{key:"4"},[e._v("API")]),a("a-menu-item",{key:"5"},[e._v("SQL")]),a("a-menu-item",{key:"8"},[e._v("Redis")]),a("a-menu-item",{key:"10"},[e._v("Mongo")]),a("a-menu-item",{key:"9"},[e._v("Shell")]),a("a-menu-item",{key:"11"},[e._v("ES")])],1),a("a",{on:{click:function(e){return e.stopPropagation(),function(e){return e.preventDefault()}(e)}}},[e._v(" 新增 "),a("a-icon",{attrs:{type:"down"}})],1)],1),a("a-divider",{attrs:{type:"vertical"}}),a("a-dropdown",[a("a-menu",{attrs:{slot:"overlay"},on:{click:e.copyOp},slot:"overlay"},[a("a-menu-item",{key:"0"},[e._v("引用模板")]),a("a-menu-item",{key:"2"},[e._v("YAPI导入")])],1),a("a",{on:{click:function(e){return e.stopPropagation(),function(e){return e.preventDefault()}(e)}}},[e._v(" 复制 "),a("a-icon",{attrs:{type:"down"}})],1)],1)],1),a("a-divider",{attrs:{type:"vertical"}}),(e.ops.length,e._e())],1):e._e(),a("div",{directives:[{name:"show",rawName:"v-show",value:e.ops.length,expression:"ops.length"}]},[e.saveTime?a("a-alert",{staticClass:"auto-save",attrs:{message:e.getAutoSaveMessage,type:"success","show-icon":""}}):e._e(),a("a-button",{directives:[{name:"show",rawName:"v-show",value:e.ops.length,expression:"ops.length"}],attrs:{size:"small",type:"primary"},on:{click:function(t){return e.runCase("auth")}}},[e._v(" 越权测试 ")]),a("a-divider",{attrs:{type:"vertical"}}),a("a-button",{attrs:{size:"small",type:"primary",id:"noteEditor-test-btn"},on:{click:function(t){return e.runCase("normal")}}},[e._v(" 测试 ")]),a("a-divider",{attrs:{type:"vertical"}}),e._e(),e.steps.length>1?a("a-divider",{attrs:{type:"vertical"}}):e._e(),e.steps.length>1?a("a-icon",{staticClass:"trigger",attrs:{title:e.stepBoxCollapsed?"展开STEP面板":"折叠STEP面板",type:e.stepBoxCollapsed?"menu-unfold":"menu-fold"},on:{click:function(){return e.stepBoxCollapsed=!e.stepBoxCollapsed}}}):e._e()],1)]),e.ops.length?e._e():a("div",{staticStyle:{width:"100%",margin:"5% auto"}},[a("a-empty",[a("span",{attrs:{slot:"description"},slot:"description"},[e._v("无操作，请点击新增!")]),a("a-dropdown",[a("a-menu",{attrs:{slot:"overlay"},on:{click:e.addOp},slot:"overlay"},[a("a-menu-item",{key:"4"},[e._v("API")]),a("a-menu-item",{key:"5"},[e._v("SQL")]),a("a-menu-item",{key:"8"},[e._v("Redis")]),a("a-menu-item",{key:"10"},[e._v("Mongo")]),a("a-menu-item",{key:"9"},[e._v("Shell")]),a("a-menu-item",{key:"11"},[e._v("ES")])],1),a("a-button",{attrs:{type:"primary",size:"small"}},[e._v(" 新增 "),a("a-icon",{attrs:{type:"down"}})],1)],1),a("a-divider",{attrs:{type:"vertical"}}),a("a-dropdown",[a("a-menu",{attrs:{slot:"overlay"},on:{click:e.copyOp},slot:"overlay"},[a("a-menu-item",{key:"0"},[e._v("引用模板")]),a("a-menu-item",{key:"2"},[e._v("YAPI导入")])],1),a("a",{on:{click:function(e){return e.stopPropagation(),function(e){return e.preventDefault()}(e)}}},[a("a-button",{attrs:{type:"primary",size:"small"}},[e._v(" 复制 "),a("a-icon",{attrs:{type:"down"}})],1)],1)],1)],1)],1),a("a-layout",{staticStyle:{marginTop:"5px"}},[a("a-layout-sider",{staticClass:"setp-box",attrs:{"collapsed-width":0},model:{value:e.stepBoxCollapsed,callback:function(t){e.stepBoxCollapsed=t},expression:"stepBoxCollapsed"}},[e._e(),e.steps&&e.currentStep&&e.steps.length?a("ul",{staticClass:"step-list"},e._l(e.steps,(function(t){return a("li",{class:{active:t.id===e.currentStep.id}},[a("span",{directives:[{name:"show",rawName:"v-show",value:!t.editable,expression:"!step.editable"}],staticClass:"step-name",attrs:{title:"双击修改名称"},on:{dblclick:function(a){return e.setStepEditable(t,a)},click:function(a){return e.selectStep(t)}}},[e._v(" "+e._s(t.text)+" ")]),a("input",{directives:[{name:"show",rawName:"v-show",value:t.editable,expression:"step.editable"},{name:"model",rawName:"v-model",value:t.text,expression:"step.text"}],staticStyle:{maxWidth:"150px"},domProps:{value:t.text},on:{blur:function(a){return e.saveStepName(t)},keyup:function(a){return e.saveStepName(t,a)},input:function(a){a.target.composing||e.$set(t,"text",a.target.value)}}}),a("a-icon",{directives:[{name:"show",rawName:"v-show",value:e.steps.length>1&&!t.editable,expression:"steps.length > 1 && !step.editable"}],staticClass:"remove-step-icon",attrs:{type:"close-circle"},on:{click:function(a){return e.removeStep(t)}}}),a("a-icon",{directives:[{name:"show",rawName:"v-show",value:e.steps.length>1&&!t.editable,expression:"steps.length > 1 && !step.editable"}],staticClass:"down-step-icon",attrs:{type:"arrow-down"},on:{click:function(a){return e.moveDown("step",t)}}}),a("a-icon",{directives:[{name:"show",rawName:"v-show",value:e.steps.length>1&&!t.editable,expression:"steps.length > 1 && !step.editable"}],staticClass:"up-step-icon",attrs:{type:"arrow-up"},on:{click:function(a){return e.moveUp("step",t)}}})],1)})),0):e._e()]),a("a-layout",[a("a-layout-content",{staticClass:"case-details"},[a("a-layout-sider",{staticClass:"op-box",staticStyle:{background:"#fff","overflow-y":"auto"},style:{height:e.scrollerHeight},attrs:{"collapsed-width":0,width:"205"},model:{value:e.opBoxCollapsed,callback:function(t){e.opBoxCollapsed=t},expression:"opBoxCollapsed"}},[e.ops&&e.ops.length?a("a-tabs",{staticClass:"tab-details",attrs:{"tab-position":"left"},on:{change:e.changeActivekey},model:{value:e.activeKey,callback:function(t){e.activeKey=t},expression:"activeKey"}},e._l(e.ops,(function(t){return a("a-tab-pane",{key:t.id,staticClass:"tab-items"},[a("div",{attrs:{slot:"tab"},slot:"tab"},[a("a-dropdown",{attrs:{trigger:["contextmenu"]}},[a("a-menu",{attrs:{slot:"overlay"},slot:"overlay"},[a("a-menu-item",{key:"1"},[a("a",{on:{click:function(a){return e.moveUp("op",t)}}},[e._v(" 上移 ")])]),a("a-menu-item",{key:"2"},[a("a",{on:{click:function(a){return e.moveDown("op",t)}}},[e._v(" 下移 ")])]),a("a-menu-item",{key:"3",staticClass:"copy-quick-key"},[a("a",{staticStyle:{display:"inline-block"},on:{click:function(t){return e.quickCopyOp(!0)}}},[e._v(" 快捷复制 ")]),a("span",{staticClass:"quick-key"},[e._v(" shiftC")])]),a("a-menu-item",{key:"8",staticClass:"copy-quick-key"},[a("a",{staticStyle:{display:"inline-block"},on:{click:function(a){return e.dupCopyOp(t)}}},[e._v(" dup复制 ")])]),a("a-menu-item",{key:"4",staticClass:"copy-quick-key",attrs:{disabled:""}},[a("a",{staticStyle:{display:"inline-block",color:"rgba(0, 0, 0, .25)"}},[e._v(" 快捷粘贴 ")]),a("span",{staticStyle:{color:"rgba(0, 0, 0, .25)"}},[e._v(" shiftV")])]),a("a-menu-item",{key:"5",staticClass:"copy-quick-key"},[a("a",{staticStyle:{display:"inline-block"},on:{click:function(t){return e.quickCopyOp(!1)}}},[e._v(" 快捷剪切 ")]),a("span",{staticClass:"quick-key"},[e._v(" shiftX")])]),a("a-menu-item",{key:"6"},[a("a",{on:{click:function(a){return e.removeOp(t)}}},[e._v(" 删除 ")])]),(t.extId&&t.extId,e._e())],1),a("div",{staticStyle:{display:"flex"}},[a("a-tag",{staticClass:"optag",staticStyle:{float:"left"},attrs:{color:e.getOpColor(t.type)}},[e._v(" "+e._s(t.type)+" ")]),a("span",{directives:[{name:"show",rawName:"v-show",value:!t.isEdit,expression:"!op.isEdit"}],staticClass:"step-name",staticStyle:{display:"inline-block","max-width":"100px"},on:{dblclick:function(a){return a.stopPropagation(),e.editOpName(t)}}},[e.getLength(t.text)>10?a("a-tooltip",[a("template",{slot:"title"},[e._v(" "+e._s(t.text)+" ")]),e._v(" "+e._s(t.text)+" ")],2):a("span",[e._v(e._s(t.text))])],1),t.isEdit?a("a-input",{ref:"opName"+t.id,refInFor:!0,staticStyle:{maxWidth:"100px"},attrs:{size:"small"},on:{click:function(e){return e.stopPropagation(),function(e){return e.preventDefault()}(e)},blur:function(a){return e.saveOpName(t)}},model:{value:t.text,callback:function(a){e.$set(t,"text",a)},expression:"op.text"}}):e._e(),a("span",[a("a-dropdown",[a("a-menu",{attrs:{slot:"overlay"},slot:"overlay"},[a("a-menu-item",{key:"1"},[a("a",{on:{click:function(a){return e.moveUp("op",t)}}},[e._v(" 上移 ")])]),a("a-menu-item",{key:"2"},[a("a",{on:{click:function(a){return e.moveDown("op",t)}}},[e._v(" 下移 ")])]),a("a-menu-item",{key:"3",staticClass:"copy-quick-key"},[a("a",{staticStyle:{display:"inline-block"},on:{click:function(t){return e.quickCopyOp(!0)}}},[e._v(" 快捷复制 ")]),a("span",{staticClass:"quick-key"},[e._v(" shiftC")])]),a("a-menu-item",{key:"8",staticClass:"copy-quick-key"},[a("a",{staticStyle:{display:"inline-block"},on:{click:function(a){return e.dupCopyOp(t)}}},[e._v(" dup复制 ")])]),a("a-menu-item",{key:"4",staticClass:"copy-quick-key",attrs:{disabled:""}},[a("a",{staticClass:"paste-class"},[e._v(" 快捷粘贴 ")]),a("span",{staticStyle:{color:"rgba(0, 0, 0, .25)"}},[e._v(" shiftV ")])]),a("a-menu-item",{key:"5",staticClass:"copy-quick-key"},[a("a",{staticStyle:{display:"inline-block"},on:{click:function(t){return e.quickCopyOp(!1)}}},[e._v(" 快捷剪切 ")]),a("span",{staticClass:"quick-key"},[e._v(" shiftX")])]),a("a-menu-item",{key:"6"},[a("a",{on:{click:function(a){return e.removeOp(t)}}},[e._v(" 删除 ")])]),(t.extId&&t.extId,e._e())],1),a("a-icon",{attrs:{type:"more"}})],1)],1),t.extId&&-1!==t.extId?a("a-icon",{attrs:{type:"api"},on:{click:function(a){return a.stopPropagation(),e.unlockOperation(t)}}}):e._e()],1)],1)],1)])})),1):e._e()],1),e.ops.length?a("div",{staticStyle:{"background-color":"#ececec",padding:"10px",flex:"1",width:"auto","overflow-y":"auto"},style:{height:e.scrollerHeight}},[!e.selectedOp||"api"!==e.selectedOp.type&&"es"!==e.selectedOp.type?e._e():a("api-editor",{ref:"apiEditorRef",attrs:{"hint-key-words":e.hintKeyWords,"autocomplete-tables":e.AUTOCOMPLETE_TABLES}}),e.selectedOp&&"sql"===e.selectedOp.type?a("sql-editor",{ref:"sqlEditorRef",attrs:{"hint-key-words":e.hintKeyWords,"autocomplete-tables":e.AUTOCOMPLETE_TABLES}}):e._e(),e.selectedOp&&"redis"===e.selectedOp.type?a("redis-editor",{ref:"redisEditorRef",attrs:{"hint-key-words":e.hintKeyWords}}):e._e(),e.selectedOp&&"shell"===e.selectedOp.type?a("shell-editor",{ref:"shellEditorRef",attrs:{"hint-key-words":e.hintKeyWords,"autocomplete-tables":e.AUTOCOMPLETE_TABLES}}):e._e(),e.selectedOp&&"mongo"===e.selectedOp.type?a("mongo-editor",{ref:"mongoEditorRef",attrs:{"hint-key-words":e.hintKeyWords,"autocomplete-tables":e.AUTOCOMPLETE_TABLES}}):e._e()],1):e._e()],1)],1)],1)],1),a("div",{attrs:{slot:"paneR",id:"paneR-node-editor"},slot:"paneR"},[e.showRunResult?a("div",[a("a-tabs",{attrs:{animated:!1,size:"small"},on:{change:e.changeActiveTab},model:{value:e.activeTab,callback:function(t){e.activeTab=t},expression:"activeTab"}},[a("a-tab-pane",{key:"result"},[a("span",{attrs:{slot:"tab"},slot:"tab"},[a("a-tooltip",[a("template",{slot:"title"},[e._v(" "+e._s("processing"===e.runCaseResultStatus?"运行中":"error"===e.runCaseResultStatus?"运行失败":"运行成功")+" ")]),a("a-badge",{attrs:{status:e.runCaseResultStatus}})],2),a("span",[e._v("结果")])],1),a("div",{staticClass:"case-result"},[e.loadingCaseDetailFinish?a("a-spin",{staticStyle:{marginLeft:"5px"}}):a("div",[a("a-alert",{directives:[{name:"show",rawName:"v-show",value:-1===e.runCaseResult.resultStatus,expression:"runCaseResult.resultStatus === -1"}],key:e.runCaseResult.errorMsg,attrs:{type:"error",banner:""}}),e._l(e.runCaseResult,(function(t,i){return a("case-result",{directives:[{name:"show",rawName:"v-show",value:-1!==e.runCaseResult.resultStatus,expression:"runCaseResult.resultStatus !== -1"}],key:i,attrs:{data:t,size:e.getLen(JSON.stringify(t))},on:{autoAssertSaveSuc:e.autoAssertSaveSuc}})}))],2)],1)]),a("a-tab-pane",{key:"log",attrs:{tab:"日志",size:"small"}},[a("div",[e.runCaseResult&&e.runCaseResult[0]&&e.runCaseResult[0].traceId?a("iframe",{attrs:{src:e.trustUrl,width:"100%",height:"500",scrolling:"yes"}}):e._e()])]),a("a-button",{attrs:{slot:"tabBarExtraContent",icon:e.RespEmptyCollapse?"caret-down":"caret-up",type:"link"},on:{click:function(t){return e.showResponse()}},slot:"tabBarExtraContent"})],1)],1):a("div",[a("div",{staticClass:"response-empty"},[a("span",{staticStyle:{fontSize:"14px",fontWeight:"900",color:"rgba(0, 0, 0, 0.45)"}},[e._v("Response")]),a("a-button",{attrs:{icon:e.RespEmptyCollapse?"caret-down":"caret-up",type:"link"},on:{click:function(t){return e.showResponse()}}})],1),a("a-empty")],1)])]),a("copy-step",{ref:"copyStepModal",on:{copyStepSuc:e.copyStepSuc}}),a("detection-dlg",{ref:"detectionDlg",on:{isCheckSuc:function(t){return e.isCheckSuc(t)}}}),a("copy-option",{ref:"copyOption",on:{apiTplcopySuc:function(t){return e.apiTplcopySuc(t)},yapicopySuc:function(t){return e.yapicopySuc(t)}}})],1)},$e=[],De=(a("466d"),a("d81d"),a("caad"),a("2532"),a("2900")),Ee=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("a-modal",{staticStyle:{position:"relative"},attrs:{title:"复制STEP模板",width:900,"body-style":{height:"auto",overflow:"auto"},visible:e.visible,"confirm-loading":e.confirmLoading,"ok-text":"保存","cancel-text":"取消"},on:{ok:e.handleOk,cancel:e.handleCancel}},[a("a-table",{ref:"mainTable",attrs:{"row-key":function(e){return e.id},columns:e.columns,"data-source":e.items,pagination:e.getPagination(),"row-selection":e.rowSelection}})],1)],1)},Le=[],Ve={data:function(){return{visible:!1,confirmLoading:!1,items:[],columns:[{title:"ID",dataIndex:"id",align:"left"},{title:"模板名称",dataIndex:"text",scopedSlots:{customRender:"text"},ellipsis:!0,align:"left"},{title:"创建人",dataIndex:"createPerson",key:"createPerson",align:"left",scopedSlots:{customRender:"createPerson"}},{title:"创建时间",dataIndex:"createTime",key:"createTime",sorter:function(e,t){return e.createTime-t.createTime},align:"left",customRender:function(e,t){if(t.createTime)return Object(ue["i"])(t.createTime);var a="--";return a}}],selectRow:null}},computed:Object(l["a"])(Object(l["a"])({},Object(d["b"])({currentProductLine:function(e){return e.productline.currentProductLine},steps:function(e){return e.treenode.steps},currentSelectNode:function(e){return e.treenode.currentSelectTreeNode}})),{},{rowSelection:function(){var e=this;return{onChange:function(t,a){e.selectRow=a[0]},type:"radio"}}}),methods:{getPagination:function(){return this.items.length>=10&&{pageSize:10}},copyStep:function(){var e=this;this.visible=!0,Object(m["n"])(this.currentProductLine.id).then((function(t){t.status||(e.items=t.data||[])})).catch((function(e){}))},handleOk:function(){var e=this;if(this.selectRow){var t={parentId:this.steps[this.steps.length-1].id,type:3,groupId:this.$route.params.id,text:this.selectRow.text,extId:this.selectRow.id,versionId:this.currentSelectNode.data.versionId};Object(m["a"])(t,"step").then((function(a){if(!a.status){var i=Object.assign(t,{id:a.data,typeTag:"step"});e.visible=!1,e.$emit("copyStepSuc",i)}})).catch((function(e){}))}else this.$message.error("请选择一个step模板")},handleCancel:function(){this.visible=!1}}},Re=Ve,Me=Object($["a"])(Re,Ee,Le,!1,null,"9f85ab82",null),Pe=Me.exports,Ae=function(){var e=this,t=e.$createElement,a=e._self._c||t;return e.data?a("div",[11===e.selectOp.type||"es"===e.selectOp.type?a("a-select",{staticStyle:{width:"100%","margin-bottom":"5px"},attrs:{disabled:!!e.data.extId&&-1!==e.data.extId},model:{value:e.data.loginId,callback:function(t){e.$set(e.data,"loginId",t)},expression:"data.loginId"}},e._l(e.esList,(function(t){return a("a-select-option",{key:t.id},[e._v(" "+e._s(t.name)+" ")])})),1):e._e(),a("div",{staticStyle:{"margin-bottom":"5px",display:"flex"}},[a("a-input-group",{attrs:{compact:""}},[4===e.selectOp.type||"api"===e.selectOp.type?a("a-select",{staticStyle:{width:"15%"},attrs:{disabled:!!e.data.extId&&-1!==e.data.extId},on:{change:e.changeProtocol},model:{value:e.data.protocol,callback:function(t){e.$set(e.data,"protocol",t)},expression:"data.protocol"}},e._l(e.protocolsLists,(function(t){return a("a-select-option",{key:t.id},[e._v(" "+e._s(e.getDisplayProtocolFromStaticData(t.id))+" ")])})),1):e._e(),1===e.data.protocol?a("a-select",{staticStyle:{width:"15%"},attrs:{disabled:!!e.data.extId&&-1!==e.data.extId},on:{change:e.changeMethod},model:{value:e.data.method,callback:function(t){e.$set(e.data,"method",t)},expression:"data.method"}},e._l(e.methodsLists,(function(t){return a("a-select-option",{key:t.id},[e._v(" "+e._s(e.getDisplayMethodFromStaticData(t.id))+" ")])})),1):e._e(),a("a-input",{style:4===e.selectOp.type||"api"===e.selectOp.type?{width:"65%"}:{width:"80%"},attrs:{placeholder:e.getPlaceholderFromStaticData(e.data.protocol,"url"),disabled:!!e.data.extId&&-1!==e.data.extId},model:{value:e.data.url,callback:function(t){e.$set(e.data,"url",t)},expression:"data.url"}}),2===e.data.protocol?a("a",{staticStyle:{margin:"8px 5px"},attrs:{href:"http://agroup.baidu.com/itp/md/article/1516636",target:"_blank",title:"Stargate RPC请求接入填写说明"}},[a("a-icon",{attrs:{type:"question-circle"}})],1):e._e(),1===e.data.protocol&&4===e.selectOp.type&&(null==e.data.extId||e.data.extId<=0)?a("a-icon",{staticStyle:{margin:"8px 5px"},attrs:{type:"share-alt",title:"转模板"},on:{click:e.turnToTemplate}}):e._e()],1)],1),a("div",[a("a-tabs",{attrs:{animated:!1,size:"small"},on:{change:e.activeKeyChange},model:{value:e.activeKey,callback:function(t){e.activeKey=t},expression:"activeKey"}},[5!==e.data.protocol||6!==e.data.protocol?a("a-tab-pane",{key:"params",attrs:{tab:(e.paramsNum,"Params"+e.paramsNum),size:"small"}},[a("div",{staticClass:"editor-content"},[a("a-checkbox",{attrs:{checked:1===e.data.isEncoding,disabled:!!e.data.extId&&-1!==e.data.extId},on:{change:e.isEncodingChange}},[e._v(" encoding ")]),a("hint-text-area",{staticStyle:{"margin-top":"5px"},attrs:{placeholder:e.getPlaceholderFromStaticData(e.data.protocol,"param"),"hint-key-words":e.hintKeyWords,"text-disabled":!!e.data.extId&&-1!==e.data.extId,"auto-size":{minRows:13,maxRows:15}},model:{value:e.data.params,callback:function(t){e.$set(e.data,"params",t)},expression:"data.params"}}),e._e()],1),a("div",{staticStyle:{marginTop:"5px"}},[a("a-icon",{attrs:{type:"alert",theme:"twoTone"}}),e._v(" tips:如何使用 "),a("a",{attrs:{href:"http://wiki.baidu.com/pages/viewpage.action?pageId=1109952603",target:"_blank"}},[e._v(" 前置请求(包括Setup内)的返回值作为参数 ")]),e._v("，或使用 "),a("a",{attrs:{href:"http://wiki.baidu.com/pages/viewpage.action?pageId=1071514253",target:"_blank"}},[e._v("扩展函数")])],1)]):e._e(),1!==e.data.protocol||4!==e.selectOp.type&&"api"!==e.selectOp.type?e._e():a("a-tab-pane",{key:"authorization",attrs:{size:"small"}},[a("span",{attrs:{slot:"tab"},slot:"tab"},[e._v(" "+e._s((e.authorizationNum,"Authorization"+e.authorizationNum))+" "),e.authDefaultValue?a("a-icon",{staticStyle:{color:"red"},attrs:{type:"exclamation-circle"}}):e._e()],1),a("div",{staticClass:"editor-content"},[e.authDefaultValue?a("a-alert",{attrs:{type:"error",message:"历史填写的账号已不存在，请及时更换账号！",banner:""}}):e._e(),a("a-select",{staticStyle:{margin:"5px 0px",width:"100%"},on:{change:e.changeLoginId},model:{value:e.data.loginId,callback:function(t){e.$set(e.data,"loginId",t)},expression:"data.loginId"}},e._l(e.loginInfos,(function(t){return a("a-select-option",{key:t.id},[e._v(" "+e._s(e.getDisplayLogin(t))+" ")])})),1)],1),a("div",{staticStyle:{marginTop:"5px"}},[a("a-icon",{attrs:{type:"alert",theme:"twoTone"}}),e._v(" tips:没有所需的账号？去 "),a("a",{attrs:{href:e.getAuthorizationTips(),target:"_blank"}},[e._v(" 增加一个账号 ")])],1)]),1!==e.data.protocol||4!==e.selectOp.type&&"api"!==e.selectOp.type?e._e():a("a-tab-pane",{key:"header",attrs:{tab:(e.headerNum,"Header"+e.headerNum),size:"small"}},[a("div",{staticClass:"editor-content"},[a("hint-text-area",{staticStyle:{"margin-top":"5px"},attrs:{placeholder:e.getPlaceholderFromStaticData(e.data.protocol,"header"),"hint-key-words":e.hintKeyWords,"text-disabled":!!e.data.extId&&-1!==e.data.extId,"auto-size":{minRows:13,maxRows:15}},model:{value:e.data.header,callback:function(t){e.$set(e.data,"header",t)},expression:"data.header"}})],1),a("div",{staticStyle:{marginTop:"5px"}},[a("a-icon",{attrs:{type:"alert",theme:"twoTone"}}),e._v(" tips:如何使用 "),a("a",{attrs:{href:"http://wiki.baidu.com/pages/viewpage.action?pageId=1109952603",target:"_blank"}},[e._v(" 前置请求(包括Setup内)的返回值作为参数 ")]),e._v("，或使用 "),a("a",{attrs:{href:"http://wiki.baidu.com/pages/viewpage.action?pageId=1071514253",target:"_blank"}},[e._v("扩展函数")])],1)]),1===e.data.protocol||5===e.data.protocol||6===e.data.protocol?a("a-tab-pane",{key:"body",attrs:{tab:(e.bodyNum,"Body"+e.bodyNum),size:"small"}},[a("div",{staticClass:"editor-content"},["api"===e.selectOp.type?a("a-radio-group",{staticStyle:{"margin-bottom":"10px"},attrs:{disabled:!!e.data.extId&&-1!==e.data.extId},on:{change:e.onChangeBodyType},model:{value:e.data.bodyType,callback:function(t){e.$set(e.data,"bodyType",t)},expression:"data.bodyType"}},e._l(e.protocolsLists[e.data.protocol-1].forms,(function(t){return a("a-radio",{key:t.id,attrs:{value:t.id}},[e._v(" "+e._s(t.name.trim())+" ")])})),1):e._e(),"es"===e.selectOp.type?a("a-radio-group",{staticStyle:{"margin-bottom":"10px"},attrs:{disabled:!!e.data.extId&&-1!==e.data.extId},on:{change:e.onChangeBodyType},model:{value:e.data.bodyType,callback:function(t){e.$set(e.data,"bodyType",t)},expression:"data.bodyType"}},e._l(e.protocolsLists[e.data.protocol-1].esForms,(function(t){return a("a-radio",{key:t.id,attrs:{value:t.id}},[e._v(" "+e._s(t.name.trim())+" ")])})),1):e._e(),10===e.data.bodyType||1===e.data.bodyType||9===e.data.bodyType?a("div",[a("div",[a("a-icon",{attrs:{type:"alert"}}),a("a-button",{attrs:{type:"link"},on:{click:function(t){return e.changeFormToText()}}},[e._v("切换至"+e._s(e.isForm?"text":"form")+"输入")]),e.isForm?e._e():a("a-popover",{staticStyle:{marginRight:"10px"},attrs:{placement:"bottom"}},[a("template",{slot:"content"},[a("p",[e._v("每行一条记录，制表符分隔，第一列为key，第二列为value(可以使用全局变量，扩展函数或前置请求返回值),")]),a("p",[e._v("如果value暂不填则可输入空格。可以在excel里写导出为txt，或者直接写在文件里拷贝进来。")])]),a("a-icon",{attrs:{type:"exclamation-circle"}})],2)],1),e.isForm?e._e():a("at-ta",{attrs:{at:"$",members:e.hintKeyWords}},[a("a-textarea",{attrs:{id:"tab-indent","auto-size":{minRows:12,maxRows:15},placeholder:e.getIsNotFormPlaceholder(),value:e.data.body},on:{change:function(t){e.data.body=t.target.value},keydown:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"tab",9,t.key,"Tab")?null:e.forbidTab(t)},keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"tab",9,t.key,"Tab")?null:e.replaceSpacing(t)}}})],1),e.isForm&&10===e.data.bodyType?a("div",e._l(e.data.body,(function(t,i){return a("div",{key:i,staticClass:"key-value-item"},[a("a-input-group",{attrs:{compact:""}},[a("span",{staticClass:"key-value-input",staticStyle:{width:"30%"}},[a("a-input",{staticStyle:{width:"70%"},attrs:{placeholder:"KEY",disabled:!!e.data.extId&&-1!==e.data.extId},on:{click:function(t){return e.clickKeyOrValueType(i,e.data.body)}},model:{value:t.key,callback:function(a){e.$set(t,"key",a)},expression:"item.key"}}),a("a-select",{staticStyle:{width:"30%"},attrs:{"default-value":"text",disabled:!!e.data.extId&&-1!==e.data.extId},on:{change:function(t){return e.handleTypeChange(t,i)}},model:{value:t.type,callback:function(a){e.$set(t,"type",a)},expression:"item.type"}},[a("a-select-option",{attrs:{value:"text"}},[e._v(" Text ")]),a("a-select-option",{attrs:{value:"file"}},[e._v(" File ")])],1)],1),(t.type,e._e()),"text"===t.type?a("hint-text-area",{staticStyle:{width:"60%","border-right-width":"0","font-size":"12px"},attrs:{placeholder:"VALUE","hint-key-words":e.hintKeyWords,"auto-size":{minRows:1.2,maxRows:10}},model:{value:t.value,callback:function(a){e.$set(t,"value",a)},expression:"item.value"}}):a("span",{staticStyle:{width:"60%","border-right-width":"0"}},[t.value?a("a-select",{staticStyle:{width:"100%"},attrs:{mode:"multiple",placeholder:"Please select",open:!1},on:{change:function(t){return e.handleTypeChange(t,i)}},model:{value:t.value.split("${ITPFILE.")[1].split("}")[0],callback:function(a){e.$set(t.value.split("${ITPFILE.")[1].split("}"),0,a)},expression:"item.value.split('${ITPFILE.')[1].split('}')[0]"}}):a("a-upload",{attrs:{name:"uploadFile",action:e.action,method:"post"},on:{change:e.fileUpload}},[a("a-button",{on:{click:function(t){return e.uploadBtn(i)}}},[a("a-icon",{attrs:{type:"upload"}}),e._v(" 请选择文件 ")],1)],1)],1),a("a-button",{attrs:{type:"link",shape:"circle",icon:"close-circle"},on:{click:function(t){return e.removeItemType(i,e.data.body)}}})],1)],1)})),0):e._e(),!e.isForm||1!==e.data.bodyType&&9!==e.data.bodyType?e._e():a("div",e._l(e.data.body,(function(t,i){return a("div",{key:i,staticClass:"key-value-item"},[a("a-input-group",{attrs:{compact:""}},[a("a-input",{staticStyle:{width:"30%"},attrs:{placeholder:"KEY",disabled:!!e.data.extId&&-1!==e.data.extId},on:{click:function(t){return e.clickKeyOrValueType(i,e.data.body)}},model:{value:t.key,callback:function(a){e.$set(t,"key",a)},expression:"item.key"}}),e._e(),a("hint-text-area",{staticStyle:{width:"60%","border-right-width":"0","font-size":"12px"},attrs:{placeholder:"VALUE","hint-key-words":e.hintKeyWords,"auto-size":{minRows:1.2,maxRows:10}},model:{value:t.value,callback:function(a){e.$set(t,"value",a)},expression:"item.value"}}),a("a-button",{attrs:{type:"link",shape:"circle",icon:"close-circle"},on:{click:function(t){return e.removeItemType(i,e.data.body)}}})],1)],1)})),0)],1):e._e(),2!==e.data.bodyType&&6!==e.data.bodyType&&7!==e.data.bodyType&&16!==e.data.bodyType||+e.data.id!==+e.selectOp.id?e._e():a("div",[a("div",{attrs:{id:"JsonCodeViewApi"+e.selectOp.id}})]),3===e.data.bodyType||4===e.data.bodyType||5===e.data.bodyType||8===e.data.bodyType||18===e.data.bodyType||28===e.data.bodyType||100===e.data.bodyType?a("div",[a("hint-text-area",{attrs:{"hint-key-words":e.hintKeyWords,"auto-size":{minRows:10,maxRows:15}},model:{value:e.data.body,callback:function(t){e.$set(e.data,"body",t)},expression:"data.body"}}),4===e.data.bodyType||8===e.data.bodyType||18===e.data.bodyType||28===e.data.bodyType||100===e.data.bodyType?a("a-input-group",{staticStyle:{marginTop:"10px"},attrs:{compact:""}},[a("span",{staticStyle:{"font-size":"10px",margin:"9px",width:"10%"}},[e._v(" proto序列化文件: ")]),a("a-select",{staticStyle:{width:"20%"},on:{change:function(t){return e.changefile(e.filesInfo.proto.serialization.files,e.data.protoSerialization.fileName,"protoSerialization")}},model:{value:e.data.protoSerialization.fileName,callback:function(t){e.$set(e.data.protoSerialization,"fileName",t)},expression:"data.protoSerialization.fileName"}},e._l(e.filesInfo.proto.serialization.files,(function(t){return a("a-select-option",{key:t.fileName},[e._v(" "+e._s(t.fileName)+" ")])})),1),a("a-select",{staticStyle:{width:"20%"},on:{change:function(t){return e.handleProto(e.data.protoSerialization,t,"version")}},model:{value:e.data.protoSerialization.version,callback:function(t){e.$set(e.data.protoSerialization,"version",t)},expression:"data.protoSerialization.version"}},e._l(e.version.protoSerialization,(function(t){return a("a-select-option",{key:t},[e._v(" "+e._s(t)+" ")])})),1),a("a-input",{staticStyle:{width:"20%"},attrs:{placeholder:"message name"},model:{value:e.data.protoSerialization.messageName,callback:function(t){e.$set(e.data.protoSerialization,"messageName",t)},expression:"data.protoSerialization.messageName"}}),a("a-input",{staticStyle:{width:"20%"},attrs:{placeholder:"暂时没用"},model:{value:e.data.protoSerialization.col,callback:function(t){e.$set(e.data.protoSerialization,"col",t)},expression:"data.protoSerialization.col"}})],1):e._e(),4===e.data.bodyType||8===e.data.bodyType||18===e.data.bodyType||28===e.data.bodyType||100===e.data.bodyType?a("a-input-group",{staticStyle:{marginTop:"10px"},attrs:{compact:""}},[a("span",{staticStyle:{"font-size":"10px",margin:"9px",width:"10%"}},[e._v(" proto反序列化文件: ")]),a("a-select",{staticStyle:{width:"20%"},on:{change:function(t){return e.changefile(e.filesInfo.proto.deserialization.files,e.data.protoDeserialization.fileName,"protoDeserialization")}},model:{value:e.data.protoDeserialization.fileName,callback:function(t){e.$set(e.data.protoDeserialization,"fileName",t)},expression:"data.protoDeserialization.fileName"}},e._l(e.filesInfo.proto.deserialization.files,(function(t){return a("a-select-option",{key:t.fileName},[e._v(" "+e._s(t.fileName)+" ")])})),1),a("a-select",{staticStyle:{width:"20%"},on:{change:function(t){return e.handleProto(e.data.protoDeserialization,t,"version")}},model:{value:e.data.protoDeserialization.version,callback:function(t){e.$set(e.data.protoDeserialization,"version",t)},expression:"data.protoDeserialization.version"}},e._l(e.version.protoDeserialization,(function(t){return a("a-select-option",{key:t},[e._v(" "+e._s(t)+" ")])})),1),a("a-input",{staticStyle:{width:"20%"},attrs:{placeholder:"message name"},model:{value:e.data.protoDeserialization.messageName,callback:function(t){e.$set(e.data.protoDeserialization,"messageName",t)},expression:"data.protoDeserialization.messageName"}}),a("a-input",{staticStyle:{width:"20%"},attrs:{placeholder:"${header.字段名}，反序列化的长度"},model:{value:e.data.protoDeserialization.col,callback:function(t){e.$set(e.data.protoDeserialization,"col",t)},expression:"data.protoDeserialization.col"}})],1):e._e(),8===e.data.bodyType?a("a-input-group",{staticStyle:{marginTop:"10px"},attrs:{compact:""}},[a("span",{staticStyle:{"font-size":"10px",margin:"9px",width:"10%"}},[e._v(" python反序列化文件: ")]),a("a-select",{staticStyle:{width:"20%"},on:{change:function(t){return e.changefile(e.filesInfo.python.deserialization.files,e.data.pythonDeserialization.fileName,"pythonDeserialization")}},model:{value:e.data.pythonDeserialization.fileName,callback:function(t){e.$set(e.data.pythonDeserialization,"fileName",t)},expression:"data.pythonDeserialization.fileName"}},e._l(e.filesInfo.python.deserialization.files,(function(t){return a("a-select-option",{key:t},[e._v(" "+e._s(t)+" ")])})),1),a("a-select",{staticStyle:{width:"20%"},on:{change:function(t){return e.handleProto(e.data.pythonDeserialization,t,"version")}},model:{value:e.data.pythonDeserialization.version,callback:function(t){e.$set(e.data.pythonDeserialization,"version",t)},expression:"data.pythonDeserialization.version"}},e._l(e.version.pythonDeserialization,(function(t){return a("a-select-option",{key:t},[e._v(" "+e._s(t)+" ")])})),1)],1):e._e()],1):e._e()],1),4===e.data.bodyType?a("div",{staticStyle:{marginTop:"5px"}},[a("a-icon",{attrs:{type:"alert",theme:"twoTone"}}),e._v(" tips:如何"),a("a",{attrs:{href:"http://agroup.baidu.com/itp/view/office/1579396",target:"_blank"}},[e._v("上传proto文件")]),e._v("? ")],1):e._e(),a("div",{staticStyle:{marginTop:"5px"}},[a("a-icon",{attrs:{type:"alert",theme:"twoTone"}}),e._v(" tips:如何使用 "),a("a",{attrs:{href:"http://wiki.baidu.com/pages/viewpage.action?pageId=1109952603",target:"_blank"}},[e._v(" 前置请求(包括Setup内)的返回值作为参数 ")]),e._v("，或使用 "),a("a",{attrs:{href:"http://wiki.baidu.com/pages/viewpage.action?pageId=1071514253",target:"_blank"}},[e._v("扩展函数")])],1)]):e._e(),a("a-tab-pane",{key:"assert",attrs:{tab:(e.assertNum,"Assert"+e.assertNum),size:"small"}},[a("div",{staticStyle:{"margin-bottom":"10px"}},[a("a-radio-group",{attrs:{"default-value":"normalAssert"},model:{value:e.assertType,callback:function(t){e.assertType=t},expression:"assertType"}},[a("a-radio-button",{attrs:{value:"normalAssert"}},[e._v(" 普通测试断言 ")]),a("a-radio-button",{attrs:{value:"diffAssert"}},[e._v(" diff测试断言 ")])],1)],1),a("div",{directives:[{name:"show",rawName:"v-show",value:"normalAssert"===e.assertType,expression:"assertType === 'normalAssert'"}],staticClass:"editor-content"},[a("div",[a("a-checkbox",{attrs:{checked:0===e.data.turnStrToJson},on:{change:e.turnStrToJsonChange}},[e._v(" 判断时，返回中String字段强制转化为Json对象 ")])],1),a("div",{staticStyle:{"margin-top":"5px"}},[a("a-checkbox",{attrs:{checked:0===e.data.assertExpect},on:{change:e.assertExpectChange}},[0===e.data.assertExpect?a("span",[e._v(" 包含如下文本或Json ")]):a("span",[e._v("Json/Text文本包含校验")])]),0===e.data.assertExpect?a("hint-text-area",{staticStyle:{"margin-top":"5px"},attrs:{placeholder:"支持json, text, 正则匹配, 其中正则匹配规则放在#{}中","hint-key-words":e.hintKeyWords},model:{value:e.data.expectResponse,callback:function(t){e.$set(e.data,"expectResponse",t)},expression:"data.expectResponse"}}):e._e()],1),a("div",{staticStyle:{"margin-top":"5px"}},[a("a-checkbox",{attrs:{checked:0===e.data.assertExpectJsonSchema},on:{change:e.assertExpectJsonSchemaChange}},[0===e.data.assertExpectJsonSchema?a("span",[e._v(" 与如下JsonSchema匹配 ")]):a("span",[e._v("JsonSchema校验")])]),0===e.data.assertExpectJsonSchema?a("hint-text-area",{staticStyle:{"margin-top":"5px"},attrs:{placeholder:"支持json-schema验证","hint-key-words":e.hintKeyWords},model:{value:e.data.expectJsonSchema,callback:function(t){e.$set(e.data,"expectJsonSchema",t)},expression:"data.expectJsonSchema"}}):e._e()],1),a("div",{staticStyle:{"margin-top":"5px"}},[a("a-checkbox",{attrs:{checked:0===e.data.assertExpectMap},on:{change:e.assertExpectMapChange}},[0===e.data.assertExpectMap?a("span",[e._v(" 包含如下键值 ")]):a("span",[e._v("键值对包含校验")])]),e._l(e.data.expectResponseMap,(function(t,i){return 0===e.data.assertExpectMap?a("div",{key:i,staticClass:"key-value-item"},[a("a-input-group",{attrs:{compact:""}},[a("a-input",{staticStyle:{width:"40%"},attrs:{placeholder:"KEY"},on:{click:function(t){return e.clickKeyOrValue(i,e.data.expectResponseMap)}},model:{value:t.key,callback:function(a){e.$set(t,"key",a)},expression:"item.key"}}),e._e(),a("hint-text-area",{staticStyle:{width:"50%","border-right-width":"0","font-size":"12px"},attrs:{placeholder:"VALUE","hint-key-words":e.hintKeyWords,"auto-size":{minRows:1.2,maxRows:10}},model:{value:t.value,callback:function(a){e.$set(t,"value",a)},expression:"item.value"}}),a("a-button",{attrs:{type:"link",shape:"circle",icon:"close-circle"},on:{click:function(t){return e.removeItem(i,e.data.expectResponseMap)}}})],1)],1):e._e()}))],2),a("div",{staticStyle:{"margin-top":"5px"}},[a("a-checkbox",{attrs:{checked:0===e.data.assertUnexpectMap},on:{change:e.assertUnexpectMapChange}},[0===e.data.assertUnexpectMap?a("span",[e._v(" 不包含如下键值 ")]):a("span",[e._v("键值对不包含校验")])]),e._l(e.data.unexpectResponseMap,(function(t,i){return 0===e.data.assertUnexpectMap?a("div",{key:i,staticClass:"key-value-item"},[a("a-input-group",{attrs:{compact:""}},[a("a-input",{staticStyle:{width:"40%"},attrs:{placeholder:"KEY"},on:{click:function(t){return e.clickKeyOrValue(i,e.data.unexpectResponseMap)}},model:{value:t.key,callback:function(a){e.$set(t,"key",a)},expression:"item.key"}}),e._e(),a("hint-text-area",{staticStyle:{width:"50%","border-right-width":"0","font-size":"12px"},attrs:{placeholder:"VALUE","hint-key-words":e.hintKeyWords,"auto-size":{minRows:1.2,maxRows:10}},model:{value:t.value,callback:function(a){e.$set(t,"value",a)},expression:"item.value"}}),a("a-button",{attrs:{type:"link",shape:"circle",icon:"close-circle"},on:{click:function(t){return e.removeItem(i,e.data.unexpectResponseMap)}}})],1)],1):e._e()}))],2),a("div",{staticStyle:{"margin-top":"5px"}},[a("a-checkbox",{attrs:{checked:0===e.data.assertHeader},on:{change:e.assertHeaderChange}},[0===e.data.assertHeader?a("span",[e._v(" 包含如下header信息 ")]):a("span",[e._v("Header信息包含校验")]),e._v(" （关键字 #statusCode 表示http返回状态码） ")]),e._l(e.data.expectHeader,(function(t,i){return 0===e.data.assertHeader?a("div",{key:i,staticClass:"key-value-item"},[a("a-input-group",{attrs:{compact:""}},[a("a-input",{staticStyle:{width:"40%"},attrs:{placeholder:"KEY"},on:{click:function(t){return e.clickKeyOrValue(i,e.data.expectHeader)}},model:{value:t.key,callback:function(a){e.$set(t,"key",a)},expression:"item.key"}}),e._e(),a("hint-text-area",{staticStyle:{width:"50%","border-right-width":"0","font-size":"12px"},attrs:{placeholder:"VALUE","hint-key-words":e.hintKeyWords,"auto-size":{minRows:1.2,maxRows:10}},model:{value:t.value,callback:function(a){e.$set(t,"value",a)},expression:"item.value"}}),a("a-button",{attrs:{type:"link",shape:"circle",icon:"close-circle"},on:{click:function(t){return e.removeItem(i,e.data.expectHeader)}}})],1)],1):e._e()}))],2),a("div",{staticStyle:{"margin-top":"5px"}},[a("a-checkbox",{attrs:{checked:0===e.data.assertSql},on:{change:e.assertSqlChange}},[e._v(" SQL校验 ")]),0===e.data.assertSql?a("div",[a("a-select",{staticStyle:{"margin-top":"5px",width:"200px"},attrs:{size:"small"},on:{change:e.changesqlAssertType},model:{value:e.data.sqlAssertType,callback:function(t){e.$set(e.data,"sqlAssertType",t)},expression:"data.sqlAssertType"}},e._l(e.sqlAssertTypes,(function(t){return a("a-select-option",{key:t.id},[e._v(" "+e._s(t.name)+" ")])})),1),a("section",{staticClass:"code-area",staticStyle:{"margin-top":"5px"}},[a("div",{staticClass:"param-code-view",attrs:{id:"paramCodeViewApi"+e.selectOp.id}})])],1):e._e()],1),(e.data.protocol,e._e())]),a("div",{directives:[{name:"show",rawName:"v-show",value:"diffAssert"===e.assertType,expression:"assertType === 'diffAssert'"}]},[a("div",{staticStyle:{"margin-top":"5px"}},[a("a-checkbox",{attrs:{checked:0===e.data.assertExpectMap},on:{change:e.assertExpectMapChange}},[0===e.data.assertExpectMap?a("span",[e._v(" 包含如下键值 ")]):a("span",[e._v("键值对包含校验")])]),0===e.data.assertExpectMap?a("div",e._l(e.data.expectResponseMapDiff,(function(t,i){return a("div",{key:i,staticClass:"key-value-item"},[a("a-input-group",{attrs:{compact:""}},[a("a-input",{staticStyle:{width:"40%"},attrs:{placeholder:"KEY"},on:{click:function(t){return e.clickKeyOrValueDiff(i,e.data.expectResponseMapDiff)}},model:{value:t.key,callback:function(a){e.$set(t,"key",a)},expression:"item.key"}}),a("a-select",{staticStyle:{width:"20%"},attrs:{"default-value":"0"},model:{value:t.kvTag,callback:function(a){e.$set(t,"kvTag",a)},expression:"item.kvTag"}},[a("a-select-option",{attrs:{value:0}},[e._v(" 永久生效 ")]),a("a-select-option",{attrs:{value:1}},[e._v(" 临时生效 ")])],1),a("a-input",{directives:[{name:"show",rawName:"v-show",value:1===t.kvTag,expression:"item.kvTag === 1"}],staticStyle:{width:"15%"},attrs:{placeholder:"请输入过期时间;单位小时;"},on:{change:function(a){return e.expireTimeChange(a,t)}}}),a("span",{directives:[{name:"show",rawName:"v-show",value:1===t.kvTag&&t.expireTime,expression:"item.kvTag === 1 && item.expireTime"}],staticStyle:{width:"15%",display:"inline-block","line-height":"35px","margin-left":"10px"}},[e._v(" "+e._s(e.timeStamptoDate(t.expireTime))+" ")]),a("a-button",{attrs:{type:"link",shape:"circle",icon:"close-circle"},on:{click:function(t){return e.removeItemDiff(i,e.data.expectResponseMapDiff)}}})],1)],1)})),0):e._e()],1),a("div",{staticStyle:{"margin-top":"5px"}},[a("a-checkbox",{attrs:{checked:0===e.data.assertUnexpectMap},on:{change:e.assertUnexpectMapChange}},[0===e.data.assertUnexpectMap?a("span",[e._v(" 不包含如下键值 ")]):a("span",[e._v("键值对不包含校验")])]),0===e.data.assertUnexpectMap?a("div",e._l(e.data.unexpectResponseMapDiff,(function(t,i){return a("div",{key:i,staticClass:"key-value-item"},[a("a-input-group",{attrs:{compact:""}},[a("a-input",{staticStyle:{width:"40%"},attrs:{placeholder:"KEY"},on:{click:function(t){return e.clickKeyOrValueDiff(i,e.data.unexpectResponseMapDiff)}},model:{value:t.key,callback:function(a){e.$set(t,"key",a)},expression:"item.key"}}),a("a-select",{staticStyle:{width:"20%"},attrs:{"default-value":"0"},model:{value:t.kvTag,callback:function(a){e.$set(t,"kvTag",a)},expression:"item.kvTag"}},[a("a-select-option",{attrs:{value:0}},[e._v(" 永久生效 ")]),a("a-select-option",{attrs:{value:1}},[e._v(" 临时生效 ")])],1),a("a-input",{directives:[{name:"show",rawName:"v-show",value:1===t.kvTag,expression:"item.kvTag === 1"}],staticStyle:{width:"15%"},attrs:{placeholder:"请输入过期时间;单位小时;"},on:{change:function(a){return e.expireTimeChange(a,t)}}}),a("span",{directives:[{name:"show",rawName:"v-show",value:1===t.kvTag&&t.expireTime,expression:"item.kvTag === 1 && item.expireTime"}],staticStyle:{width:"15%",display:"inline-block","line-height":"35px","margin-left":"10px"}},[e._v(" "+e._s(e.timeStamptoDate(t.expireTime))+" ")]),a("a-button",{attrs:{type:"link",shape:"circle",icon:"close-circle"},on:{click:function(t){return e.removeItemDiff(i,e.data.unexpectResponseMapDiff)}}})],1)],1)})),0):e._e()],1)]),a("div",{staticStyle:{marginTop:"5px"}},[a("a-icon",{attrs:{type:"alert",theme:"twoTone"}}),e._v(" tips:如何使用 "),a("a",{attrs:{href:"http://wiki.baidu.com/pages/viewpage.action?pageId=1109952603",target:"_blank"}},[e._v(" 前置请求(包括Setup内)的返回值作为参数 ")]),e._v("，或使用 "),a("a",{attrs:{href:"http://wiki.baidu.com/pages/viewpage.action?pageId=1071514253",target:"_blank"}},[e._v("扩展函数")])],1),a("div",{staticStyle:{marginTop:"5px"}},[a("a-icon",{attrs:{type:"alert",theme:"twoTone"}}),e._v(" tips:如何使用"),a("a",{attrs:{href:"http://wiki.baidu.com/pages/viewpage.action?pageId=1109952707",target:"_blank"}},[e._v("高级断言")]),e._v("，如正则表达式、使用xpath获取返回值的key等 ")],1)]),a("a-tab-pane",{key:"waitTime",attrs:{tab:(e.waitingNum,"WaitTime"+e.waitingNum),size:"small"}},[a("div",{staticClass:"editor-content",staticStyle:{"margin-top":"5px"}},[a("div",{staticClass:"time-slot-item"},[a("label",{staticStyle:{width:"120px","margin-top":"3px"}},[e._v("执行前：")]),a("a-input",{attrs:{placeholder:"秒",size:"small"},model:{value:e.data.timeSlot.before,callback:function(t){e.$set(e.data.timeSlot,"before",t)},expression:"data.timeSlot.before"}})],1),a("div",{staticClass:"time-slot-item"},[a("label",{staticStyle:{width:"120px","margin-top":"3px"}},[e._v("执行后:")]),a("a-input",{attrs:{placeholder:"秒",size:"small"},model:{value:e.data.timeSlot.after,callback:function(t){e.$set(e.data.timeSlot,"after",t)},expression:"data.timeSlot.after"}})],1),a("div",{staticClass:"time-slot-item"},[a("label",{staticStyle:{width:"120px","margin-top":"3px"}},[e._v("断言前:")]),a("a-input",{attrs:{placeholder:"秒",size:"small"},model:{value:e.data.timeSlot.verifywaittime,callback:function(t){e.$set(e.data.timeSlot,"verifywaittime",t)},expression:"data.timeSlot.verifywaittime"}})],1),a("div",{staticClass:"time-slot-item"},[a("label",{staticStyle:{width:"120px","margin-top":"3px"}},[e._v("sql断言轮询时间:")]),a("a-input",{attrs:{placeholder:"秒",size:"small"},model:{value:e.data.timeSlot.sqlPollingTime,callback:function(t){e.$set(e.data.timeSlot,"sqlPollingTime",t)},expression:"data.timeSlot.sqlPollingTime"}})],1)])]),a("a-tab-pane",{key:"other",attrs:{tab:(e.otherNum,"Other"+e.otherNum),size:"small"}},[a("div",{staticClass:"time-slot-item"},[a("label",{staticStyle:{width:"80px","margin-top":"3px"}},[e._v("超时时间：")]),a("a-input",{attrs:{placeholder:"单位：秒,默认值60秒，最大值180秒",size:"small"},model:{value:e.data.timeout,callback:function(t){e.$set(e.data,"timeout",t)},expression:"data.timeout"}})],1),a("div",[a("label",{staticStyle:{display:"inline-block",width:"180px","margin-top":"3px"}},[e._v("在数据驱动中循环执行:")]),a("a-radio-group",{staticStyle:{margin:"5px"},model:{value:e.data.isDataDriver,callback:function(t){e.$set(e.data,"isDataDriver",t)},expression:"data.isDataDriver"}},[a("a-radio",{attrs:{value:0}},[e._v("是")]),a("a-radio",{attrs:{value:1}},[e._v("否")])],1)],1),1===e.data.protocol?a("div",[a("label",{staticStyle:{display:"inline-block",width:"180px","margin-top":"3px"}},[e._v("是否重定向:")]),a("a-radio-group",{staticStyle:{margin:"5px"},model:{value:e.data.isRedirect,callback:function(t){e.$set(e.data,"isRedirect",t)},expression:"data.isRedirect"}},[a("a-radio",{attrs:{value:0}},[e._v("是")]),a("a-radio",{attrs:{value:1}},[e._v("否")])],1)],1):e._e(),1===e.data.protocol?a("div",[a("label",{staticStyle:{display:"inline-block",width:"180px","margin-top":"3px"}},[e._v("是否JSONP转化JSON:")]),a("a-radio-group",{staticStyle:{margin:"5px"},model:{value:e.data.processType,callback:function(t){e.$set(e.data,"processType",t)},expression:"data.processType"}},[a("a-radio",{attrs:{value:"JSONP_TO_JSON"}},[e._v("是")]),a("a-radio",{attrs:{value:"NO_PROCESS"}},[e._v("否")])],1)],1):e._e()]),a("a-tab-pane",{key:"async",attrs:{tab:(e.asyncNum,"Async"+e.asyncNum),size:"small"}},[a("div",{staticClass:"time-slot-item"},[a("label",{staticStyle:{width:"100px","margin-top":"3px"}},[e._v("轮询次数限制:")]),a("a-input",{attrs:{disabled:!!e.data.extId&&-1!==e.data.extId,placeholder:"次",size:"small"},model:{value:e.data.asyncSetting.triesLimit,callback:function(t){e.$set(e.data.asyncSetting,"triesLimit",t)},expression:"data.asyncSetting.triesLimit"}})],1),a("div",{staticClass:"time-slot-item"},[a("label",{staticStyle:{width:"100px","margin-top":"3px"}},[e._v("轮询时间限制:")]),a("a-input",{attrs:{disabled:!!e.data.extId&&-1!==e.data.extId,placeholder:"秒",size:"small"},model:{value:e.data.asyncSetting.timeLimit,callback:function(t){e.$set(e.data.asyncSetting,"timeLimit",t)},expression:"data.asyncSetting.timeLimit"}})],1)])],1)],1),a("a-modal",{staticStyle:{position:"relative"},attrs:{title:"修改模板（个性化）名称",width:500,"body-style":{height:"100px",overflow:"auto"},"ok-text":"提交","cancel-text":"取消"},on:{ok:e.handleOk,cancel:e.handleCancel},model:{value:e.isShowturnToTemplate,callback:function(t){e.isShowturnToTemplate=t},expression:"isShowturnToTemplate"}},[a("div",[a("label",[e._v("API模板名称:")]),a("a-input",{staticStyle:{width:"300px","margin-left":"10px"},model:{value:e.turnToTemplateNewTplText,callback:function(t){e.turnToTemplateNewTplText=t},expression:"turnToTemplateNewTplText"}})],1),a("span",{directives:[{name:"show",rawName:"v-show",value:0===e.ifshow,expression:"ifshow === 0"}],staticStyle:{color:"#ff0000"}},[e._v(" 名称不能为空 ")])])],1):e._e()},je=[],qe=a("d87d"),Ke=a("56b3"),ze=a.n(Ke),Ge=(a("a7be"),a("ffda"),a("d7d5"),a("f6b6"),a("9b74"),a("991c"),a("31c5"),function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("at-ta",{ref:"at",attrs:{ats:e.ats,members:e.hintKeyWords,"allow-spaces":!1}},[a("a-textarea",{attrs:{"auto-size":e.autoSize,placeholder:e.placeholder,value:e.value,disabled:e.textDisabled,contenteditable:""},on:{change:function(t){return e.$emit("change",t.target.value)},focus:e.handleFocus,blur:e.handleBlur}})],1)],1)}),Be=[],Fe=a("53ff"),Ue=a.n(Fe),Je={name:"hintTextArea",props:{hintKeyWords:{type:Array,default:function(){return[]}},placeholder:{type:String,default:function(){return"请输入..."}},ats:{type:Array,default:function(){return["$"]}},value:{type:String,default:function(){return""}},textDisabled:{type:Boolean,default:function(){return!1}},autoSize:{type:Object,default:function(){return{minRows:5,maxRows:11}}}},model:{prop:"value",event:"change"},updated:function(){var e=this;this.$nextTick((function(){e.$refs.at.closePanel()}))},data:function(){return{blurTimer:null,hideOnBlur:!0}},components:{AtTa:Ue.a},methods:{handleFocus:function(){this.hideOnBlur&&clearTimeout(this.blurTimer)},handleBlur:function(){var e=this;this.hideOnBlur&&(this.blurTimer=setTimeout((function(){e.$refs.at.closePanel()}),0))}}},He=Je,We=(a("086b"),Object($["a"])(He,Ge,Be,!1,null,"c0cc2810",null)),Ye=We.exports,Qe={components:{hintTextArea:Ye,AtTa:Ue.a},props:{hintKeyWords:{type:Array,default:function(){return[]}},autocompleteTables:{type:Object,default:function(){return{}}}},data:function(){return{hintList:[],esList:[],protocolsLists:[],methodsLists:[],data:null,assertType:"normalAssert",sqlAssertTypes:[{id:1,name:"结果集不为空"},{id:2,name:"结果集为空"}],activeKey:"body",fromDataTableData:[{key:"",value:"",type:"text"}],editingKey:"",codeMirrorParam:null,jsonCodeMirrorParam:null,paramsCodeMirror:null,headerCodeMirror:null,record:null,filesInfo:{proto:{serialization:{files:[]},deserialization:{files:[]}},python:{deserialization:{files:[]}}},loginInfos:[],paramsNum:"",smartParams:[],authorizationNum:"",headerNum:"",bodyNum:"",assertNum:"",waitingNum:"",otherNum:"",asyncNum:"",isForm:!0,sqlEditor:{value:""},bodyText:{},bodyTexts:{},keyValObj:{key:"",value:""},initialApiData:null,version:{},isShowturnToTemplate:!1,turnToTemplateNewTplText:"",ifshow:1,action:"".concat(window.location.origin,"/itp/api/upload"),uploadIndex:0,authDefaultValue:!1,isAutoSave:!1}},created:function(){this.protocolsLists=qe["h"],this.methodsLists=qe["g"]},watch:{selectOp:function(){this.getFiles(),this.activeKey="body",this.isForm=!0},"data.params":function(){this.getParamsTab()},"data.loginId":function(){this.getAuthorizationTab()},"data.header":function(){this.getHeaderTab()},"data.body":function(){this.getBodyTab(this.data.bodyType)},"data.assertExpect":{handler:function(){this.getAssertTab()},deep:!0},"data.expectResponse":{handler:function(){this.getAssertTab()},deep:!0},"data.assertExpectJsonSchema":{handler:function(){this.getAssertTab()},deep:!0},"data.expectJsonSchema":{handler:function(){this.getAssertTab()},deep:!0},"data.assertExpectMap":{handler:function(){this.getAssertTab()},deep:!0},"data.expectResponseMap":{handler:function(){this.getAssertTab()},deep:!0},"data.expectResponseMapDiff":{handler:function(){this.getAssertTab()},deep:!0},"data.unexpectResponseMapDiff":{handler:function(){this.getAssertTab()},deep:!0},"data.assertUnexpectMap":{handler:function(){this.getAssertTab()},deep:!0},"data.unexpectResponseMap":{handler:function(){this.getAssertTab()},deep:!0},"data.assertHeader":{handler:function(){this.getAssertTab()},deep:!0},"data.expectHeader":{handler:function(){this.getAssertTab()},deep:!0},"data.assertSql":{handler:function(){this.getAssertTab()},deep:!0},"data.sqlExpect":{handler:function(){this.getAssertTab()},deep:!0},"data.authParams":{handler:function(){this.getAssertTab()},deep:!0},"data.timeSlot.before":function(){this.getWattingTab()},"data.timeSlot.after":function(){this.getWattingTab()},"data.timeSlot.verifywaittime":function(){this.getWattingTab()},"data.timeSlot.sqlPollingTime":function(){this.getWattingTab()},"data.timeout":function(){this.getOtherTab()},"data.isDataDriver":function(){this.getOtherTab()},"data.isRedirect":function(){this.getOtherTab()},"data.processType":function(){this.getOtherTab()},"data.asyncSetting.timeLimit":function(){this.getAsyncTab()},"data.asyncSetting.triesLimit":function(){this.getAsyncTab()},isSaveApi:function(){"saveApi"===this.isSaveApi&&this.ok()},data:{handler:function(e,t){this.isAutoSave?this.autoSave(e,t):this.isAutoSave=!0},deep:!0}},computed:Object(l["a"])({},Object(d["b"])({currentProductLine:function(e){return e.productline.currentProductLine},isSaveApi:function(e){return e.api.isSaveApi},selectOp:function(e){return e.api.currentOp},beforeRenderTime:function(e){return e.api.beforeRenderTime}})),mounted:function(){this.getFiles()},methods:{timeStamptoDate:function(e){return e?Object(ue["i"])(e):""},expireTimeChange:function(e,t){e.target.value&&(Object(ue["d"])(e.target.value)?this.$set(t,"expireTime",(new Date).getTime()+36e5*e.target.value):this.$message.warn("请输入数字！"))},autoSave:w.a.debounce((function(e,t){e&&t&&e.id===t.id&&this.ok()}),1e3),ok:function(){var e=this,t=Object(l["a"])({},this.data);this.handleSubmitData(t),this.initialApiData=Object(l["a"])({},this.data);var a={id:t.id,typeTag:this.selectOp.type};delete t.typeTag,delete t.id,delete t.proto,delete t.version,delete t.processType,delete t.text,t.extId&&-1!==t.extId?this.$confirm({title:"提示",content:"该api是从API模版复制的，如果修改模版中设置的参数将会解除该api与api模版的引用关系，确定要修改吗？",onOk:function(){t.extId=-1,Object(m["Q"])(a,t).then((function(t){t.status?e.$message.error(t.message):e.$store.dispatch("setSaveTime",(new Date).getTime())})).catch((function(e){}))},onCancel:function(){}}):Object(m["Q"])(a,t).then((function(t){t.status?e.$message.error(t.message):e.$store.dispatch("setSaveTime",(new Date).getTime())})).catch((function(e){})),this.$store.dispatch("setIsSaveApi","")},hintTextAreaChange:function(e){console.log(e,1260)},handleTypeChange:function(e,t){this.$set(this.data.body[t],"value","")},uploadBtn:function(e){this.uploadIndex=e},fileUpload:function(e){var t=e.file,a=e.fileList;"uploading"!==t.status&&console.log(t,a,1179),"done"===t.status?t.response.status?this.$message.error(t.response.message):(this.$message.success("".concat(t.name," 文件上传成功！")),this.data.body[this.uploadIndex].value="${ITPFILE."+t.name+"}"):"error"===t.status&&this.$message.error("".concat(t.name," 文件上传失败."))},handleOk:function(){var e=this,t=this.data.id;""===this.turnToTemplateNewTplText?this.ifshow=0:Object(m["L"])({id:t},{tplText:this.turnToTemplateNewTplText,productId:this.$route.query.productId}).then((function(t){if(t.status)e.$message.error(t.message);else{var a=t.data;-1!==a.id?(e.$message.success("新增api模板id: "+a.id),e.isShowturnToTemplate=!1):-1===a.id?e.$message.warn("已有重复模板，请更换名称!"):e.$message.error("操作失败, 请联系服务号")}})).catch((function(e){}))},handleCancel:function(){this.isShowturnToTemplate=!1},turnToTemplate:function(){this.isShowturnToTemplate=!0;var e={1:"GET",2:"POST",3:"PUT",4:"DELETE",5:"OPTIONS",6:"HEAD",7:"PATCH"}[this.data.method],t=new Array;t=this.data.url.split("?");var a=t[0];this.turnToTemplateNewTplText=a+"("+e+")"},handleProto:function(e,t,a){this.$set(e,a,t)},changefile:function(e,t,a){4!=+this.data.bodyType&&8!=+this.data.bodyType&&100!=+this.data.bodyType||(this.version[a]=this.getVersionFromFiles(e,t),this.data[a].version=this.version[a][0],"无"!==t&&""!==t||(this.data[a].messageName="",this.data[a].col=""))},activeKeyChange:function(e){this.activeKey=e,"assert"===this.activeKey&&(0===this.data.assertSql?this.initCodeMirror():this.codeMirrorParam=null)},delType:function(e){var t=w.a.cloneDeep(e);return t.forEach((function(e){delete e.type})),t},turnToParams:function(e){var t="";return e.forEach((function(a,i){var s="";a.key&&i!==e.length-1?s=a.hasOwnProperty("value")&&a.value?"".concat(a.key,"=").concat(a.value,"&"):"".concat(a.key,"&"):a.key&&i===e.length-1&&(s=a.hasOwnProperty("value")&&a.value?"".concat(a.key,"=").concat(a.value):"".concat(a.key)),t+=s})),t},handleSubmitData:function(e){if(e.text=this.selectOp.text,e.expectResponseMap=JSON.stringify(Object(ue["b"])(Object(ue["a"])(e.expectResponseMap.concat(e.expectResponseMapDiff)))),delete e.expectResponseMapDiff,e.unexpectResponseMap=JSON.stringify(Object(ue["b"])(Object(ue["a"])(e.unexpectResponseMap.concat(e.unexpectResponseMapDiff)))),delete e.unexpectResponseMapDiff,e.expectHeader=JSON.stringify(Object(ue["b"])(Object(ue["a"])(e.expectHeader))),e.timeSlot=JSON.stringify(e.timeSlot),e.asyncSetting=JSON.stringify(e.asyncSetting),1==e.bodyType||9==e.bodyType||10==e.bodyType)if(this.isForm){var t=this.delType(this.data.body);e.body=JSON.stringify(Object(ue["b"])(Object(ue["a"])(Object(h["a"])(t))))}else{for(var a=e.body.split("\n"),i=[],s=0;s<a.length;s++){var n=a[s].split("\t");if(null!=n[0]&&""!=n[0]&&void 0!=n[0]){var o={key:n[0],value:n[1]};i.push(o)}}e.body=JSON.stringify(Object(ue["b"])(Object(ue["a"])(i)))}if(4==+e.bodyType||8==+e.bodyType||100==+e.bodyType){var r=this.filesInfo.proto.serialization.prefix+this.data.protoSerialization.fileName+"/"+this.data.protoSerialization.version+"/"+this.data.protoSerialization.fileName+this.filesInfo.proto.serialization.postfix+"/"+this.data.protoSerialization.messageName+"/"+this.data.protoSerialization.col,c=this.filesInfo.proto.deserialization.prefix+this.data.protoDeserialization.fileName+"/"+this.data.protoDeserialization.version+"/"+this.data.protoDeserialization.fileName+this.filesInfo.proto.deserialization.postfix+"/"+this.data.protoDeserialization.messageName+"/"+this.data.protoDeserialization.col;e.protoRequestFilePath="无"!==this.data.protoSerialization.version?r:"",e.protoResponseFilePath="无"!==this.data.protoDeserialization.version?c:"",delete e.protoSerialization,delete e.protoDeserialization,delete e.pythonDeserialization}else e.protoSerialization&&delete e.protoSerialization,e.protoDeserialization&&delete e.protoDeserialization,e.protoRequestFilePath&&delete e.protoRequestFilePath,e.protoResponseFilePath&&delete e.protoResponseFilePath,e.pythonDeserialization&&delete e.pythonDeserialization,e.pythonResponseFilePath&&delete e.pythonResponseFilePath;"string"!==typeof e.body&&(e.body=JSON.stringify(e.body))},checkOpChanged:function(){var e=Object(l["a"])({},this.data),t=Object(ue["h"])(this.initialApiData),a=Object(ue["h"])(e);return JSON.stringify(t)!==JSON.stringify(a)},getIsNotFormPlaceholder:function(){return"每行一条记录，制表符分隔，第一列为key，第二列为value(可以使用全局变量，扩展函数或前置请求返回值),如果value暂不填则可输入空格。可以在excel里写导出为txt，或者直接写在文件里拷贝进来"},getDisplayLogin:function(e){return 0===e.id||-1===e.id?e.name:Object(qe["d"])(e.type)+" - "+e.name},getOtherTab:function(){var e=0;15!=this.data.timeout&&""!=this.data.timeout&&e++,0==this.data.isDataDriver&&e++,0==this.data.isRedirect&&e++,"JSONP_TO_JSON"==this.data.processType&&e++,this.otherNum=0===e?"":"("+e+")"},getAsyncTab:function(){if(void 0!==this.data.asyncSetting){var e=0;""!==this.data.asyncSetting.triesLimit&&e++,""!==this.data.asyncSetting.timeLimit&&e++,this.asyncNum=0===e?"":"("+e+")"}else this.asyncNum=""},getWattingTab:function(){void 0===this.data.timeSlot&&(this.waitingNum="");var e=0;""!==this.data.timeSlot.before&&e++,""!==this.data.timeSlot.after&&e++,""!==this.data.timeSlot.verifywaittime&&e++,""!==this.data.timeSlot.sqlPollingTime&&e++,this.waitingNum=0===e?"":"(".concat(e,")")},getAssertNum:function(){var e=0;return 0===this.data.assertExpect&&""!==this.data.expectResponse&&e++,0===this.data.assertExpectJsonSchema&&""!==this.data.assertExpectJsonSchema&&e++,0===this.data.assertExpectMap&&(this.data.expectResponseMap.forEach((function(t){t.key&&(e+=1)})),this.data.expectResponseMapDiff.forEach((function(t){t.key&&(e+=1)}))),0===this.data.assertUnexpectMap&&(this.data.unexpectResponseMap.forEach((function(t){t.key&&(e+=1)})),this.data.unexpectResponseMapDiff.forEach((function(t){t.key&&(e+=1)}))),0===this.data.assertHeader&&this.data.expectHeader.forEach((function(t){t.key&&(e+=1)})),0===this.data.assertSql&&""!==this.data.sqlExpect&&e++,this.data.authParams&&""!==this.data.authParams&&e++,e},getAssertTab:function(){var e=this.getAssertNum();this.assertNum=0===e?"":"(".concat(e,")")},getVersionFromFiles:function(e,t){for(var a=e||[],i=a.length,s=0;s<i;s++)if(a[s].fileName===t)return a[s].version},forbidTab:function(e){e.preventDefault()},replaceSpacing:function(){var e=document.getElementById("tab-indent"),t=e.selectionStart,a=e.selectionEnd;if(void 0!==t&&void 0!==a){var i=e.value,s=i.substring(0,t)+"\t"+i.substring(a);e.value=s,e.focus(),e.selectionStart=t+"\t".length,e.selectionEnd=t+"\t".length}},changeFormToText:function(){if(this.isForm=!this.isForm,this.isForm){for(var e=this.data.body.split("\n"),t=[],a=0;a<e.length;a++){var i=e[a].split("\t");null===i[0]&&""===i[0]&&void 0===i[0]&&(i[0]=""),null===i[1]&&""===i[1]&&void 0===i[1]&&(i[1]="");var s={key:i[0],value:i[1],type:-1!==i[1].indexOf("ITPFILE")?"file":"text"};t.push(s)}this.data.body=t}else{for(var n=!0,o=Object(h["a"])(this.data.body),r=0;r<o.length;r++)null===o[r].key||""===o[r].key||void 0===o[r].key?o[r].key="":n=!1,null===o[r].value||""===o[r].value||void 0===o[r].value?o[r].value="":n=!1,this.data.body=0===r?o[r].key+"\t"+o[r].value:this.data.body+"\n"+o[r].key+"\t"+o[r].value;n&&(this.data.body="")}},getBodyTab:function(e){if(void 0!==e)if(1==e||9==e||10==e){for(var t=this.data.body,a=0,i=0;i<t.length;i++)""!==t[i].key&&a++;this.bodyNum=0===a?"":"(".concat(a,")")}else""!==this.data.body?this.bodyNum="(1)":this.bodyNum="";else this.bodyNum=""},getHeaderTab:function(){var e=this.data.header;if(void 0===e||""===e)this.headerNum="";else{var t=this.data.header.split("\n").length;this.headerNum="(".concat(t,")")}},getAuthorizationTips:function(){return"".concat(window.location.href.split("#")[0],"#/configmgmt?productId=").concat(this.currentProductLine.id)},getAuthorizationTab:function(){var e=this.data.loginId;this.authorizationNum=void 0===e||0===e||-1===e||""===e?"":"(1)"},getParamsTab:function(){this.paramsNum="";var e=this.data.params;if(void 0===e||""===e);else if(1===e.split("&").length)-1!==e.indexOf("=")&&(this.paramsNum="(1)");else{var t=e.split("&"),a=0;a=-1!==t[t.length-1].indexOf("=")?e.split("&").length:e.split("&").length-1,this.paramsNum="(".concat(a,")")}},listLoginInfos:function(){var e=this;return Object(o["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,Object(m["r"])(e.$route.query.productId).then((function(t){if(!t.status){t.data.splice(0,0,{id:0,name:"使用全局设置中的默认权限"}),t.data.splice(1,0,{id:-1,name:"无"}),e.loginInfos=t.data,e.authDefaultValue=!1;var a,i=!1;for(a=0;a<e.loginInfos.length;a++)if(+e.loginInfos[a].id===+e.data.loginId){i=!0;break}i||(e.authDefaultValue=!0)}})).catch((function(e){}));case 2:case"end":return t.stop()}}),t)})))()},getAuthDefauteValue:function(e){for(var t=0;t<this.loginInfos.length;t++)if(e===this.loginInfos[t].id)return this.getDisplayLogin(this.loginInfos[t])},queryNodeById:function(){var e=this;Object(m["F"])({id:this.selectOp.id,typeTag:this.selectOp.type,versionId:this.selectOp.versionId}).then((function(t){if(!t.status){var a=Object(l["a"])({},t.data);e.data=Object(l["a"])({},a),e.listLoginInfos(),e.data.sqlExpect=(e.data.sqlExpect||"").trim(),1===e.data.bodyType||9===e.data.bodyType||10===e.data.bodyType?(e.data.body=Object(ue["g"])(a.body,[Object(l["a"])({},e.keyValObj)]),e.addType(e.data.body)):(e.jsonCodeMirrorParam=null,e.initJsonCodeMirror()),4!==e.data.bodyType&&8!==e.data.bodyType&&100!==e.data.bodyType||(e.$set(e.data,"protoSerialization",e.fixfileStr(e.data.protoRequestFilePath,"protoserialization")),e.$set(e.data,"protoDeserialization",e.fixfileStr(e.data.protoResponseFilePath,"protodeserialization")),e.$set(e.version,"protoSerialization",e.getVersionFromFiles(e.filesInfo.proto.serialization.files,e.data.protoSerialization.fileName)),e.$set(e.version,protoDeserialization,e.getVersionFromFiles(e.filesInfo.proto.deserialization.files,e.data.protoDeserialization.fileName))),8===e.data.bodyType&&(e.$set(e.data,"pythonDeserialization",e.fixfileStr(e.data.pythonResponseFilePath,"pythondeserialization")),e.$set(e.version,"pythonDeserialization",e.getVersionFromFiles(e.filesInfo.python.deserialization.files,e.data.pythonDeserialization.fileName))),e.data.loginId=-1===+e.data.loginId?0:e.data.loginId,e.parseDiff(Object(ue["g"])(a.expectResponseMap,[Object(l["a"])({},e.keyValObj)]),"expect"),e.parseDiff(Object(ue["g"])(a.unexpectResponseMap,[Object(l["a"])({},e.keyValObj)]),"unexpect"),e.data.expectHeader=Object(ue["g"])(a.expectHeader,[Object(l["a"])({},e.keyValObj)]),e.data.timeSlot=e.getTimeSlot(Object(ue["g"])(a.timeSlot,{})),e.data.asyncSetting=e.getAsyncSetting(Object(ue["g"])(a.asyncSetting,{})),11!==a.type&&"es"!==a.type||e.queryESList(),e.initialApiData=Object(l["a"])({},e.data),e.activeKey=Object(qe["f"])(e.data.protocol),console.log("this.beforeRenderTime",e.beforeRenderTime,1623),console.log("API操作编辑区域加载时间",(new Date).getTime()-e.beforeRenderTime),_hmt.push(["_trackEvent","API操作编辑区域加载时间",(new Date).getTime()-e.beforeRenderTime])}})).catch((function(e){}))},getParams:function(e){if(this.smartParams=[],void 0===e||""===e)this.smartParams=[Object(l["a"])({},this.keyValObj)];else if(1===e.split("&").length){if(-1!==e.indexOf("=")){var t=e.split("=");this.smartParams.push({key:t[0],value:t[1]})}}else{var a=e.split("&");console.log(a,2087);for(var i=0;i<a.length;i++)if(""!==a[i])if("$"!==a[i][a[i].length-2]||"{"!==a[i][a[i].length-1])if(-1!==a[i].indexOf("=")){for(var s=a[i].split("="),n="",o=1;o<s.length;o++)o<s.length-1?n+=s[o]+"=":n+=s[o];this.smartParams.push({key:s[0],value:n})}else this.smartParams.push({key:a[i]});else i+1<a.length&&(a[i+1]=a[i]+"&"+a[i+1])}return this.smartParams},parseDiff:function(e,t){var a=[],i=[];e.length&&(e.forEach((function(e){e.kvTag?(Object.prototype.hasOwnProperty.call(e,"value")||(e.value=""),i.push(e)):e.key&&""===e.value?i.push({key:e.key,value:e.value?e.value:"",kvTag:0,expireTime:"",tag:void 0!==e.tag?e.tag:0}):a.push(e)})),a.length||(a=[{key:"",value:""}]),i.length||(i=[{key:"",value:"",kvTag:0,expireTime:""}]),"expect"===t?(this.$set(this.data,"expectResponseMap",a),this.$set(this.data,"expectResponseMapDiff",i)):(this.$set(this.data,"unexpectResponseMap",a),this.$set(this.data,"unexpectResponseMapDiff",i)))},addType:function(e){var t=this;e.forEach((function(e){e.value&&-1===e.value.toString().indexOf("${ITPFILE")?t.$set(e,"type","text"):t.$set(e,"type","file")}))},getAsyncSetting:function(e){return e=Object(ue["e"])(e)?e:{},["triesLimit","timeLimit"].forEach((function(t){e[t]=e[t]||""})),e},queryESList:function(){var e=this;Object(m["j"])(this.$route.query.productId).then((function(t){t.status||(console.log(e.data.loginId,1856),console.log(t.data.length,1857),0===e.data.loginId&&t.data.length>0&&(e.data.loginId=t.data[0].id),e.esList=t.data)})).catch((function(e){}))},fixfileStr:function(e,t){var a=e.length;if(!a)return{fileName:"无",version:"无",messageName:"",col:""};var i=e.split("/"),s="";if(i.length>5)for(var n=7;n<i.length;n++)s+=i[n],n!==i.length-1&&(s+="/");return{fileName:i[3],version:i[4],messageName:i[6],col:s}},getFiles:function(){var e=this;"api"===this.selectOp.type?Object(m["o"])(this.$route.query.productId).then((function(t){t.status||(e.filesInfo=t.data,e.filesInfo.proto.serialization.files.unshift({fileName:"无",version:["无"],messageName:"",col:""}),e.filesInfo.proto.deserialization.files.unshift({fileName:"无",version:["无"],messageName:"",col:""}),e.filesInfo.python.deserialization.files.unshift({fileName:"无",version:["无"],messageName:"",col:""}),e.queryNodeById())})).catch((function(e){})):this.queryNodeById()},initCodeMirror:function(){var e=this;setTimeout((function(){if(!e.codeMirrorParam){var t="paramCodeViewApi".concat(e.selectOp.id);e.codeMirrorParam=ze()(document.getElementById(t),{mode:"text/x-mysql",indentWithTabs:!0,lineWrapping:!0,smartIndent:!1,lineNumbers:!0,matchBrackets:!0,autofocus:!1,completeSingle:!1,width:"100%",gutters:["CodeMirror-linenumbers"],extraKeys:{Tab:"autocomplete"}}),e.codeMirrorParam.on("keyup",(function(){e.data.sqlExpect=e.codeMirrorParam.getDoc().getValue()})),e.codeMirrorParam.on("keyup",(function(t,a){[52].indexOf(a.keyCode)>-1&&a.shiftKey&&ze.a.showHint(t,ze.a.hint.sql,{completeSingle:!1,tables:e.autocompleteTables})})),e.codeMirrorParam.setSize("auto",200)}e.codeMirrorParam.setValue(e.data.sqlExpect)}),100)},initJsonCodeMirror:function(){var e=this;setTimeout((function(){if(!e.jsonCodeMirrorParam){var t="JsonCodeViewApi".concat(e.selectOp.id),a=document.getElementById(t);a&&a.children&&a.children.length&&a.children.forEach((function(e){a.removeChild(e)})),e.jsonCodeMirrorParam=ze()(document.getElementById(t),{mode:"application/json",indentWithTabs:!0,lineWrapping:!0,smartIndent:!1,lineNumbers:!0,matchBrackets:!0,autofocus:!1,completeSingle:!1,width:"100%",gutters:["CodeMirror-lint-markers"],extraKeys:{Tab:"autocomplete"},hint:null,hintOptions:null}),e.jsonCodeMirrorParam.on("keyup",(function(){e.data.body=e.jsonCodeMirrorParam.getDoc().getValue()})),e.jsonCodeMirrorParam.on("keyup",(function(t,a){[52].indexOf(a.keyCode)>-1&&a.shiftKey&&ze.a.showHint(t,ze.a.hint.sql,{tables:e.autocompleteTables})})),e.jsonCodeMirrorParam.setSize("auto","260")}var i=e.data.body;"string"!==typeof e.data.body&&(i=JSON.stringify(e.data.body)),e.jsonCodeMirrorParam.setValue(i)}),100)},changeLoginId:function(e){this.data.loginId=e,this.authDefaultValue=!1},changesqlAssertType:function(e){this.data.sqlAssertType=e},assertSqlChange:function(e){this.data.assertSql=e.target.checked?0:1,0===this.data.assertSql?this.initCodeMirror():this.codeMirrorParam=null},assertHeaderChange:function(e){this.data.assertHeader=e.target.checked?0:1},assertUnexpectMapChange:function(e){this.data.assertUnexpectMap=e.target.checked?0:1},assertExpectMapChange:function(e){this.data.assertExpectMap=e.target.checked?0:1},assertExpectChange:function(e){this.data.assertExpect=e.target.checked?0:1},assertExpectJsonSchemaChange:function(e){this.data.assertExpectJsonSchema=e.target.checked?0:1},turnStrToJsonChange:function(e){this.data.turnStrToJson=e.target.checked?0:1},isEncodingChange:function(e){this.data.isEncoding=e.target.checked?1:0},removeItem:function(e,t){t.splice(e,1),0===t.length&&this.addEmptyItem(t)},removeItemType:function(e,t){t.splice(e,1),0===t.length&&t.push({key:"",value:"",type:"text"})},removeItemDiff:function(e,t){t.splice(e,1),0===t.length&&t.push({key:"",value:"",kvTag:0,expireTime:""})},addEmptyItem:function(e){e.push({key:"",value:""})},clickKeyOrValueType:function(e,t){e===t.length-1&&t.push({key:"",value:"",type:"text"})},clickKeyOrValueDiff:function(e,t){console.log(e,t.length),e===t.length-1&&t.push({key:"",value:"",kvTag:0,expireTime:""})},clickKeyOrValue:function(e,t){e===t.length-1&&t.push({key:"",value:""})},onChangeBodyType:function(e){if(this.$set(this.data,"bodyType",e.target.value),10===this.data.bodyType||1===this.data.bodyType||9===this.data.bodyType)if(Object(ue["f"])(this.data.body))for(var t=0;t<this.data.body.length;t++){var a=Object.keys(this.data.body[t]);if((3!==a.length||-1===a.indexOf("key")||-1===a.indexOf("value"))&&-1!==a.indexOf("type")){this.data.body=[{key:"",value:"",type:"text"}];break}}else{var i=[];try{if(i=JSON.parse(this.data.body),Object(ue["f"])(i))for(var s=0;s<i.length;s++){var n=Object.keys(i[s]);if(3!==n.length||-1===n.indexOf("key")||-1===n.indexOf("value")||-1===n.indexOf("type")){i=[{key:"",value:"",type:"text"}];break}}else i=[{key:"",value:"",type:"text"}]}catch(o){i=[{key:"",value:"",type:"text"}]}this.data.body=i}3!==this.data.bodyType&&4!==this.data.bodyType&&5!==this.data.bodyType&&8!==this.data.bodyType&&18!==this.data.bodyType&&28!==this.data.bodyType&&100!==this.data.bodyType||"string"!==typeof this.data.body&&(this.data.body=JSON.stringify(this.data.body)),2!==this.data.bodyType&&6!==this.data.bodyType&&7!==this.data.bodyType&&16!==this.data.bodyType||(this.jsonCodeMirrorParam=null,this.initJsonCodeMirror()),4!==this.data.bodyType&&8!==this.data.bodyType&&100!==this.data.bodyType||(this.$set(this.data,"protoSerialization",{fileName:"无",version:"无",messageName:"",col:""}),this.$set(this.data,"protoDeserialization",{fileName:"无",version:"无",messageName:"",col:""}),this.$set(this.data,"pythonDeserialization",{fileName:"无",version:"无",messageName:"",col:""}),this.version.protoSerialization=this.getVersionFromFiles(this.filesInfo.proto.serialization.files,this.data.protoSerialization.fileName),this.version.protoDeserialization=this.getVersionFromFiles(this.filesInfo.proto.deserialization.files,this.data.protoDeserialization.fileName),this.version.pythonDeserialization=this.getVersionFromFiles(this.filesInfo.python.deserialization.files,this.data.pythonDeserialization.fileName))},changeMethod:function(e){this.data.method=e},changeProtocol:function(e){this.data.protocol=e,console.log(this.data.protocol,2465),1===this.data.protocol?this.$set(this.data,"params",[Object(l["a"])({},this.keyValObj)]):this.$set(this.data,"params",""),this.activeKey=Object(qe["f"])(e),"body"!==this.activeKey||2!==this.data.bodyType&&6!==this.data.bodyType&&7!==this.data.bodyType||(this.jsonCodeMirrorParam=null,this.initJsonCodeMirror())},getTimeSlot:function(e){return e=Object(ue["e"])(e)?e:{},["before","after","verifywaittime","sqlPollingTime"].forEach((function(t){e[t]=e[t]||""})),e},getPlaceholderFromStaticData:function(e,t){return Object(qe["e"])(e,t)},getDisplayProtocolFromStaticData:function(e){return Object(qe["c"])(e)},getDisplayMethodFromStaticData:function(e){return Object(qe["b"])(e)}}},Xe=Qe,Ze=(a("f1b2"),Object($["a"])(Xe,Ae,je,!1,null,"13b4882a",null)),et=Ze.exports,tt=function(){var e=this,t=e.$createElement,a=e._self._c||t;return e.visible?a("div",[a("div",{staticClass:"sql-fieldset",attrs:{id:"sqlEditor"+e.selectOp.id}}),a("a-tabs",{attrs:{animated:!1,size:"small"},model:{value:e.activeKey,callback:function(t){e.activeKey=t},expression:"activeKey"}},[a("a-tab-pane",{key:"assert",attrs:{tab:(e.assertNum,"Assert"+e.assertNum),size:"small"}},[a("div",{staticStyle:{"margin-top":"5px"}},[a("a-checkbox",{attrs:{checked:0===e.data.assertSql},on:{change:e.assertSqlChange}},[e._v(" SQL验证 ")]),a("div",{directives:[{name:"show",rawName:"v-show",value:0===e.data.assertSql,expression:"data.assertSql === 0"}]},[a("a-select",{staticStyle:{"margin-top":"5px",width:"200px"},attrs:{size:"small"},on:{change:e.changesqlAssertType},model:{value:e.data.sqlAssertType,callback:function(t){e.$set(e.data,"sqlAssertType",t)},expression:"data.sqlAssertType"}},e._l(e.sqlAssertTypes,(function(t){return a("a-select-option",{key:t.id},[e._v(" "+e._s(t.name)+" ")])})),1),a("section",{staticClass:"code-area",staticStyle:{"margin-top":"5px"}},[a("div",{staticClass:"param-code-view",attrs:{id:"paramCodeViewSql"+e.selectOp.id}})])],1)],1)]),a("a-tab-pane",{key:"waitTime",attrs:{tab:(e.waitingNum,"WaitTime"+e.waitingNum),size:"small"}},[a("div",{staticStyle:{"margin-top":"5px"}},[a("div",{staticClass:"time-slot-item"},[a("label",{staticStyle:{width:"120px","margin-top":"3px"}},[e._v("执行前：")]),a("a-input",{attrs:{placeholder:"秒",size:"small"},model:{value:e.data.timeSlot.before,callback:function(t){e.$set(e.data.timeSlot,"before",t)},expression:"data.timeSlot.before"}})],1),a("div",{staticClass:"time-slot-item"},[a("label",{staticStyle:{width:"120px","margin-top":"3px"}},[e._v("执行后:")]),a("a-input",{attrs:{placeholder:"秒",size:"small"},model:{value:e.data.timeSlot.after,callback:function(t){e.$set(e.data.timeSlot,"after",t)},expression:"data.timeSlot.after"}})],1),a("div",{staticClass:"time-slot-item"},[a("label",{staticStyle:{width:"120px","margin-top":"3px"}},[e._v("sql断言轮询时间:")]),a("a-input",{attrs:{placeholder:"秒",size:"small"},model:{value:e.data.timeSlot.sqlPollingTime,callback:function(t){e.$set(e.data.timeSlot,"sqlPollingTime",t)},expression:"data.timeSlot.sqlPollingTime"}})],1)])]),a("a-tab-pane",{key:"other",attrs:{tab:(e.otherNum,"Other"+e.otherNum),size:"small"}},[a("div",[a("label",{staticStyle:{display:"inline-block",width:"180px","margin-top":"3px"}},[e._v("在数据驱动中循环执行:")]),a("a-radio-group",{staticStyle:{margin:"5px"},model:{value:e.data.isDataDriver,callback:function(t){e.$set(e.data,"isDataDriver",t)},expression:"data.isDataDriver"}},[a("a-radio",{attrs:{value:0}},[e._v("是")]),a("a-radio",{attrs:{value:1}},[e._v("否")])],1)],1)])],1)],1):e._e()},at=[],it={props:{hintKeyWords:{type:Array,default:function(){return[]}},autocompleteTables:{type:Object,default:function(){return{}}}},computed:Object(l["a"])({},Object(d["b"])({isSaveApi:function(e){return e.api.isSaveApi},selectOp:function(e){return e.api.currentOp}})),watch:{isSaveApi:function(){"saveSql"===this.isSaveApi&&this.ok()},"selectOp.id":function(){this.queryNodeById()},data:{handler:function(e,t){this.isAutoSave?this.autoSave(e,t):this.isAutoSave=!0},deep:!0}},data:function(){return{data:{},visible:!1,activeKey:"assert",assertNum:"",waitingNum:"",otherNum:"",sqlCodeMirrorParam:null,codeMirrorParam:null,sqlAssertTypes:[{id:1,name:"结果集不为空"},{id:2,name:"结果集为空"}],initialSqlData:null,isAutoSave:!1}},mounted:function(){this.queryNodeById()},methods:{autoSave:_.debounce((function(e,t){e&&t&&e.id===t.id&&this.ok()}),1e3),ok:function(){var e=this,t={id:this.selectOp.id,typeTag:"sql"},a={sql:this.data.sql,assertExpectMap:this.data.assertExpectMap,assertUnexpectMap:1,assertSql:this.data.assertSql,sqlAssertType:this.data.sqlAssertType,sqlExpect:this.data.sqlExpect,timeSlot:JSON.stringify(this.data.timeSlot),isDataDriver:this.data.isDataDriver,versionId:this.selectOp.versionId};Object(m["Q"])(t,a).then((function(t){t.status||e.$store.dispatch("setSaveTime",(new Date).getTime())})).catch(),this.$store.dispatch("setIsSaveApi",""),this.initialSqlData=Object(l["a"])({},this.data)},checkOpChanged:function(){var e=Object(ue["h"])(this.initialSqlData),t=Object(ue["h"])(this.data);return JSON.stringify(e)!==JSON.stringify(t)},initCodeMirror:function(){var e=this;setTimeout((function(){if(!e.codeMirrorParam){var t="paramCodeViewSql".concat(e.selectOp.id);e.codeMirrorParam=ze()(document.getElementById(t),{mode:"text/x-mysql",indentWithTabs:!0,lineWrapping:!0,smartIndent:!1,lineNumbers:!0,matchBrackets:!0,autofocus:!1,completeSingle:!1,width:"100%",gutters:["CodeMirror-linenumbers"],extraKeys:{Tab:"autocomplete"}}),e.codeMirrorParam.on("keyup",(function(){e.data.sqlExpect=e.codeMirrorParam.getDoc().getValue()})),e.codeMirrorParam.on("keyup",(function(t,a){[52].indexOf(a.keyCode)>-1&&a.shiftKey&&ze.a.showHint(t,ze.a.hint.sql,{completeSingle:!1,tables:e.autocompleteTables})})),e.codeMirrorParam.setSize("auto","200px")}e.codeMirrorParam.setValue(e.data.sqlExpect)}),100)},initSqlCodeMirror:function(){var e=this;setTimeout((function(){if(!e.sqlCodeMirrorParam){var t="sqlEditor".concat(e.selectOp.id);e.sqlCodeMirrorParam=ze()(document.getElementById(t),{mode:"text/x-mysql",indentWithTabs:!0,lineWrapping:!0,smartIndent:!1,lineNumbers:!0,matchBrackets:!0,autofocus:!1,completeSingle:!1,width:"100%",gutters:["CodeMirror-linenumbers"],extraKeys:{Tab:"autocomplete"}}),e.sqlCodeMirrorParam.on("keyup",(function(){e.data.sql=e.sqlCodeMirrorParam.getDoc().getValue()})),e.sqlCodeMirrorParam.on("keyup",(function(t,a){[52].indexOf(a.keyCode)>-1&&a.shiftKey&&ze.a.showHint(t,ze.a.hint.sql,{completeSingle:!1,tables:e.autocompleteTables})})),e.sqlCodeMirrorParam.setSize("auto","200px")}e.sqlCodeMirrorParam.setValue(e.data.sql)}),100)},changesqlAssertType:function(e){this.data.sqlAssertType=e},assertSqlChange:function(e){this.data.assertSql=e.target.checked?0:1,this.initCodeMirror()},queryNodeById:function(){var e=this;Object(m["F"])({id:this.selectOp.id,typeTag:this.selectOp.type,versionId:this.selectOp.versionId}).then((function(t){t.status||(e.data=Object(l["a"])({},t.data),null==e.data.timeSlot||""===e.data.timeSlot?e.data.timeSlot={before:"",after:""}:e.data.timeSlot=JSON.parse(e.data.timeSlot),e.initSqlCodeMirror(),0===e.data.assertSql&&e.initCodeMirror(),e.initialSqlData=Object(l["a"])({},e.data),e.visible=!0)})).catch((function(e){}))}}},st=it,nt=(a("cb7d"),Object($["a"])(st,tt,at,!1,null,"41b19de6",null)),ot=nt.exports,rt=function(){var e=this,t=e.$createElement,a=e._self._c||t;return e.data?a("div",[a("a-input-group",{staticStyle:{marginBottom:"10px"},attrs:{compact:""}},[a("span",{staticStyle:{width:"10%",margin:"5px","font-size":"10px"}},[e._v("类型:")]),a("a-select",{staticStyle:{width:"20%"},on:{change:function(t){return e.changeRedisParams(e.data.method)}},model:{value:e.data.method,callback:function(t){e.$set(e.data,"method",t)},expression:"data.method"}},e._l(e.redisConf,(function(t){return a("a-select-option",{key:t.id},[e._v(" "+e._s(t.method)+" ")])})),1),e._l(e.redisSelected.params,(function(t,i){return a("a-input",{key:i,staticStyle:{width:"20%"},attrs:{placeholder:t.name},model:{value:e.data.params[i],callback:function(t){e.$set(e.data.params,i,t)},expression:"data.params[index]"}})}))],2),a("a-input-group",{staticStyle:{marginBottom:"10px"},attrs:{compact:""}},[a("span",{staticStyle:{width:"10%",margin:"5px","font-size":"10px"}},[e._v("Redis地址:")]),a("a-select",{staticStyle:{width:"80%"},model:{value:e.data.path,callback:function(t){e.$set(e.data,"path",t)},expression:"data.path"}},e._l(e.redises,(function(t){return a("a-select-option",{key:t.id},[e._v(" "+e._s(t.name)+" ")])})),1)],1),a("a-tabs",{attrs:{animated:!1,size:"small"},model:{value:e.activeKey,callback:function(t){e.activeKey=t},expression:"activeKey"}},[a("a-tab-pane",{key:"assert",attrs:{tab:(e.assertNum,"Assert"+e.assertNum),size:"small"}},[a("div",{staticClass:"editor-content"},[a("div",{staticStyle:{"margin-top":"5px"}},[a("a-checkbox",{attrs:{checked:0===e.data.assertExpect},on:{change:e.assertExpectChange}},[e._v(" 包含匹配: ")]),a("hint-text-area",{directives:[{name:"show",rawName:"v-show",value:0===e.data.assertExpect,expression:"data.assertExpect === 0"}],staticStyle:{"margin-top":"5px"},attrs:{placeholder:"支持json, text, 正则匹配, 其中正则匹配规则放在#{}中","hint-key-words":e.hintKeyWords},model:{value:e.data.expectResponse,callback:function(t){e.$set(e.data,"expectResponse",t)},expression:"data.expectResponse"}})],1),a("div",{staticStyle:{"margin-top":"5px"}},[a("a-checkbox",{attrs:{checked:0===e.data.assertExpectJsonSchema},on:{change:e.assertExpectJsonSchemaChange}},[e._v(" JsonSchema匹配: ")]),a("hint-text-area",{directives:[{name:"show",rawName:"v-show",value:0===e.data.assertExpectJsonSchema,expression:"data.assertExpectJsonSchema === 0"}],staticStyle:{"margin-top":"5px"},attrs:{placeholder:"支持json-schema验证","hint-key-words":e.hintKeyWords},model:{value:e.data.expectJsonSchema,callback:function(t){e.$set(e.data,"expectJsonSchema",t)},expression:"data.expectJsonSchema"}})],1),a("div",{staticStyle:{"margin-top":"5px"}},[a("a-checkbox",{attrs:{checked:0===e.data.assertExpectMap},on:{change:e.assertExpectMapChange}},[e._v(" 键值匹配: ")]),e._l(e.data.expectResponseMap,(function(t,i){return a("div",{directives:[{name:"show",rawName:"v-show",value:0===e.data.assertExpectMap,expression:"data.assertExpectMap === 0"}],key:i,staticClass:"key-value-item"},[a("a-input-group",{attrs:{compact:""}},[a("a-input",{staticStyle:{width:"40%"},attrs:{placeholder:"KEY"},on:{click:function(t){return e.clickKeyOrValue(i,e.data.expectResponseMap)}},model:{value:t.key,callback:function(a){e.$set(t,"key",a)},expression:"item.key"}}),a("a-auto-complete",{staticStyle:{width:"50%","border-right-width":"0"},attrs:{"data-source":e.hintList,placeholder:"VALUE"},on:{click:function(t){return e.clickKeyOrValue(i,e.data.expectResponseMap)},search:e.hintKeyWordsSearch,focus:e.hintKeyWordsFocus},model:{value:t.value,callback:function(a){e.$set(t,"value",a)},expression:"item.value"}}),e.data.expectResponseMap.length>1?a("a-button",{attrs:{type:"link",shape:"circle",icon:"close-circle"},on:{click:function(t){return e.removeItem(i,e.data.expectResponseMap)}}}):e._e()],1)],1)})),a("div",{staticStyle:{"margin-top":"5px"}},[a("a-checkbox",{attrs:{checked:0===e.data.assertUnexpectMap},on:{change:e.assertUnexpectMapChange}},[e._v(" 不包含如下键值: ")]),e._l(e.data.unexpectResponseMap,(function(t,i){return a("div",{directives:[{name:"show",rawName:"v-show",value:0===e.data.assertUnexpectMap,expression:"data.assertUnexpectMap === 0"}],key:i,staticClass:"key-value-item"},[a("a-input-group",{attrs:{compact:""}},[a("a-input",{staticStyle:{width:"40%"},attrs:{placeholder:"KEY"},on:{click:function(t){return e.clickKeyOrValue(i,e.data.unexpectResponseMap)}},model:{value:t.key,callback:function(a){e.$set(t,"key",a)},expression:"item.key"}}),a("a-auto-complete",{staticStyle:{width:"50%","border-right-width":"0"},attrs:{"data-source":e.hintList,placeholder:"VALUE"},on:{click:function(t){return e.clickKeyOrValue(i,e.data.unexpectResponseMap)},search:e.hintKeyWordsSearch,focus:e.hintKeyWordsFocus},model:{value:t.value,callback:function(a){e.$set(t,"value",a)},expression:"item.value"}}),e.data.unexpectResponseMap.length>1?a("a-button",{attrs:{type:"link",shape:"circle",icon:"close-circle"},on:{click:function(t){return e.removeItem(i,e.data.unexpectResponseMap)}}}):e._e()],1)],1)}))],2)],2)])]),a("a-tab-pane",{key:"other",attrs:{tab:(e.otherNum,"Other"+e.otherNum),size:"small"}},[a("div",[a("label",{staticStyle:{display:"inline-block",width:"180px","margin-top":"3px"}},[e._v("在数据驱动中循环执行:")]),a("a-radio-group",{staticStyle:{margin:"5px"},model:{value:e.data.isDataDriver,callback:function(t){e.$set(e.data,"isDataDriver",t)},expression:"data.isDataDriver"}},[a("a-radio",{attrs:{value:0}},[e._v("是")]),a("a-radio",{attrs:{value:1}},[e._v("否")])],1)],1)])],1)],1):e._e()},ct=[],lt=(a("4de4"),{props:{hintKeyWords:{type:Array,default:function(){return[]}}},computed:Object(l["a"])({},Object(d["b"])({isSaveApi:function(e){return e.api.isSaveApi},selectOp:function(e){return e.api.currentOp}})),components:{hintTextArea:Ye},watch:{isSaveApi:function(){"saveRedis"===this.isSaveApi&&this.ok()},"selectOp.id":function(){this.queryNodeById()},data:{handler:function(e,t){this.isAutoSave?this.autoSave(e,t):this.isAutoSave=!0},deep:!0}},data:function(){return{data:null,activeKey:"assert",assertNum:"",otherNum:"",redisConf:null,redises:null,hintList:[],initialRedisData:null,isAutoSave:!1}},mounted:function(){this.queryNodeById()},methods:{autoSave:_.debounce((function(e,t){e&&t&&e.id===t.id&&this.ok()}),1e3),ok:function(){var e=this,t={id:this.selectOp.id,typeTag:"redis"},a={method:this.data.method,params:JSON.stringify(this.data.params),path:this.data.path+"",assertExpect:this.data.assertExpect,assertExpectJsonSchema:this.data.assertExpectJsonSchema,assertExpectMap:this.data.assertExpectMap,assertUnexpectMap:this.data.assertUnexpectMap,expectResponse:this.data.expectResponse,expectJsonSchema:this.data.expectJsonSchema,expectResponseMap:JSON.stringify(Object(ue["a"])(this.data.expectResponseMap)),unexpectResponseMap:JSON.stringify(Object(ue["a"])(this.data.unexpectResponseMap)),timeSlot:JSON.stringify(this.data.timeSlot),isDataDriver:this.data.isDataDriver,versionId:this.selectOp.versionId};Object(m["Q"])(t,a).then((function(t){t.status||e.$store.dispatch("setSaveTime",(new Date).getTime())})).catch(),this.$store.dispatch("setIsSaveApi",""),this.initialRedisData=Object(l["a"])({},this.data)},checkOpChanged:function(){var e=Object(ue["h"])(this.initialRedisData),t=Object(ue["h"])(this.data);return JSON.stringify(e)!==JSON.stringify(t)},hintKeyWordsSearch:function(e){this.hintList=e?this.hintKeyWords.filter((function(t){var a=t.toLowerCase(),i=e.toLowerCase();return-1!==a.indexOf(i)})):this.hintKeyWords||[]},hintKeyWordsFocus:function(){this.hintList=this.hintKeyWords.map((function(e){return"$"+e}))||[]},removeItem:function(e,t){t.splice(e,1)},clickKeyOrValue:function(e,t){e===t.length-1&&t.push({key:"",value:""})},assertUnexpectMapChange:function(e){this.data.assertUnexpectMap=e.target.checked?0:1},assertExpectMapChange:function(e){this.data.assertExpectMap=e.target.checked?0:1},assertExpectJsonSchemaChange:function(e){this.data.assertExpectJsonSchema=e.target.checked?0:1},assertExpectChange:function(e){this.data.assertExpect=e.target.checked?0:1},changeRedisParams:function(e){this.redisSelected=this.getRedisFromRedisConfByMethod(e)||{},this.data.params=[]},getRedisConf:function(){var e=this;Object(m["m"])({}).then((function(t){t.status||(e.redisConf=t.data)})).catch((function(e){}))},getRedises:function(){var e=this;Object(m["u"])(this.$route.query.productId).then((function(t){t.status||(e.redises=t.data||[],e.redises.unshift({id:-1,name:"无"}))})).catch((function(e){}))},getRedisFromRedisConfByMethod:function(e){this.redisConf=this.redisConf||[];for(var t=this.redisConf.length,a=0;a<t;a++)if(+this.redisConf[a].id===+e)return this.redisConf[a];return!1},queryNodeById:function(){var e=this;this.getRedisConf(),this.getRedises(),Object(m["F"])({id:this.selectOp.id,typeTag:this.selectOp.type,versionId:this.selectOp.versionId}).then((function(t){if(!t.status){var a={key:"",value:""};e.data=Object(l["a"])({},t.data),e.data.params=JSON.parse(e.data.params||"[]"),e.data.path=+e.data.path,e.data.expectResponseMap=Object(ue["g"])(e.data.expectResponseMap,[Object(l["a"])({},a)]),e.data.unexpectResponseMap=Object(ue["g"])(e.data.unexpectResponseMap,[Object(l["a"])({},a)]),null==e.data.timeSlot||""===e.data.timeSlot?e.data.timeSlot={before:"",after:""}:e.data.timeSlot=JSON.parse(e.data.timeSlot),e.redisSelected=e.getRedisFromRedisConfByMethod(e.data.method)||{},console.log(e.redisSelected,374),e.initialRedisData=Object(l["a"])({},e.data)}})).catch((function(e){}))}}}),dt=lt,ut=(a("53ca1"),Object($["a"])(dt,rt,ct,!1,null,"470e7e38",null)),pt=ut.exports,ht=function(){var e=this,t=e.$createElement,a=e._self._c||t;return e.data?a("div",[a("a-select",{staticStyle:{width:"100%",marginBottom:"10px"},on:{change:e.changePath},model:{value:e.shellPathValue,callback:function(t){e.shellPathValue=t},expression:"shellPathValue"}},e._l(e.servers,(function(t){return a("a-select-option",{key:t.id},[e._v(" "+e._s(t.name+"("+t.username+"@"+t.address+")")+" ")])})),1),a("div",{staticStyle:{marginBottom:"10px"},attrs:{id:"shellEditor"+e.selectOp.id}}),a("a-tabs",{attrs:{animated:!1,size:"small"},model:{value:e.activeKey,callback:function(t){e.activeKey=t},expression:"activeKey"}},[a("a-tab-pane",{key:"assert",attrs:{tab:(e.assertNum,"Assert"+e.assertNum),size:"small"}},[a("div",{staticClass:"editor-content",staticStyle:{"margin-top":"5px"}},[a("a-checkbox",{attrs:{checked:0===e.data.assertExpectMap},on:{change:e.assertExpectMapChange}},[e._v(" 匹配返回状态码: ")]),e._l(e.data.expectResponseMap,(function(t,i){return a("div",{directives:[{name:"show",rawName:"v-show",value:0===e.data.assertExpectMap,expression:"data.assertExpectMap === 0"}],key:i,staticClass:"key-value-item",staticStyle:{marginTop:"10px"}},[a("a-input-group",{attrs:{compact:""}},[a("input",{directives:[{name:"model",rawName:"v-model",value:t.key,expression:"item.key"}],staticStyle:{width:"40%"},attrs:{placeholder:"KEY"},domProps:{value:t.key},on:{click:function(t){return e.clickKeyOrValue(i,e.data.expectResponseMap)},input:function(a){a.target.composing||e.$set(t,"key",a.target.value)}}}),a("input",{directives:[{name:"model",rawName:"v-model",value:t.value,expression:"item.value"}],staticStyle:{width:"50%","border-right-width":"0"},attrs:{placeholder:"VALUE"},domProps:{value:t.value},on:{click:function(t){return e.clickKeyOrValue(i,e.data.expectResponseMap)},input:function(a){a.target.composing||e.$set(t,"value",a.target.value)}}}),a("a-button",{directives:[{name:"show",rawName:"v-show",value:e.data.expectResponseMap.length>1,expression:"data.expectResponseMap.length > 1"}],attrs:{type:"link",shape:"circle",icon:"close-circle"},on:{click:function(t){return e.removeItem(i,e.data.expectResponseMap)}}})],1)],1)}))],2)]),a("a-tab-pane",{key:"waitTime",attrs:{tab:(e.waitingNum,"WaitTime"+e.waitingNum),size:"small"}},[a("div",{staticStyle:{"margin-top":"5px"}},[a("div",{staticClass:"time-slot-item"},[a("label",{staticStyle:{width:"120px","margin-top":"3px"}},[e._v("执行前：")]),a("a-input",{attrs:{placeholder:"秒",size:"small"},model:{value:e.data.timeSlot.before,callback:function(t){e.$set(e.data.timeSlot,"before",t)},expression:"data.timeSlot.before"}})],1),a("div",{staticClass:"time-slot-item"},[a("label",{staticStyle:{width:"120px","margin-top":"3px"}},[e._v("执行后:")]),a("a-input",{attrs:{placeholder:"秒",size:"small"},model:{value:e.data.timeSlot.after,callback:function(t){e.$set(e.data.timeSlot,"after",t)},expression:"data.timeSlot.after"}})],1)])]),a("a-tab-pane",{key:"other",attrs:{tab:(e.otherNum,"Other"+e.otherNum),size:"small"}},[a("div",[a("label",{staticStyle:{display:"inline-block",width:"180px","margin-top":"3px"}},[e._v("在数据驱动中循环执行:")]),a("a-radio-group",{staticStyle:{margin:"5px"},model:{value:e.data.isDataDriver,callback:function(t){e.$set(e.data,"isDataDriver",t)},expression:"data.isDataDriver"}},[a("a-radio",{attrs:{value:0}},[e._v("是")]),a("a-radio",{attrs:{value:1}},[e._v("否")])],1)],1)])],1)],1):e._e()},ft=[],mt={props:{hintKeyWords:{type:Array,default:function(){return[]}},autocompleteTables:{type:Object,default:function(){return{}}}},computed:Object(l["a"])({},Object(d["b"])({isSaveApi:function(e){return e.api.isSaveApi},selectOp:function(e){return e.api.currentOp}})),watch:{isSaveApi:function(){"saveShell"===this.isSaveApi&&this.ok()},"selectOp.id":function(){this.queryNodeById()},data:{handler:function(e,t){this.isAutoSave?this.autoSave(e,t):this.isAutoSave=!0},deep:!0}},data:function(){return{data:null,activeKey:"assert",assertNum:"",otherNum:"",waitingNum:"",servers:null,codeMirrorParam:null,shellPathValue:"",initialShellData:null,isAutoSave:!1}},mounted:function(){this.queryNodeById()},methods:{autoSave:_.debounce((function(e,t){e&&t&&e.id===t.id&&this.ok()}),1e3),ok:function(){var e=this;this.initialShellData=Object(l["a"])({},this.data),1===this.data.expectResponseMap.length&&(this.data.expectResponseMap[0].key="exitCode");var t={id:this.selectOp.id,typeTag:"shell"},a={path:this.data.path+"",body:this.data.body,assertExpectMap:this.data.assertExpectMap,expectResponseMap:JSON.stringify(Object(ue["a"])(this.data.expectResponseMap)),timeSlot:JSON.stringify(this.data.timeSlot),isDataDriver:this.data.isDataDriver,versionId:this.selectOp.versionId};Object(m["Q"])(t,a).then((function(t){t.status||e.$store.dispatch("setSaveTime",(new Date).getTime())})).catch(),this.$store.dispatch("setIsSaveApi","")},checkOpChanged:function(){var e=Object(ue["h"])(this.initialShellData),t=Object(ue["h"])(this.data);return JSON.stringify(e)!==JSON.stringify(t)},clickKeyOrValue:function(e,t){e===t.length-1&&t.push({key:"",value:""})},removeItem:function(e,t){t.splice(e,1)},initCodeMirror:function(){var e=this;setTimeout((function(){if(!e.codeMirrorParam){var t="shellEditor".concat(e.selectOp.id);e.codeMirrorParam=ze()(document.getElementById(t),{mode:"text/x-mysql",indentWithTabs:!0,lineWrapping:!0,smartIndent:!1,lineNumbers:!0,matchBrackets:!0,autofocus:!1,completeSingle:!1,width:"100%",gutters:["CodeMirror-linenumbers"],extraKeys:{Tab:"autocomplete"}}),e.codeMirrorParam.on("keyup",(function(){e.data.body=e.codeMirrorParam.getDoc().getValue()})),e.codeMirrorParam.on("keyup",(function(t,a){[52].indexOf(a.keyCode)>-1&&a.shiftKey&&ze.a.showHint(t,ze.a.hint.sql,{completeSingle:!1,tables:e.autocompleteTables})})),e.codeMirrorParam.setSize("auto","200px")}e.codeMirrorParam.setValue(e.data.body)}),100)},assertExpectMapChange:function(e){this.data.assertExpectMap=e.target.checked?0:1},getServers:function(){var e=this;return Object(o["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,Object(m["v"])(e.$route.query.productId).then((function(t){t.status||(e.servers=t.data||[],e.shellPathValue=e.getShellPath(e.data.path))})).catch((function(e){}));case 2:case"end":return t.stop()}}),t)})))()},getShellPath:function(e){for(var t=0;t<this.servers.length;t++)if(+this.servers[t].id===+e)return"".concat(this.servers[t].name,"(").concat(this.servers[t].username,"@").concat(this.servers[t].address,")")},changePath:function(e){this.data.path=e},queryNodeById:function(){var e=this;Object(m["F"])({id:this.selectOp.id,typeTag:this.selectOp.type,versionId:this.selectOp.versionId}).then((function(t){if(!t.status){var a={key:"",value:""};e.data=Object(l["a"])({},t.data),e.getServers(),e.data.params=JSON.parse(e.data.params||"[]"),e.data.expectResponseMap=Object(ue["g"])(e.data.expectResponseMap,[Object(l["a"])({},a)]),e.data.unexpectResponseMap=Object(ue["g"])(e.data.unexpectResponseMap,[Object(l["a"])({},a)]),null==e.data.timeSlot||""===e.data.timeSlot?e.data.timeSlot={before:"",after:""}:e.data.timeSlot=JSON.parse(e.data.timeSlot),e.initCodeMirror(),e.initialShellData=Object(l["a"])({},e.data)}})).catch((function(e){}))}}},yt=mt,vt=(a("e0d7"),Object($["a"])(yt,ht,ft,!1,null,"46c2e4a3",null)),gt=vt.exports,bt=function(){var e=this,t=e.$createElement,a=e._self._c||t;return e.data?a("div",[a("a-select",{staticStyle:{width:"100%",marginBottom:"10px"},model:{value:e.data.path,callback:function(t){e.$set(e.data,"path",t)},expression:"data.path"}},e._l(e.mongos,(function(t){return a("a-select-option",{key:t.id},[e._v(" "+e._s(t.name)+" ")])})),1),a("div",{staticStyle:{marginBottom:"10px"},attrs:{id:"shellEditor"+e.selectOp.id}}),a("a-tabs",{attrs:{animated:!1,size:"small"},model:{value:e.activeKey,callback:function(t){e.activeKey=t},expression:"activeKey"}},[a("a-tab-pane",{key:"assert",attrs:{tab:(e.assertNum,"Assert"+e.assertNum),size:"small"}},[a("div",{staticClass:"editor-content"},[a("div",{staticStyle:{"margin-top":"5px"}},[a("a-checkbox",{attrs:{checked:0===e.data.assertExpect},on:{change:e.assertExpectChange}},[e._v(" 包含匹配: ")]),a("hint-text-area",{directives:[{name:"show",rawName:"v-show",value:0===e.data.assertExpect,expression:"data.assertExpect === 0"}],staticStyle:{"margin-top":"5px"},attrs:{placeholder:"支持json, text, 正则匹配, 其中正则匹配规则放在#{}中","hint-key-words":e.hintKeyWords},model:{value:e.data.expectResponse,callback:function(t){e.$set(e.data,"expectResponse",t)},expression:"data.expectResponse"}})],1),a("div",{staticStyle:{"margin-top":"5px"}},[a("a-checkbox",{attrs:{checked:0===e.data.assertExpectJsonSchema},on:{change:e.assertExpectJsonSchemaChange}},[e._v(" JsonSchema匹配: ")]),a("hint-text-area",{directives:[{name:"show",rawName:"v-show",value:0===e.data.assertExpectJsonSchema,expression:"data.assertExpectJsonSchema === 0"}],staticStyle:{"margin-top":"5px"},attrs:{placeholder:"支持json-schema验证","hint-key-words":e.hintKeyWords},model:{value:e.data.expectJsonSchema,callback:function(t){e.$set(e.data,"expectJsonSchema",t)},expression:"data.expectJsonSchema"}})],1),a("div",{staticStyle:{"margin-top":"5px"}},[a("a-checkbox",{attrs:{checked:0===e.data.assertExpectMap},on:{change:e.assertExpectMapChange}},[e._v(" 键值匹配: ")]),e._l(e.data.expectResponseMap,(function(t,i){return a("div",{directives:[{name:"show",rawName:"v-show",value:0===e.data.assertExpectMap,expression:"data.assertExpectMap === 0"}],key:i,staticClass:"key-value-item"},[a("a-input-group",{attrs:{compact:""}},[a("a-input",{staticStyle:{width:"40%"},attrs:{placeholder:"KEY"},on:{click:function(t){return e.clickKeyOrValue(i,e.data.expectResponseMap)}},model:{value:t.key,callback:function(a){e.$set(t,"key",a)},expression:"item.key"}}),a("a-auto-complete",{staticStyle:{width:"50%","border-right-width":"0"},attrs:{"data-source":e.hintList,placeholder:"VALUE"},on:{click:function(t){return e.clickKeyOrValue(i,e.data.expectResponseMap)},search:e.hintKeyWordsSearch,focus:e.hintKeyWordsFocus},model:{value:t.value,callback:function(a){e.$set(t,"value",a)},expression:"item.value"}}),e.data.expectResponseMap.length>1?a("a-button",{attrs:{type:"link",shape:"circle",icon:"close-circle"},on:{click:function(t){return e.removeItem(i,e.data.expectResponseMap)}}}):e._e()],1)],1)})),a("div",{staticStyle:{"margin-top":"5px"}},[a("a-checkbox",{attrs:{checked:0===e.data.assertUnexpectMap},on:{change:e.assertUnexpectMapChange}},[e._v(" 排除匹配: ")]),e._l(e.data.unexpectResponseMap,(function(t,i){return a("div",{directives:[{name:"show",rawName:"v-show",value:0===e.data.assertUnexpectMap,expression:"data.assertUnexpectMap === 0"}],key:i,staticClass:"key-value-item"},[a("a-input-group",{attrs:{compact:""}},[a("a-input",{staticStyle:{width:"40%"},attrs:{placeholder:"KEY"},on:{click:function(t){return e.clickKeyOrValue(i,e.data.unexpectResponseMap)}},model:{value:t.key,callback:function(a){e.$set(t,"key",a)},expression:"item.key"}}),a("a-auto-complete",{staticStyle:{width:"50%","border-right-width":"0"},attrs:{"data-source":e.hintList,placeholder:"VALUE"},on:{click:function(t){return e.clickKeyOrValue(i,e.data.unexpectResponseMap)},search:e.hintKeyWordsSearch,focus:e.hintKeyWordsFocus},model:{value:t.value,callback:function(a){e.$set(t,"value",a)},expression:"item.value"}}),e.data.unexpectResponseMap.length>1?a("a-button",{attrs:{type:"link",shape:"circle",icon:"close-circle"},on:{click:function(t){return e.removeItem(i,e.data.unexpectResponseMap)}}}):e._e()],1)],1)}))],2)],2)])]),a("a-tab-pane",{key:"waitTime",attrs:{tab:(e.waitingNum,"WaitTime"+e.waitingNum),size:"small"}},[a("div",{staticStyle:{"margin-top":"5px"}},[a("div",{staticClass:"time-slot-item"},[a("label",{staticStyle:{width:"120px","margin-top":"3px"}},[e._v("执行前：")]),a("a-input",{attrs:{placeholder:"秒",size:"small"},model:{value:e.data.timeSlot.before,callback:function(t){e.$set(e.data.timeSlot,"before",t)},expression:"data.timeSlot.before"}})],1),a("div",{staticClass:"time-slot-item"},[a("label",{staticStyle:{width:"120px","margin-top":"3px"}},[e._v("执行后:")]),a("a-input",{attrs:{placeholder:"秒",size:"small"},model:{value:e.data.timeSlot.after,callback:function(t){e.$set(e.data.timeSlot,"after",t)},expression:"data.timeSlot.after"}})],1)])]),a("a-tab-pane",{key:"other",attrs:{tab:(e.otherNum,"Other"+e.otherNum),size:"small"}},[a("div",[a("label",{staticStyle:{display:"inline-block",width:"180px","margin-top":"3px"}},[e._v("在数据驱动中循环执行:")]),a("a-radio-group",{staticStyle:{margin:"5px"},model:{value:e.data.isDataDriver,callback:function(t){e.$set(e.data,"isDataDriver",t)},expression:"data.isDataDriver"}},[a("a-radio",{attrs:{value:0}},[e._v("是")]),a("a-radio",{attrs:{value:1}},[e._v("否")])],1)],1)])],1)],1):e._e()},St=[],kt={components:{hintTextArea:Ye},props:{hintKeyWords:{type:Array,default:function(){return[]}},autocompleteTables:{type:Object,default:function(){return{}}}},computed:Object(l["a"])({},Object(d["b"])({isSaveApi:function(e){return e.api.isSaveApi},selectOp:function(e){return e.api.currentOp}})),watch:{isSaveApi:function(){"saveMongo"===this.isSaveApi&&this.ok()},"selectOp.id":function(){this.queryNodeById()},data:{handler:function(e,t){this.isAutoSave?this.autoSave(e,t):this.isAutoSave=!0},deep:!0}},data:function(){return{data:null,activeKey:"assert",assertNum:"",otherNum:"",waitingNum:"",mongos:[],codeMirrorParam:null,hintList:[],initialMongoData:null,isAutoSave:!1}},mounted:function(){this.queryNodeById()},methods:{autoSave:_.debounce((function(e,t){e&&t&&e.id===t.id&&this.ok()}),1e3),ok:function(){var e=this,t={id:this.selectOp.id,typeTag:"mongo"},a={sql:this.data.sql,path:this.data.path+"",assertExpect:this.data.assertExpect,assertExpectJsonSchema:this.data.assertExpectJsonSchema,assertExpectMap:this.data.assertExpectMap,assertUnexpectMap:this.data.assertUnexpectMap,expectResponse:this.data.expectResponse,expectJsonSchema:this.data.expectJsonSchema,expectResponseMap:JSON.stringify(Object(ue["a"])(this.data.expectResponseMap)),unexpectResponseMap:JSON.stringify(Object(ue["a"])(this.data.unexpectResponseMap)),timeSlot:JSON.stringify(this.data.timeSlot),isDataDriver:this.data.isDataDriver,versionId:this.selectOp.versionId};Object(m["Q"])(t,a).then((function(t){t.status||e.$store.dispatch("setSaveTime",(new Date).getTime())})).catch(),this.$store.dispatch("setIsSaveApi",""),this.initialMongoData=Object(l["a"])({},this.data)},checkOpChanged:function(){var e=Object(ue["h"])(this.initialMongoData),t=Object(ue["h"])(this.data);return JSON.stringify(e)!==JSON.stringify(t)},hintKeyWordsSearch:function(e){this.hintList=e?this.hintKeyWords.filter((function(t){var a=t.toLowerCase(),i=e.toLowerCase();return-1!==a.indexOf(i)})):this.hintKeyWords||[]},hintKeyWordsFocus:function(){this.hintList=this.hintKeyWords.map((function(e){return"$"+e}))||[]},clickKeyOrValue:function(e,t){e===t.length-1&&t.push({key:"",value:""})},removeItem:function(e,t){t.splice(e,1)},initCodeMirror:function(){var e=this;setTimeout((function(){if(!e.codeMirrorParam){var t="shellEditor".concat(e.selectOp.id);e.codeMirrorParam=ze()(document.getElementById(t),{mode:"text/x-mysql",indentWithTabs:!0,lineWrapping:!0,smartIndent:!1,lineNumbers:!0,matchBrackets:!0,autofocus:!1,completeSingle:!1,width:"100%",gutters:["CodeMirror-linenumbers"],extraKeys:{Tab:"autocomplete"}}),e.codeMirrorParam.on("keyup",(function(){e.data.sql=e.codeMirrorParam.getDoc().getValue()})),e.codeMirrorParam.on("keyup",(function(t,a){[52].indexOf(a.keyCode)>-1&&a.shiftKey&&ze.a.showHint(t,ze.a.hint.sql,{completeSingle:!1,tables:e.autocompleteTables})})),e.codeMirrorParam.setSize("auto","200px")}e.codeMirrorParam.setValue(e.data.sql)}),100)},assertUnexpectMapChange:function(e){this.data.assertUnexpectMap=e.target.checked?0:1},assertExpectJsonSchemaChange:function(e){this.data.assertExpectJsonSchema=e.target.checked?0:1},assertExpectMapChange:function(e){this.data.assertExpectMap=e.target.checked?0:1},getMongo:function(){var e=this;Object(m["s"])(this.$route.query.productId).then((function(t){t.status||(e.mongos=t.data||[],e.mongos.unshift({id:-1,name:"无"}))})).catch()},assertExpectChange:function(e){this.data.assertExpect=e.target.checked?0:1},queryNodeById:function(){var e=this;this.getMongo(),Object(m["F"])({id:this.selectOp.id,typeTag:this.selectOp.type,versionId:this.selectOp.versionId}).then((function(t){if(!t.status){var a={key:"",value:""};e.data=Object(l["a"])({},t.data),e.data.params=JSON.parse(e.data.params||"[]"),e.data.path=+e.data.path||"",e.data.expectResponseMap=Object(ue["g"])(e.data.expectResponseMap,[Object(l["a"])({},a)]),e.data.unexpectResponseMap=Object(ue["g"])(e.data.unexpectResponseMap,[Object(l["a"])({},a)]),null==e.data.timeSlot||""===e.data.timeSlot?e.data.timeSlot={before:"",after:""}:e.data.timeSlot=JSON.parse(e.data.timeSlot),e.initCodeMirror(),e.initialMongoData=Object(l["a"])({},e.data)}})).catch((function(e){}))}}},xt=kt,wt=(a("0376"),Object($["a"])(xt,bt,St,!1,null,"2437db0e",null)),Tt=wt.exports,Ct=a("30dd"),_t=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("a-modal",{staticStyle:{position:"relative"},attrs:{title:e.pageTitle,width:1e3,"body-style":{height:"500px",overflow:"auto"},visible:e.visible,"confirm-loading":e.confirmLoading,"ok-text":"确认","cancel-text":"取消"},on:{ok:e.handleOk,cancel:e.handleCancel}},["2"===e.copyParams.simpleCopy?a("div",{staticStyle:{display:"flex"}},[e.externalProductList.length?a("div",{staticStyle:{flex:"1"}},[a("span",[e._v("选择权限项目：")]),a("a-select",{staticStyle:{width:"200px"},attrs:{"default-value":e.externalProductList[0]._id},on:{change:e.hanldYapiProduct}},e._l(e.externalProductList,(function(t){return a("a-select-option",{key:t._id,attrs:{value:t._id}},[e._v(" "+e._s(t.name)+" ")])})),1)],1):e._e(),a("div",[a("span",[e._v("智能生成:")]),a("a-switch",{staticStyle:{margin:"5px 10px"},attrs:{"checked-children":"使用","un-checked-children":"不使用"},on:{change:e.psstGenSwitch},model:{value:e.psstGen,callback:function(t){e.psstGen=t},expression:"psstGen"}}),a("a-dropdown",{attrs:{trigger:["click"]}},[a("a",{on:{click:function(e){return e.preventDefault()}}},[a("span",[e._v(e._s(e.currentMenuName))]),e._v(" 选择分类 "),a("a-icon",{attrs:{type:"down"}})],1),a("a-menu",{staticStyle:{"max-height":"400px",overflow:"auto"},attrs:{slot:"overlay"},on:{click:e.changeMenu},slot:"overlay"},[a("a-menu-item",{key:"-1"},[e._v(" 所有 ")]),e._l(e.menuList,(function(t){return[a("a-menu-item",{key:t._id},[e._v(" "+e._s(t.name)+" ")])]}))],2)],1)],1)]):e._e(),e.selectRowFlag?a("div",[a("span",{staticStyle:{color:"red"}},[e._v("请选中表格中一行进行复制")])]):e._e(),"0"===e.copyParams.simpleCopy?a("a-table",{staticStyle:{"margin-top":"10px"},attrs:{size:"middle","row-key":function(e){return e.id},columns:e.apiTableCol,"data-source":e.tableData,pagination:e.tableData.length>8&&{pageSize:8},"row-selection":e.rowSelection,"custom-row":e.customRowApi},scopedSlots:e._u([{key:"filterDropdown",fn:function(t){var i=t.setSelectedKeys,s=t.selectedKeys,n=t.confirm,o=t.clearFilters,r=t.column;return a("div",{staticStyle:{padding:"8px"}},[a("a-input",{directives:[{name:"ant-ref",rawName:"v-ant-ref",value:function(t){return e.searchInput=t},expression:"c => (searchInput = c)"}],staticStyle:{width:"188px","margin-bottom":"8px",display:"block"},attrs:{placeholder:"请输入模板名称！",value:s[0]},on:{change:function(e){return i(e.target.value?[e.target.value]:[])},pressEnter:function(){return e.handleSearch(s,n,r.dataIndex)}}}),a("a-button",{staticStyle:{width:"90px","margin-right":"8px"},attrs:{type:"primary",icon:"search",size:"small"},on:{click:function(){return e.handleSearch(s,n,r.dataIndex)}}},[e._v(" 搜索 ")]),a("a-button",{staticStyle:{width:"90px"},attrs:{size:"small"},on:{click:function(){return e.handleReset(o)}}},[e._v(" 重置 ")])],1)}},{key:"filterIcon",fn:function(e){return a("a-icon",{style:{color:e?"#108ee9":void 0},attrs:{type:"search"}})}}],null,!1,649435066)}):e._e(),"2"===e.copyParams.simpleCopy?a("a-table",{staticStyle:{"margin-top":"10px"},attrs:{size:"middle","row-key":function(e){return e._id},columns:e.yapiTableCol,"data-source":e.ExternalApis,pagination:e.ExternalApis.length>8&&{pageSize:8},"row-selection":e.rowSelection,"custom-row":e.customRow},scopedSlots:e._u([{key:"filterDropdown",fn:function(t){var i=t.setSelectedKeys,s=t.selectedKeys,n=t.confirm,o=t.clearFilters,r=t.column;return a("div",{staticStyle:{padding:"8px"}},[a("a-input",{directives:[{name:"ant-ref",rawName:"v-ant-ref",value:function(t){return e.searchInput=t},expression:"c => (searchInput = c)"}],staticStyle:{width:"188px","margin-bottom":"8px",display:"block"},attrs:{placeholder:"请输入模板名称！",value:s[0]},on:{change:function(e){return i(e.target.value?[e.target.value]:[])},pressEnter:function(){return e.handleSearch(s,n,r.dataIndex)}}}),a("a-button",{staticStyle:{width:"90px","margin-right":"8px"},attrs:{type:"primary",icon:"search",size:"small"},on:{click:function(){return e.handleSearch(s,n,r.dataIndex)}}},[e._v(" 搜索 ")]),a("a-button",{staticStyle:{width:"90px"},attrs:{size:"small"},on:{click:function(){return e.handleReset(o)}}},[e._v(" 重置 ")])],1)}},{key:"filterIcon",fn:function(e){return a("a-icon",{style:{color:e?"#108ee9":void 0},attrs:{type:"search"}})}}],null,!1,649435066)}):e._e()],1)},Nt=[],Ot=a("b588"),It={data:function(){var e=this;return{visible:!1,confirmLoading:!1,pageTitle:"操作的复制",tableData:[],searchInput:null,searchText:"",searchedColumn:"",apiTableCol:[{title:"模板名称",dataIndex:"text",key:"text",width:"30%",scopedSlots:{filterDropdown:"filterDropdown",filterIcon:"filterIcon",customRender:"customRender"},onFilter:function(e,t){return t.text.toString().toLowerCase().includes(e.toLowerCase())},onFilterDropdownVisibleChange:function(t){t&&setTimeout((function(){e.searchInput.focus()}),0)}},{title:"url",dataIndex:"url",key:"url",width:"50%"},{title:"method",dataIndex:"method",key:"method",width:"10%",customRender:function(e,t){return 1===t.protocol?["GET","POST","PUT","DELETE","OPTIONS","HEAD","PATCH"][+e-1]||e:"-"}},{title:"protocol",dataIndex:"protocol",key:"protocol",width:"10%",customRender:function(e,t){return["HTTP","StargateRPC","Dubbo","JsonRPC","Socket"][+e-1]||e}}],yapiTableCol:[{title:"名称",dataIndex:"title",key:"title",width:"20%",scopedSlots:{filterDropdown:"filterDropdown",filterIcon:"filterIcon",customRender:"customRender"},onFilter:function(e,t){return t.text.toString().toLowerCase().includes(e.toLowerCase())},onFilterDropdownVisibleChange:function(t){t&&setTimeout((function(){e.searchInput.focus()}),0)}},{title:"path",dataIndex:"path",key:"path",width:"40%"},{title:"method",dataIndex:"method",key:"method",width:"10%",customRender:function(e,t){return["GET","POST","PUT","DELETE","OPTIONS","HEAD","PATCH"][+e-1]||e}},{title:"status",dataIndex:"status",key:"status",width:"10%",customRender:function(e,t){return"undone"===e?"未完成":"已完成"}},{title:"所属分类",width:"20%",scopedSlots:{customRender:"options"},customRender:function(t,a){return e.isHavaCat?e.rightMenu:"--"}}],selectRow:null,externalProductList:[],copyParams:{},selectProduct:{},menuList:[],isHavaCat:!1,ExternalApis:[],rightMenu:"",psstGen:!1,currentMenuName:"",ExternalApisTemp:[],selectRowFlag:!1,selectedRowKeys:[]}},computed:{rowSelection:function(){var e=this;return{onChange:function(t,a){e.selectRow=a[0],"0"===e.copyParams.simpleCopy?e.selectedRowKeys=[e.selectRow.id]:"1"===e.copyParams.simpleCopy&&(e.selectedRowKeys=[e.selectRow._id])},type:"radio",selectedRowKeys:this.selectedRowKeys}}},watch:{"selectProduct._id":function(){this.selectProduct&&(this.selectProduct.hasOwnProperty("_id")&&this.selectProduct.hasOwnProperty("token")?this.searchCatMenuFromExternal({externalName:"yapi",externalId:this.selectProduct._id}):this.$message.error("id,token参数不全,请联系ITP人工客服"))}},methods:{handleSearch:function(e,t,a){t(),this.searchText=e[0],this.searchedColumn=a},handleReset:function(e){e(),this.searchText=""},customRow:function(e){var t=this;return{on:{click:function(){t.selectRow=e,t.selectedRowKeys=[e._id]}}}},customRowApi:function(e){var t=this;return{on:{click:function(){t.selectRow=e,t.selectedRowKeys=[e.id]}}}},changeMenu:function(e){if("-1"===e.key)return this.ExternalApis=this.ExternalApisTemp,this.currentMenuName="所有",this.isHavaCat=!1,void(this.rightMenu="");for(var t=0;t<this.menuList.length;t++)this.menuList[t]._id===e.key&&(this.currentMenuName=this.menuList[t].name,this.ExternalApis=this.menuList[t].list,this.rightMenu=this.menuList[t].name,this.isHavaCat=!0)},psstGenSwitch:function(e){this.psstGen=e},hanldYapiProduct:function(e){for(var t=0;t<this.externalProductList.length;t++)this.externalProductList[t]._id===e&&(this.selectProduct=this.externalProductList[t])},open:function(e){this.selectedRowKeys=[],this.selectProduct=null,this.selectRowFlag=!1,this.psstGen=!1,this.selectRow=null,this.copyParams=e,this.externalProductList=[],"0"===e.simpleCopy?(this.pageTitle="操作的复制[引用模版]",this.getApiTplList(),this.visible=!0):"2"===e.simpleCopy&&(this.pageTitle="操作的复制[Yapi导入方式]",this.tableData=[],this.queryExternalProductIdWithUser("yapi"))},searchCatMenuFromExternal:function(e){var t=this;return Object(o["a"])(regeneratorRuntime.mark((function a(){return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:return a.next=2,Object(b["t"])(e).then((function(e){if(e.status)t.$message.error(e.message);else{t.visible=!0,t.currentMenuName="所有",t.isHavaCat=!1;var a=e.data;t.menuList=a||[];for(var i=[],s=0;s<t.menuList.length;s++)i=i.concat(t.menuList[s].list);t.ExternalApis=i,t.ExternalApisTemp=t.ExternalApis}})).catch();case 2:case"end":return a.stop()}}),a)})))()},queryExternalProductIdWithUser:function(e){var t=this;return Object(o["a"])(regeneratorRuntime.mark((function a(){return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:return a.next=2,Object(b["p"])(e).then((function(e){e.status?t.$message.error(e.message):(t.externalProductList=e.data,null===t.externalProductList||0===t.getJsonLength(t.externalProductList)?t.$message.warn("在yapi中无任何产品空间权限，请联系yapi用户群（1678960）添加权限后重试"):t.selectProduct=t.externalProductList[0])})).catch();case 2:case"end":return a.stop()}}),a)})))()},getJsonLength:function(e){var t=0;for(var a in e)t++;return t},handleOk:function(){if(this.selectRow){if("0"===this.copyParams.simpleCopy)this.$emit("apiTplcopySuc",this.selectRow);else if("2"===this.copyParams.simpleCopy){var e={row:this.selectRow,pid:this.selectProduct._id,psstGen:this.psstGen};this.$emit("yapicopySuc",e)}this.visible=!1}else this.selectRowFlag=!0},handleCancel:function(){this.visible=!1},getApiTplList:function(){var e=this;return Object(o["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,Object(Ot["l"])({productId:e.$route.query.productId}).then((function(t){t.status?e.$message.error(t.message):e.tableData=t.data})).catch();case 2:case"end":return t.stop()}}),t)})))()}}},$t=It,Dt=Object($["a"])($t,_t,Nt,!1,null,null,null),Et=Dt.exports,Lt={components:{CopyStep:Pe,ApiEditor:et,SqlEditor:ot,RedisEditor:pt,ShellEditor:gt,MongoEditor:Tt,caseResult:Ct["a"],DetectionDlg:ae,CopyOption:Et},data:function(){return{defaultPercent:67,RespEmptyCollapse:!1,stepBoxCollapsed:!0,currentStep:null,selectedOp:null,ops:[],isDouble:!0,hintKeyWords:[],AUTOCOMPLETE_TABLES:{},activeKey:"",activeTab:"result",websocket:null,runCaseResult:[],showRunResult:!1,loadingCaseDetailFinish:!1,logUrl:"http://eplog.baidu-int.com:8091/index.html?owner=itp&logId=",trustUrl:"",data:null,currentSelectOp:null,isNotSave:"",paneLHeight:300,simpleCopy:void 0,beforeCaseRun:void 0,opBoxCollapsed:!1,opMenu:void 0,runCaseResultStatus:void 0,opPasteLastTime:0,opCopyLastTime:0,opXLastTime:0,quickOptionType:void 0,testType:"",timeOut:null}},computed:Object(l["a"])(Object(l["a"])({},Object(d["b"])({currentSelectNode:function(e){return e.treenode.currentSelectTreeNode},steps:function(e){return e.treenode.steps},currentSuite:function(e){return e.treenode.currentSuite},userName:function(e){return e.user.name},versionId:function(e){return e.treenode.versionId},isSaveApi:function(e){return e.api.isSaveApi},saveTime:function(e){return e.api.saveTime}})),{},{scrollerHeight:function(){return this.paneLHeight-50+"px"}}),watch:{steps:function(){this.runCaseResult=[],this.showRunResult=!1,this.steps[0]&&this.selectStep(this.steps[0])},isSaveApi:function(){""===this.isSaveApi&&"run"===this.isNotSave?(this.runCaseFn(),this.isNotSave=""):""===this.isSaveApi&&"changOp"===this.isNotSave&&(this.updateOpDetail(this.currentSelectOp),this.isNotSave="")}},destroyed:function(){k.a.unbind("shift+c"),k.a.unbind("shift+x"),k.a.unbind("shift+v")},mounted:function(){var e=this;k()("shift+c",(function(){return console.log("nodeEditor, shift+c",e.opCopyLastTime,599),0===e.opCopyLastTime||clearTimeout(e.opCopyLastTime),e.opCopyLastTime=setTimeout((function(){e.quickCopyOp(!0)}),1e3),!1})),k()("shift+x",(function(){return console.log("nodeEditor, shift+x",e.opXLastTime,612),0===e.opXLastTime||clearTimeout(e.opXLastTime),e.opXLastTime=setTimeout((function(){e.quickCopyOp(!1)}),1e3),!1})),k()("shift+v",(function(){return console.log("nodeEditor, shift+v",e.opPasteLastTime,625),0===e.opPasteLastTime||clearTimeout(e.opPasteLastTime),e.opPasteLastTime=setTimeout((function(){e.moveOrPasteOp(e.quickOptionType)}),1e3),!1}));var t=window.localStorage.getItem("opMenu")||"";this.opMenu="isKnow"!==t,this.resize(this.defaultPercent)},methods:{autoAssertSaveSuc:function(){this.$refs.apiEditorRef.getFiles()},getAutoSaveMessage:function(){return Object(ue["i"])(this.saveTime)+"自动保存成功"},getLength:function(e){for(var t=0,a=/[\u4e00-\u9fa5]/,i=0;i<e.length;i++)a.test(e[i])?t+=2:t++;return t},quickCopyOp:function(e){window.copyOp=this.selectedOp,this.quickOptionType=e,this.$message.success("复制成功")},opMenuHandle:function(){window.localStorage.setItem("opMenu","isKnow"),this.opMenu=!1},resize:function(e){this.defaultPercent=e;var t=document.getElementsByClassName("current-select-detail");this.paneLHeight=t[0].offsetHeight*e/100},isCheckSuc:function(e){e||this.runCaseReal()},changeActiveTab:function(e){this.activeTab=e,this.runCaseResult&&this.getLogUrl(this.runCaseResult[0].traceId)},getLogUrl:function(e){if("log"===this.activeTab&&void 0!==e&&null!==e){var t=this.logUrl+e;this.trustUrl=t}},runCaseReal:function(){this.beforeCaseRun=(new Date).getTime(),this.loadingCaseDetailFinish=!0,this.showRunResult=!0,this.RespEmptyCollapse=!1,this.showResponse(),"WebSocket"in window?this.websocket=new WebSocket(De["a"]):this.$error({title:"本地连接失败",content:"您的浏览器不支持开启websocket完成本地连接设备"}),this.websocket.onerror=this.onWsError,this.websocket.onopen=this.onWsOpen,this.websocket.onmessage=this.onWsMessage,this.websocket.onclose=this.onWsClose},runCaseSend:function(){var e={};e="auth"===this.testType?{caseId:this.currentSelectNode.data.id,versionId:this.currentSelectNode.data.versionId,ITP_USER:this.userName,testType:this.testType}:{caseId:this.currentSelectNode.data.id,versionId:this.currentSelectNode.data.versionId,ITP_USER:this.userName},this.websocket.send(JSON.stringify(e))},onWsClose:function(){this.websocket.close()},onWsMessage:function(e){var t,a,i;try{if(t=JSON.parse(e.data),0===t.status)if("success"===t.message){i=t.data||[{expanded:!1}],i=Object(ue["f"])(i)?i:[i],this.runCaseResult=i,this.runCaseResultStatus="processing";for(var s=0;s<this.runCaseResult.length;s++)-1!==this.runCaseResult[s].resultStatus&&1!==this.runCaseResult[s].resultStatus||(this.runCaseResultStatus="error")}else"finish"===t.message&&(this.testType="",this.loadingCaseDetailFinish=!1,"error"!==this.runCaseResultStatus&&(this.runCaseResultStatus="success"),console.log("case运行加载时间",(new Date).getTime()-this.beforeCaseRun),_hmt.push(["_trackEvent","case运行加载时间",(new Date).getTime()-this.beforeCaseRun]));else a=t.message}catch(n){a="响应消息数据格式不合法"}a&&this.$message.error(a)},getLen:function(e){if("string"===typeof e){var t=/^[\u4e00-\u9fa5\uf900-\ufa2d]+$/;if(t.test(e))return 2*e.length;var a=e.match(/[\x00-\xff]/g),i=2*e.length-a.length;return i}},onWsOpen:function(){this.runCaseSend()},onWsError:function(e){console.log(e,"ws error")},runCaseFn:function(){var e=this;Object(b["q"])(this.$route.params.id).then((function(t){if(!t.status){var a=t.data.detectWithDebug;a&&!e.testType?(e.$refs.detectionDlg.openCheck("run"),e.$message.warn("检测中，请稍候")):e.runCaseReal()}})).catch((function(e){}))},runCase:function(e){this.testType="auth"===e?e:"",this.runCaseFn()},saveOperateFn:function(e,t){4===e.type||"api"===e.type||11===e.type||"es"===e.type?this.$store.dispatch("setIsSaveApi","saveApi"):5===e.type||"sql"===e.type?this.$store.dispatch("setIsSaveApi","saveSql"):8===e.type||"redis"===e.type?this.$store.dispatch("setIsSaveApi","saveRedis"):9===e.type||"shell"===e.type?this.$store.dispatch("setIsSaveApi","saveShell"):10!==e.type&&"mongo"!==e.type||this.$store.dispatch("setIsSaveApi","saveMongo");var a={productId:this.$route.query.productId,nodeId:this.currentSelectNode.data.id,nodeType:2,opType:1,cost:0};g(a)},saveOperate:function(e,t){var a=this;"boolean"===typeof t?this.hasAuth((function(){a.saveOperateFn(e,t)})):this.saveOperateFn(e,t)},getNodeKeywords:function(){var e=this;Object(m["E"])({id:this.currentSuite&&this.currentSuite.data.id,typeTag:"suite"}).then((function(t){t.status||(e.hintKeyWords=t.data.map((function(e){return"{".concat(e,"}")})),e.hintKeyWords.forEach((function(t){e.AUTOCOMPLETE_TABLES[t]=[]})))})).catch((function(e){}))},removeOp:function(e){var t=this;this.$confirm({title:"提示",content:"确定要删除【".concat(e.text,"】吗？"),onOk:function(){null===e.versionId||""===e.versionId?Object(m["K"])({id:e.id,versionId:-1}).then((function(a){if(!a.status&&(t.ops.splice(t.ops.indexOf(e),1),t.ops.length?t.chooseOp(t.ops[0]):t.selectedOp=null,null===e.versionId||""===e.versionId)){var i={productId:t.$route.query.productId,nodeId:t.currentSelectNode.data.id,nodeType:2,opType:1,cost:0};g(i)}})).catch((function(e){})):Object(m["K"])({id:e.id,versionId:e.versionId}).then((function(a){if(!a.status&&(t.ops.splice(t.ops.indexOf(e),1),t.ops.length?t.chooseOp(t.ops[0]):t.selectedOp=null,null===e.versionId||""===e.versionId)){var i={productId:t.$route.query.productId,nodeId:t.currentSelectNode.data.id,nodeType:2,opType:1,cost:0};g(i)}})).catch((function(e){}))},onCancel:function(){}})},changeActivekey:function(e){var t=this;clearTimeout(this.timeOut),this.timeOut=setTimeout((function(){t.activeKey=e,t.ops.forEach((function(a){+a.id===+e&&t.chooseOp(a)}))}),200)},saveOpName:function(e){var t=this;if(""!==e.text&&e.text.length){var a={id:e.id},i=e.type;4===i||"api"===i?a.typeTag="api":5===i||"sql"===i?a.typeTag="sql":8===i||"redis"===i?a.typeTag="redis":9===i||"shell"===i?a.typeTag="shell":10===i||"mongo"===i?a.typeTag="mongo":11!==i&&"es"!==i||(a.typeTag="es"),Object(m["Q"])(a,{text:e.text,versionId:e.versionId}).then((function(a){a.status?t.$message.error(a.message||"保存失败！"):(t.$set(e,"isEdit",!1),t.$message.success("保存成功！"),t.$store.dispatch("setCurrentOp",e))})).catch((function(e){}))}else this.$message.error("operation名称不允许为空！")},editOpName:function(e){var t=this;console.log("db",1116),clearTimeout(this.timeOut),this.$set(e,"isEdit",!0),this.$nextTick((function(){t.$refs["opName".concat(e.id)][0].focus()}))},getOpColor:function(e){return{api:"#d9edf7",sql:"#d7ecbe",shell:"#eac8f1",es:"#FFEBCD",mongo:"#effdb9",redis:"#f9f0af"}[e]},unlockOperation:function(e){var t=this;this.$confirm({title:"提示",content:"是否确认解绑，解绑后将无法恢复",onOk:function(){Object(m["M"])({id:e.id,versionId:e.versionId}).then((function(a){a.data?(null!=t.selectedOp&&t.selectedOp.id===e.id&&(t.selectedOp.extId=-1,t.$store.dispatch("setCurrentOp",t.selectedOp)),e.extId=-1):t.$message.error("无法解除绑定")})).catch((function(e){}))},onCancel:function(){}})},addOp:function(e){var t=this,a="Operation";Object(b["q"])(this.$route.params.id).then((function(i){var s=["apiOpName"],n=i.data.caseDefaultSet;if(null==n||""===n)for(var o in n={},s)n[s[o]]="";else for(var r in n=JSON.parse(n),s)null==n[s[r]]&&(n[s[r]]="");""!==n.apiOpName&&(a=n.apiOpName);var c={parentId:t.currentStep.id,type:e.key,groupId:t.$route.params.id,text:a,assertExpectMap:1,assertSql:1,sqlAssertType:1,versionId:t.currentSelectNode.data.versionId},l="";switch(+e.key){case 4:l="api";break;case 5:l="sql";break;case 8:l="redis";break;case 9:l="shell";break;case 10:l="mongo";break;case 11:l="es",c.bodyType=2;break}Object(m["b"])(c,l).then((function(e){e.status||(t.ops.push({type:l,id:e.data,text:a,assertExpectMap:1,assertSql:1,versionId:t.currentSelectNode.data.versionId}),t.chooseOp(t.ops[t.ops.length-1]))})).catch((function(e){}))})).catch((function(e){}))},copyOp:function(e){this.simpleCopy=e.key,this.$refs.copyOption.open({opType:"api",node:this.currentSelectNode,simpleCopy:e.key})},yapicopySuc:function(e){var t=this,a=e.row,i=e.pid,s=e.psstGen;"GET"===a.method?a.method=1:"POST"===a.method?a.method=2:"PUT"===a.method?a.method=3:"DELETE"===a.method&&(a.method=4);var n={typeTag:"api",productId:this.$route.query.productId,externalName:"yapi"},o={url:a.path,method:a.method,parentId:this.currentStep.id,type:4,groupId:this.$route.params.id,text:a.title||"Operation",extId:"",externalOpId:a._id,versionId:this.currentSelectNode.data.versionId,externalProductId:i,psstGen:s};Object(m["e"])(n,o).then((function(e){t.queryNode(e,"api")})).catch()},apiTplcopySuc:function(e){var t=this,a={simpleCopy:e.id?this.simpleCopy:"",typeTag:"api"},i={url:e.url,method:e.method,protocol:e.protocol,parentId:this.currentStep.id,type:4,groupId:this.$route.params.id,text:e.text||"Operation",extId:e.id||"",versionId:this.currentSelectNode.data.versionId,assertExpect:e.assertExpect,assertExpectJsonSchema:e.assertExpectJsonSchema,assertExpectMap:e.assertExpectMap,assertHeader:e.assertHeader,assertSql:e.assertSql,assertUnexpectMap:e.assertUnexpectMap};Object(m["g"])(a,i).then((function(e){t.queryNode(e,"api")})).catch()},dupCopyOp:function(e){var t=this;Object(m["f"])({id:e.id,parentId:this.currentStep.id},{type:e.type,versionId:e.versionId}).then((function(a){a.status?t.$message.error(a.message):t.queryNode(a,e.type)})).catch((function(e){}))},moveOrPasteOp:function(e){for(var t=this,a=0;a<this.ops.length;a++)if(this.ops[a].id===window.copyOp.id&&!e)return void this.$message.warn("在同一个case下移动请使用上移/下移功能！");window.copyOp&&void 0!==window.copyOp?e?Object(m["f"])({id:window.copyOp.id,parentId:this.currentStep.id},{type:window.copyOp.type,versionId:window.copyOp.versionId}).then((function(e){e.status?t.$message.error(e.message):t.queryNode(e,window.copyOp.type)})).catch((function(e){})):Object(m["y"])({id:window.copyOp.id,parentId:this.currentStep.id}).then((function(e){e.status?t.$message.error(e.message):(e.data=window.copyOp.id,console.log(window.copyOp,1116),t.queryNode(e,window.copyOp.type))})).catch((function(e){})):this.$message.warn("请先选择要复制或移动的节点")},quickCopy:function(e){var t=this,a={simpleCopy:"",typeTag:e.type},i={id:e.id,text:e.text,type:this.getOpTypeNum(e.type),versionId:this.currentSelectNode.data.versionId,parentId:this.currentStep.id,groupId:this.$route.params.id,extId:""};Object(m["g"])(a,i).then((function(a){t.queryNode(a,e.type)})).catch()},queryNode:function(e,t){var a=this;Object(m["F"])({typeTag:t,id:e.data.id||e.data,versionId:this.currentSelectNode.data.versionId}).then((function(e){a.ops.push({id:e.data.id,type:t,text:e.data.text,extId:e.data.extId,versionId:e.data.versionId}),a.chooseOp(a.ops[a.ops.length-1])})).catch()},getOpTypeNum:function(e){return{api:4,es:11,sql:5,redis:8,shell:9,mongo:10}[e]},copyStepSuc:function(e){this.steps.push(e),this.selectStep(e)},moveUp:function(e,t){var a=this,i=e+"s";if(t.id!==this[i][0].id){var s="currentSuite",n=this[s].data.id;"op"===e&&(s="currentStep",n=this[s].id);var o=t.id,r={id:o,pid:n,versionId:"-1"===this.versionId?"":this.versionId};Object(m["N"])(r).then((function(e){if(e.status)a.$message.error(e.message);else{for(var t=0;t<a[i].length;t++)if(a[i][t].id===o){if(0===t)return;var s=a[i][t-1];a[i][t-1]=a[i][t],a[i][t]=s;break}a.$forceUpdate()}})).catch((function(e){}))}},moveDown:function(e,t){var a=this,i=e+"s";if(t.id!==this[i][this[i].length-1].id){var s="currentSuite",n=this[s].data.id;"op"===e&&(s="currentStep",n=this[s].id);var o=t.id,r={id:o,pid:n,versionId:"-1"===this.versionId?"":this.versionId};Object(m["i"])(r).then((function(e){if(e.status)a.$message.error(e.message);else{for(var t=0;t<a[i].length;t++)if(a[i][t].id===o){if(t===a[i].length-1)return;var s=a[i][t+1];a[i][t+1]=a[i][t],a[i][t]=s;break}a.$forceUpdate()}})).catch((function(e){}))}},removeStep:function(e){var t=this;this.$confirm({title:"提示",content:"确定要删除【"+e.text+"】吗？",onOk:function(){var a={};a=null===e.versionId||""===e.versionId?{id:e.id,versionId:-1}:{id:e.id,versionId:e.versionId},Object(m["K"])(a).then((function(a){a.status||(t.steps.splice(t.steps.indexOf(e),1),t.selectStep(t.steps[t.steps.length-1]))})).catch((function(e){}))},onCancel:function(){}})},saveStepName:function(e,t){t&&"keyup"===t.type&&13!==t.keyCode||(this.$set(e,"editable",!1),Object(m["P"])({text:e.text,versionId:e.versionId},{id:e.id,typeTag:"step"}).then((function(e){})).catch((function(e){})))},setStepEditable:function(e,t){this.$set(e,"editable",!0)},selectStep:function(e){var t=this;this.isDouble&&(this.isDouble=!1,this.currentStep=e,Object(m["l"])({groupId:this.$route.params.id,id:e.id,versionId:e.versionId}).then((function(e){if(!e.status)if(t.ops=[],t.preOp(e.data),t.ops.shift(),0!==t.ops.length){t.chooseOp(t.ops[0]);try{setTimeout((function(){Object(xe["a"])({key:"request-content"}).setOptions({doneLabel:"知道了",prevLabel:"上一个",nextLabel:"下一个",exitOnOverlayClick:!1,exitOnEsc:!1,steps:[{element:document.querySelector(".ant-collapse-arrow"),intro:"点击这里可展开case的基本信息"},{element:document.querySelector("#op-dashboard"),intro:"点击这里可展开operation列表"},{element:document.querySelector("#add-and-copy-btn"),intro:"可新增&复制operation"},{element:document.querySelector(".case-details"),intro:"在这里可编辑您的case"},{element:document.querySelector("#noteEditor-test-btn"),intro:"点击测试可运行case"}]}).start()}),1e3)}catch(a){}}else t.currentOp=null})).catch((function(e){})),setTimeout((function(){t.isDouble=!0}),10))},hasAuth:function(e){var t=this;Object(m["k"])({groupId:this.$route.params.id}).then((function(a){if(!a.status){var i=a.data;if(i.ifConstraintSaveCase&&i.constraintTypes.includes("0")&&""===t.currentSelectNode.data.note)return void t.$message.error("测试用途不能为空");e&&e()}})).catch((function(e){}))},checkOpChanged:function(e){return 4===e.type||"api"===e.type||11===e.type||"es"===e.type?this.$refs.apiEditorRef.checkOpChanged():5===e.type||"sql"===e.type?this.$refs.sqlEditorRef.checkOpChanged():8===e.type||"redis"===e.type?this.$refs.redisEditorRef.checkOpChanged():9===e.type||"shell"===e.type?this.$refs.shellEditorRef.checkOpChanged():10===e.type||"mongo"===e.type?this.$refs.mongoEditorRef.checkOpChanged():void 0},operateChangeHandle:function(e){e&&e()},chooseOpFn:function(e){var t=this;"api"===e.type&&this.$store.dispatch("setBeforeRenderTime",(new Date).getTime()),this.currentSelectOp=e,this.operateChangeHandle((function(){t.selectedOp=e,t.activeKey=e.id,t.$forceUpdate(),t.$store.dispatch("setCurrentOp",t.selectedOp),t.getNodeKeywords()}))},updateOpDetail:function(e){this.selectedOp=e,this.activeKey=e.id,this.$forceUpdate(),this.$store.dispatch("setCurrentOp",this.selectedOp),this.getNodeKeywords()},chooseOp:function(e,t){var a=this;t?this.hasAuth((function(){a.chooseOpFn(e)})):this.chooseOpFn(e)},preOp:function(e){this.ops.push(e.data);for(var t=0;t<e.children.length;t++)"api"!==e.children[t].data.type&&"sql"!==e.children[t].data.type&&"redis"!==e.children[t].data.type&&"shell"!==e.children[t].data.type&&"es"!==e.children[t].data.type&&"mongo"!==e.children[t].data.type||this.preOp(e.children[t])},showResponse:function(){this.RespEmptyCollapse=!this.RespEmptyCollapse,this.defaultPercent=this.RespEmptyCollapse?30:67,this.resize(this.defaultPercent)},copyStep:function(){this.$refs.copyStepModal.copyStep()},addStep:function(){var e=this,t={parentId:this.steps[this.steps.length-1].id,type:3,groupId:this.$route.params.id,text:"STEP",versionId:this.currentSelectNode.data.versionId};Object(m["a"])(t,"step").then((function(a){if(!a.status){var i=Object.assign(t,{id:a.data,typeTag:"step"});e.steps.push(i),e.selectStep(i),e.$set(i,"editable",!0)}})).catch((function(e){}))}}},Vt=Lt,Rt=(a("6d16"),Object($["a"])(Vt,Ie,$e,!1,null,"66761a7e",null)),Mt=Rt.exports,Pt=function(e){return Object(y["a"])({url:"/itp/version?groupId=".concat(e),method:"GET"})},At=function(e){return Object(y["a"])({url:"/itp/version/".concat(e),method:"DELETE"})},jt=function(e,t){return Object(y["a"])({url:"/itp/version/".concat(e),method:"PUT",data:t})},qt=function(e){return Object(y["a"])({url:"/itp/version",method:"PUT",data:e})},Kt=function(e){return Object(y["a"])({method:"GET",url:"/itp/node?groupId=".concat(e.groupId,"&id=").concat(e.id,"&versionId=").concat(e.version)})},zt={components:{CreateSuite:A,CreateCase:B,CopyOrMove:E,NoteEditor:Mt,DynamicData:Y,DetectionDlg:ae,branchVersion:ce},data:function(){return{detailVisible:!1,showEditName:!0,isShowEditDescr:!0,isShowEditSpeciTag:!0,groupVersionId:"-1",caseLevels:[{id:1,name:"L1(高)"},{id:2,name:"L2(中)"},{id:4,name:"L3(低)"},{id:8,name:"L4(极低)"}],auths:[{id:1,name:"读写"},{id:2,name:"只读"}],versionBtns:[{id:1,name:"拉取",prop:"PUT"},{id:2,name:"合入",prop:"POST"},{id:3,name:"删除",prop:"DELETE"}],versionHandle:null,ExistVersion:[],masterTag:"",currentVerisonName:"master",createSetupLoading:!1,createTearDownLoading:!1,baseInfo:void 0}},computed:Object(l["a"])({},Object(d["b"])({currentSelectNode:function(e){return e.treenode.currentSelectTreeNode},ifExtraVersion:function(e){return e.treenode.ifExtraVersion},versionId:function(e){return e.treenode.versionId}})),watch:{"currentSelectNode.data.versionId":function(){this.currentSelectNode.data.versionId?this.groupVersionId=this.currentSelectNode.data.versionId:this.groupVersionId="-1"},"currentSelectNode.data.id":function(){this.currentVerisonName="master"}},mounted:function(){var e=window.localStorage.getItem("baseInfo")||"";this.baseInfo="isKnow"!==e},methods:{baseInfoHandle:function(){window.localStorage.setItem("baseInfo","isKnow"),this.baseInfo=!1},getTitle:function(e){return e.length>=20?e.substring(0,20)+"...":e},oncurrencyTagChange:function(e){var t=this;Object(m["P"])({concurrencyTag:e.key,versionId:this.currentSelectNode.data.versionId},{id:this.currentSelectNode.data.id,typeTag:"case"}).then((function(a){a.status||(t.currentSelectNode.data.concurrencyTag=+e.key,t.$forceUpdate())})).catch((function(e){}))},versionDelete:function(e){var t=this;Kt({groupId:this.$route.params.id,id:this.currentSelectNode.data.id,version:e.id}).then((function(a){if(a.status)t.$message.error(a.message);else{var i=a.data;null===i||""===i?t.$message.error("该case无当前版本,无法删除"):t.beforeBranchRemove(t.currentSelectNode,e)}})).catch((function(e){}))},beforeBranchRemove:function(e,t){var a=this;this.$confirm({title:"提示",content:"确定删除【".concat(e.data.text,"】的分支【").concat(t.name,"】吗？"),onOk:function(){Object(m["J"])({id:e.data.id,versionId:t.id}).then((function(t){if(t.status)a.$message.error(t.message);else if(a.$message.success("删除成功"),"case"===e.data.type){var i={productId:a.$route.query.productId,nodeId:e.data.id,nodeType:2,opType:2,cost:1};g(i)}})).catch((function(e){}))},onCancel:function(){}})},versionPush:function(e){var t=this;Kt({groupId:this.$route.params.id,id:this.currentSelectNode.data.id,version:e.id}).then((function(a){if(a.status)t.$message.error(a.message);else{var i=a.data;null===i||""===i?t.$message.error("该case无当前版本,无法推送"):Pt(t.$route.params.id).then((function(a){a.status?t.$message.error(a.message):Object(m["H"])({typeTag:"case",id:t.currentSelectNode.data.id}).then((function(a){a.status?t.$message.error(a.message):t.queryTagCallBack(a.data,i,e)})).catch((function(e){}))})).catch((function(e){}))}})).catch((function(e){}))},queryTagCallBack:function(e,t,a){for(var i=this,s=0;s<e.length;s++)if(0===e[s].version){this.masterTag=e[s].tag;break}t.data.created!==this.masterTag?this.$confirm({title:"提示",content:"分支【".concat(a.name,"】的Tag 和 MASTER Tag 不一致，建议手工合入，或依旧确认合入?"),onOk:function(){i.versionPushDetail(a)},onCancel:function(){}}):this.$confirm({title:"提示",content:"确定将分支【".concat(a.name,"】合入【").concat(this.currentSelectNode.data.text,"】的 MASTER 吗？"),onOk:function(){i.versionPushDetail(a)},onCancel:function(){}})},versionPushDetail:function(e){var t=this;Object(m["C"])({id:this.currentSelectNode.data.id,versionId:e.id,groupId:this.$route.params.id}).then((function(e){if(e.status)t.$message.error(e.message);else{var a=e.data;a?(t.$emit("clickMasterCase"),t.$message.success("合入成功"),t.currentVerisonName="master"):t.$message.success("合入失败")}})).catch((function(e){}))},verisonPull:function(e){var t=this;Kt({groupId:this.$route.params.id,id:this.currentSelectNode.data.id,version:e.id}).then((function(a){if(a.status)t.$message.error(a.message);else{var i=a.data;null===i||""===i?Object(m["B"])({id:t.currentSelectNode.data.id,versionId:e.id,groupId:t.$route.params.id}).then((function(e){e.status?t.$message.error(e.message):t.$message.success("拉取成功")})).catch((function(e){})):t.$message.error("拉取失败，该版本已有该case分支")}})).catch((function(e){}))},clickVerisonCase:function(e){var t=this;Kt({groupId:this.$route.params.id,id:this.currentSelectNode.data.id,version:e.id}).then((function(a){if(a.status)t.$message.error(a.message);else{var i=a.data;null===i||""===i?t.$message.warn("无版本case ,不可点"):(t.$emit("clickVerisonCase",e),t.currentVerisonName=e.name)}})).catch((function(e){}))},clickMasterCase:function(){this.$emit("clickMasterCase"),this.currentVerisonName="master"},clickVersionNav:function(){this.requestVersionList(this.$route.params.id)},queryTag:function(){var e=this;return Object(o["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,Object(m["H"])({typeTag:"case",id:e.currentSelectNode.data.id}).then((function(t){if(t.status)e.$message.error(t.message);else for(var a=t.data,i=0;i<a.length;i++)if(0===a[i].version)e.masterTag=a[i].tag;else for(var s=0;s<e.ExistVersion.length;s++)e.ExistVersion[s].id===a[i].version&&e.$set(e.ExistVersion[s],"tag",a[i].tag)})).catch();case 2:case"end":return t.stop()}}),t)})))()},requestVersionList:function(e){var t=this;return Object(o["a"])(regeneratorRuntime.mark((function a(){return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:return a.next=2,Pt(e).then((function(e){if(e.status)t.$message.error(e.message);else{var a=e.data;t.ExistVersion=a,t.queryTag()}})).catch((function(e){}));case 2:case"end":return a.stop()}}),a)})))()},isOnlyCase:function(e){return["case"].indexOf(e&&e.data&&e.data.type)>-1},changeVersionHandle:function(e){for(var t=0;t<this.versionBtns.length;t++)if(+e.key===+this.versionBtns[t].id){this.versionHandle=this.versionBtns[t];break}this.versionHandle&&this.$refs.branchVersion.open(this.versionHandle)},changCasesStatus:function(e){e.data.status=0===e.data.status?1:0;var t={status:e.data.status,versionId:this.currentSelectNode.data.versionId},a={id:this.currentSelectNode.data.id,typeTag:"case"};Object(m["P"])(t,a).then((function(e){})).catch((function(e){}))},copyOrMoveTo:function(){this.$refs.copyOrMove.add()},createTearDown:function(){var e=this;this.createTearDownLoading=!0,Object(m["I"])(this.currentSelectNode.data.id).then((function(t){t.data?(e.$emit("createTearDownSuc",t.data),e.createTearDownLoading=!1):e.$message.error("糟糕:( /itp/node/".concat(e.currentSelectNode.data.id,"返回的结果为空"))})).catch((function(e){}))},createSetup:function(){var e=this;this.createSetupLoading=!0,Object(m["G"])(this.currentSelectNode.data.id).then((function(t){t.data?(e.$emit("createSetupSuc",t.data),e.createSetupLoading=!1):e.$message.error("糟糕:( /itp/node/".concat(e.currentSelectNode.data.id,"返回的结果为空"))})).catch((function(e){}))},chooseSuiteSuc:function(e){this.$emit("chooseSuiteSuc",e)},createSuiteSuc:function(e){this.$emit("createSuiteSuc",e)},createSuite:function(){this.$refs.createSuite.add()},createCaseSuc:function(e){this.$emit("createCaseSuc",e)},handleVersionSuc:function(){this.$emit("handleVersionSuc")},createCase:function(){this.$refs.createCase.add()},hasTeardown:function(e){for(var t=e.children||[],a=0;a<t.length;a++)if("teardown"===t[a].data.type)return!0;return!1},hasSetup:function(e){for(var t=e.children||[],a=0;a<t.length;a++)if("setup"===t[a].data.type)return!0;return!1},isRoot:function(e){return["root"].indexOf(e&&e.data&&e.data.type)>-1},isSuite:function(e){return["suite"].indexOf(e&&e.data&&e.data.type)>-1},isCase:function(e){return["case","setup","teardown"].indexOf(e&&e.data&&e.data.type)>-1},isSetupOrTeardown:function(e){return["setup","teardown"].indexOf(e&&e.data&&e.data.type)>-1},getTime:function(e){return Object(ue["i"])(e)},changeShowEditSpecialTag:function(){var e=this;this.isShowEditSpeciTag=!this.isShowEditSpeciTag,this.$nextTick((function(){e.$refs.specialNoteInput.focus()}))},changeShowEditDescr:function(){var e=this;this.isShowEditDescr=!this.isShowEditDescr,this.$nextTick((function(){e.$refs.noteInput.focus()}))},changeShowEditName:function(){var e=this;this.showEditName=!this.showEditName,this.$nextTick((function(){e.$refs.titleInput.focus()}))},changeAuth:function(e){var t=this;Object(m["P"])({readOnly:e.key,versionId:this.currentSelectNode.data.versionId},{id:this.currentSelectNode.data.id,typeTag:"case"}).then((function(a){a.status||(t.currentSelectNode.data.readOnly=e.key)})).catch((function(e){}))},changeCaseLevel:function(e){var t=this;Object(m["P"])({level:e.key,versionId:this.currentSelectNode.data.versionId},{id:this.currentSelectNode.data.id,typeTag:"case"}).then((function(a){a.status||(t.currentSelectNode.data.level=e.key)})).catch((function(e){}))},saveDescr:function(){var e=this;Object(m["P"])({specialNote:this.currentSelectNode.data.specialNote,note:this.currentSelectNode.data.note,versionId:this.currentSelectNode.data.versionId},{id:this.currentSelectNode.data.id,typeTag:this.currentSelectNode.data.type}).then((function(t){e.isShowEditDescr=!0,e.isShowEditSpeciTag=!0})).catch((function(e){}))},saveTitle:function(){var e=this;this.currentSelectNode.data.text?(Object(m["P"])({text:this.currentSelectNode.data.text,versionId:this.currentSelectNode.data.versionId},{id:this.currentSelectNode.data.id,typeTag:this.currentSelectNode.data.type}).then((function(t){t.status||e.$emit("updateTitleSuc",{title:e.currentSelectNode.data.text})})).catch((function(e){})),this.showEditName=!0):this.$message.warn("名称不能为空")},getReadType:function(e){return{1:"读写",2:"只读"}[e]||"--"},getNodeLevel:function(e){return{1:"L1(高)",2:"L2(中)",4:"L3(低)",8:"L4(极低)"}[e]||"--"},getLiftColor:function(e){return{0:"#108ee9",1:"#87d068",2:"#f50",3:""}[e]},getDisplayLife:function(e){return{0:"new",1:"stable",2:"unstable",3:"death"}[e]||"--"}}},Gt=zt,Bt=(a("0ee2"),Object($["a"])(Gt,Ne,Oe,!1,null,"df6f614a",null)),Ft=Bt.exports,Ut={components:{TreeNode:_e,RightDetail:Ft},data:function(){return{ifExtraVersion:!1,groupExistVersions:[],groupSelectedName:"-1",currentVersion:null,isBranchShow:!1,ExistVersion:[],newVersionName:"",branchColumn:[{title:"ID",dataIndex:"id",key:"id",width:100},{title:"名称",dataIndex:"name",key:"name",scopedSlots:{customRender:"name"}},{title:"操作",key:"operation",scopedSlots:{customRender:"action"},width:200}],yapiColumn:[{title:"项目信息",dataIndex:"pname",key:"pname",width:"10%"},{title:"API信息",dataIndex:"apiInfo",key:"apiInfo",width:"20%"},{title:"API动作",dataIndex:"action",key:"action",width:"10%",customRender:function(e,t){var a={add:"新增",delete:"删除",update:"更新"};return a[e]}},{title:"API更新时间",dataIndex:"yapiLastUpdateTimeFormat",key:"yapiLastUpdateTimeFormat",width:"15%"},{title:"对应Case",dataIndex:"caseId",key:"caseId",width:"10%",scopedSlots:{customRender:"caseId"}},{title:"Case版本号",dataIndex:"versionId",key:"versionId",width:"10%"},{title:"Case最近更新时间",dataIndex:"lastUpdateTimeFormat",key:"lastUpdateTimeFormat",width:"15%"},{title:"确认已修改",width:"10%",scopedSlots:{customRender:"apiCheckbox"}}],editVersionName:"",isYapiUpdateShow:!1,showEditVersion:!1}},computed:Object(l["a"])({},Object(d["b"])({currentSelectNode:function(e){return e.treenode.currentSelectTreeNode},versionId:function(e){return e.treenode.versionId}})),mounted:function(){this.open()},methods:{handleVersion:function(){this.showEditVersion=!this.showEditVersion},branchCancle:function(){this.isBranchShow=!1,this.requestVersionGroupList()},handleCancel:function(){this.isYapiUpdateShow=!1},confirmUpdate:function(){var e=this;console.log("confirmUpdate",this.yapiTableData,315),Object(b["w"])({groupId:this.$route.params.id},{pidLists:[{apiLists:this.copyData.apiLists}]}).then((function(t){if(!t.status){var a=t.data;e.yapiTableData=[];for(var i=0;i<a.length;i++){for(var s=a[i],n={},o=0;o<a[i].caseLists.length;o++)n=Object(l["a"])({},a[i].caseLists);e.yapiTableData.push(Object.assign(s,n))}console.log(e.yapiTableData,345),e.tableData.apiLists=e.updateTimeData(a),e.apiCheckbox=e.justifyChecked(),console.log(e.apiCheckbox,347);var r=!0;for(var c in e.apiCheckbox)if(!e.apiCheckbox[c])return r=!1,e.$message.error("未同步更新完全，不予更新"),!1;r&&Object(b["v"])({groupId:e.$route.params.id},{lastUpdateTime:(new Date).getTime()}).then((function(t){t.status?e.$message.error(t.message):e.$message.success("更新成功")})).catch(),e.isYapiUpdateShow=!1}})).catch()},updateTimeData:function(e){var t=0;if(e&&e.length)for(var a=0;a<e.length;a++){if(!e[a].caseLists.length){var i=this.makeCaseItem(t);e[a].caseLists.push(i),t++}if(e[a].apiInfo=e[a].apiInfo+"\n"+e[a].method+"\n"+e[a].path,e[a].yapiLastUpdateTimeFormat=this.transformTenTimeStamp(e[a].yapiLastUpdateTime),e[a].caseLists&&e[a].caseLists.length)for(var s=0;s<e[a].caseLists.length;s++)"number"===typeof e[a].caseLists[s].lastUpdateTime&&(e[a].caseLists[s].lastUpdateTimeFormat=this.transformThirteenTimeStamp(e[a].caseLists[s].lastUpdateTime))}return e},open:function(){this.checkVersion(),this.requestVersionGroupList(),this.requestUpdateInfoYapi()},makeCaseItem:function(e){var t={caseId:"无"+e,versionId:"无",lastUpdateTime:"无"};return t},transformTenTimeStamp:function(e){return new Date(1e3*parseInt(e)).toLocaleString().replace(/:\d{1,2}$/," ")},transformThirteenTimeStamp:function(e){return new Date(parseInt(e)).toLocaleString().replace(/:\d{1,2}$/," ")},requestUpdateInfoYapi:function(){var e=this;Object(b["u"])({groupId:this.$route.params.id}).then((function(t){if(t.status)e.$message.error(t.message);else{var a=t.data,i=0,s=[],n=[],o=0,r=JSON.parse(JSON.stringify(a));if(a.pidLists&&a.pidLists.length)for(var c=0;c<a.pidLists.length;c++)if(a.pidLists[c].apiLists&&a.pidLists[c].apiLists.length){i+=a.pidLists[c].apiLists.length;for(var l=0;l<a.pidLists[c].apiLists.length;l++){if(a.pidLists[c].apiLists[l].pname=a.pidLists[c].pname,n.push(JSON.parse(JSON.stringify(a.pidLists[c].apiLists[l]))),!a.pidLists[c].apiLists[l].caseLists.length){var d=e.makeCaseItem(o);a.pidLists[c].apiLists[l].caseLists.push(d),o++}if(a.pidLists[c].apiLists[l].apiInfo=a.pidLists[c].apiLists[l].apiInfo+"\n"+a.pidLists[c].apiLists[l].method+"\n"+a.pidLists[c].apiLists[l].path,a.pidLists[c].apiLists[l].yapiLastUpdateTimeFormat=e.transformTenTimeStamp(a.pidLists[c].apiLists[l].yapiLastUpdateTime),a.pidLists[c].apiLists[l].caseLists.length)for(var u=0;u<a.pidLists[c].apiLists[l].caseLists.length;u++)"number"===typeof a.pidLists[c].apiLists[l].caseLists[u].lastUpdateTime&&(a.pidLists[c].apiLists[l].caseLists[u].lastUpdateTimeFormat=e.transformThirteenTimeStamp(a.pidLists[c].apiLists[l].caseLists[u].lastUpdateTime));s.push(a.pidLists[c].apiLists[l])}}var p=a;if(p.apiLists=s,r.apiLists=n,i>0){e.tableData=p,e.copyData=r,e.yapiTableData=[];for(var h=0;h<e.tableData.apiLists.length;h++){for(var f={pname:e.tableData.apiLists[h].pname,apiInfo:e.tableData.apiLists[h].apiInfo,action:e.tableData.apiLists[h].action,yapiLastUpdateTimeFormat:e.tableData.apiLists[h].yapiLastUpdateTimeFormat,yapiLastUpdateTime:e.tableData.apiLists[h].yapiLastUpdateTime,apiId:e.tableData.apiLists[h].apiId},m=e.tableData.apiLists[h].caseLists||[],y=0;y<m.length;y++)f.caseId=m[y].caseId,f.versionId=m[y].versionId,f.lastUpdateTimeFormat=m[y].lastUpdateTimeFormat,f.caseId=m[y].caseId,f.lastUpdateTime=m[y].lastUpdateTime;e.yapiTableData.push(f)}e.apiCheckbox=e.justifyChecked(),e.isYapiUpdateShow=!0}}})).catch()},justifyChecked:function(){for(var e=this.tableData.apiLists,t=[],a=e.length-1;a>=0;a--)for(var i=e[a].caseLists.length-1;i>=0;i--)"add"===e[a].action&&(e[a].caseLists[i].caseId.toString().startsWith("无")?t[e[a].caseLists[i].caseId]=!1:t[e[a].caseLists[i].caseId]=parseInt(e[a].caseLists[i].lastUpdateTime,10)>parseInt(1e3*e[a].yapiLastUpdateTime,10)),"update"===e[a].action&&(t[e[a].caseLists[i].caseId]=parseInt(e[a].caseLists[i].lastUpdateTime,10)>parseInt(1e3*e[a].yapiLastUpdateTime,10)),"delete"===e[a].action&&(e[a].caseLists[i].caseId.toString().startsWith("无")?t[e[a].caseLists[i].caseId]=!0:t[e[a].caseLists[i].caseId]=!1);return t},onVersionSwitchChange:function(e){var t=this,a={ifExtraVersion:e};Object(b["x"])(this.$route.params.id,a).then((function(a){a.status||(t.ifExtraVersion=e,t.$store.dispatch("setIfExtraVersion",t.ifExtraVersion))})).catch()},saveEditVersion:function(e){var t=this;this.verifyVersion(this.editVersionName)&&jt(e.id,{id:e.id,name:this.editVersionName}).then((function(e){e.status||t.requestVersionList(t.$route.params.id)})).catch()},cancleEditVersion:function(e){this.$set(e,"isEdit",!1),this.$forceUpdate()},deleteVersion:function(e){var t=this;this.$confirm({title:"提示",content:"确定要删除【".concat(e.name,"】,删除版本后索引该版本的case将删除"),onOk:function(){At(e.id).then((function(e){e.status||t.requestVersionList(t.$route.params.id)})).catch((function(e){}))},onCancel:function(){}})},handleBranchState:function(){this.isBranchShow=!0,this.requestVersionList(this.$route.params.id)},dbclickEdit:function(e){var t=this;this.$set(e,"isEdit",!0),this.editVersionName=e.name,this.ExistVersion.forEach((function(a){a.id!==e.id&&t.$set(a,"isEdit",!1)})),this.$forceUpdate(),this.$nextTick((function(){t.$refs["version".concat(e.id)].focus()}))},handleInputConfirm:function(){var e=this;this.verifyVersion(this.newVersionName)&&(this.newVersionName?qt({name:this.newVersionName,groupId:this.$route.params.id,productId:this.$route.query.productId}).then((function(t){t.status||e.ExistVersion.push({groupId:e.$route.params.id,id:t.data,name:e.newVersionName,productId:e.$route.query.productId,isEdit:!1})})).catch((function(e){})):this.$message.warn("版本名称不能为空！"))},verifyVersion:function(e){for(var t=0;t<this.ExistVersion.length;t++)if(this.ExistVersion[t].name===e)return this.$message.warn("现存版本中，已经存在当前版本，请确认后重新输入！"),!1;return!0},requestVersionList:function(e){var t=this;return Object(o["a"])(regeneratorRuntime.mark((function a(){return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:return a.next=2,Pt(e).then((function(e){e.status||(t.ExistVersion=e.data,t.ExistVersion.forEach((function(e){e=Object.assign(e,{isEdit:!1})})))})).catch((function(e){}));case 2:case"end":return a.stop()}}),a)})))()},getMasterCaseTree:function(){this.$refs.treenode.getAllCaseTree()},checkVersion:function(){var e=this;return Object(o["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,Object(b["q"])(e.$route.params.id).then((function(t){t.status||(e.ifExtraVersion=t.data.ifExtraVersion,null!==t.data.ifExtraVersion&&""!==t.data.ifExtraVersion||(e.ifExtraVersion=!1),e.showEditVersion=e.ifExtraVersion,e.$store.dispatch("setIfExtraVersion",e.ifExtraVersion))})).catch((function(e){}));case 2:case"end":return t.stop()}}),t)})))()},requestVersionGroupList:function(){var e=this;return Object(o["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,Pt(e.$route.params.id).then((function(t){if(t.status)e.$message.error(t.message);else{var a=t.data;e.groupExistVersions=a,e.groupExistVersions.unshift({id:"-1",name:"master"});var i="undefined"===typeof e.$route.query.versionId?a[0].id:e.$route.query.versionId;e.groupSelectedName=i,e.getCurrentVersion(e.groupSelectedName)}})).catch();case 2:case"end":return t.stop()}}),t)})))()},getCurrentVersion:function(e){var t=this;this.groupExistVersions.forEach((function(a){+a.id===+e&&(t.currentVersion=a,t.$store.dispatch("setVersionId",t.currentVersion.id))}))},changeVersion:function(e){this.getCurrentVersion(e)}}},Jt=Ut,Ht=(a("36f6"),Object($["a"])(Jt,r,c,!1,null,"5c91f0ba",null)),Wt=Ht.exports,Yt=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("a-form-model",{ref:"searchform",staticClass:"search-style",attrs:{layout:"inline",model:e.form}},[a("a-form-model-item",{attrs:{label:"时间范围：",prop:"startDate"}},[a("a-range-picker",{on:{change:e.onChange},model:{value:e.timeValue,callback:function(t){e.timeValue=t},expression:"timeValue"}})],1),a("a-form-model-item",{attrs:{label:"操作人",prop:"userName"}},[a("a-input",{attrs:{placeholder:"请输入邮箱前缀"},model:{value:e.form.userName,callback:function(t){e.$set(e.form,"userName",t)},expression:"form.userName"}})],1),a("a-form-model-item",{attrs:{label:"操作类型",prop:"opType"}},[a("a-select",{staticClass:"search-select",attrs:{placeholder:"请选择操作类型","defaule-value":e.opList[0].id},model:{value:e.form.opType,callback:function(t){e.$set(e.form,"opType",t)},expression:"form.opType"}},e._l(e.opList,(function(t){return a("a-select-option",{key:t.id,attrs:{value:t.id}},[e._v(" "+e._s(t.name)+" ")])})),1)],1),a("a-form-model-item",[a("a-button",{attrs:{type:"primary"},on:{click:e.searchRecord}},[e._v(" 搜索 ")])],1)],1),a("a-table",{attrs:{size:"middle",columns:e.columns,"row-key":function(e){return e.id},"data-source":e.tableData,pagination:e.tableData.length>11&&{pageSize:11},scroll:{y:500}}})],1)},Qt=[],Xt=a("6086"),Zt={props:{recordData:{type:Array,default:function(){return[]}}},watch:{recordData:function(){this.tableData=this.recordData,this.form={opType:null,userName:null,startDate:null,endDate:null},this.timeValue=void 0}},data:function(){return{tableData:this.recordData||[],form:{opType:null,userName:null,startDate:null,endDate:null},opList:Xt["g"],columns:Xt["h"],timeValue:void 0}},methods:{getTestGroupHistory:function(e,t,a){var i=this;return Object(o["a"])(regeneratorRuntime.mark((function s(){return regeneratorRuntime.wrap((function(s){while(1)switch(s.prev=s.next){case 0:return s.next=2,Object(b["r"])(e,t).then((function(e){var t=e.data,a=e.message,s=e.status;s?i.$message.error(a):i.tableData=t})).catch((function(e){a&&a(e)}));case 2:case"end":return s.stop()}}),s)})))()},onChange:function(e,t){this.form.startDate=t[0],this.form.endDate=t[1]},searchRecord:function(){var e={opType:this.form.opType||null,userName:this.form.userName||null,startDate:this.form.startDate||null,endDate:this.form.endDate||null};this.getTestGroupHistory(this.$route.params.id,e)}}},ea=Zt,ta=(a("1160"),Object($["a"])(ea,Yt,Qt,!1,null,"79e8ce8e",null)),aa=ta.exports,ia=function(){var e=this,t=e.$createElement,a=e._self._c||t;return e.testGroup?a("div",{staticClass:"global-setting-style"},[a("div",{staticClass:"global-setting-body"},[a("a-alert",{directives:[{name:"show",rawName:"v-show",value:e.saveButtonShow,expression:"saveButtonShow"}],attrs:{type:"error","show-icon":""}},[a("span",{attrs:{slot:"message"},slot:"message"},[e._v("不具有公共配置操作权限,仅能更改个人配置，如有更改公共配置需要，请联系"),a("strong",[e._v(e._s(e.authArray))]),e._v("进行[控制权限]-[用例控制权限]权限变更")])]),a("div",{staticStyle:{"margin-top":"20px"}},[a("a-tabs",{attrs:{"default-active-key":"0","tab-position":"left"}},e._l(e.tabData,(function(t){return t.checked?a("a-tab-pane",{key:t.id,attrs:{tab:t.title}},[1===t.id?a("div",{staticClass:"setting-content"},[a("div",{staticClass:"global-setting-sub-title"},[e._v(" 公共配置 ")]),a("a-form-model",{ref:"publicSettingForm",refInFor:!0,attrs:{model:e.testGroup,"label-col":e.labelCol,"wrapper-col":e.wrapperCol}},[a("a-form-model-item",{ref:"realHost",refInFor:!0,attrs:{label:"目标地址:",prop:"realHost"}},[a("a-dropdown",{attrs:{trigger:["click"],disabled:e.saveButtonShow}},[a("a-input",{staticStyle:{width:"100%"},attrs:{placeholder:"目标服务地址；域名或IP:端口，多个英文分号分隔"},model:{value:e.testGroup.realHost,callback:function(t){e.$set(e.testGroup,"realHost",t)},expression:"testGroup.realHost"}},[e.saveButtonShow?e._e():a("a-tooltip",{attrs:{slot:"addonAfter"},slot:"addonAfter"},[a("template",{slot:"title"},[e._v(" 保存到[公共配置]-[常用地址] ")]),a("a-icon",{attrs:{type:"arrow-right"},on:{click:function(t){return t.stopPropagation(),e.saveToCommonAddress(e.testGroup.realHost,0)}}})],2)],1),e.commonConfigs.length?a("a-menu",{staticStyle:{"max-height":"300px",overflow:"auto"},attrs:{slot:"overlay"},on:{click:function(t){return e.handleAddress(e.testGroup.realHost,t.key,"testGroup.realHost")}},slot:"overlay"},[e._l(e.commonConfigs,(function(t){return[a("a-menu-item",{key:t,attrs:{value:t}},[e._v(" "+e._s(t)+" ")])]}))],2):e._e()],1)],1),a("a-form-model-item",{ref:"host",refInFor:!0,attrs:{label:"HOST:",prop:"host"}},[a("a-dropdown",{attrs:{trigger:["click"],disabled:e.saveButtonShow}},[a("a-input",{staticStyle:{width:"100%"},attrs:{placeholder:"选填，若需要配置HOST文件；模拟的域名:端口"},model:{value:e.testGroup.host,callback:function(t){e.$set(e.testGroup,"host",t)},expression:"testGroup.host"}},[e.saveButtonShow?e._e():a("a-tooltip",{attrs:{slot:"addonAfter"},slot:"addonAfter"},[a("template",{slot:"title"},[e._v(" 保存到[公共配置]-[常用地址] ")]),a("a-icon",{attrs:{type:"arrow-right"},on:{click:function(t){return t.stopPropagation(),e.saveToCommonAddress(e.testGroup.host,0)}}})],2)],1),e.commonConfigs.length?a("a-menu",{staticStyle:{"max-height":"300px",overflow:"auto"},attrs:{slot:"overlay"},on:{click:function(t){return e.handleAddress(e.testGroup.host,t.key,"testGroup.host")}},slot:"overlay"},[e._l(e.commonConfigs,(function(t){return[a("a-menu-item",{key:t,attrs:{value:t}},[e._v(" "+e._s(t)+" ")])]}))],2):e._e()],1)],1)],1),a("div",{staticClass:"global-setting-sub-title"},[e._v(" 个人配置 "),a("span",{staticStyle:{"font-size":"10px",color:"firebrick"}},[a("a-icon",{attrs:{type:"alert",theme:"twoTone"}}),e._v(" 仅在当前用户测试case时生效 ")],1)]),a("a-form-model",{ref:"userConfigSettingForm",refInFor:!0,attrs:{model:e.testGroup,"label-col":e.labelCol,"wrapper-col":e.wrapperCol}},[a("a-form-model-item",{ref:"realHost",refInFor:!0,attrs:{label:"目标地址:",prop:"userConfig.realHost"}},[a("a-dropdown",{attrs:{trigger:["click"]}},[a("a-input",{staticStyle:{width:"100%"},attrs:{placeholder:"目标服务地址；域名或IP:端口，多个英文分号分隔"},model:{value:e.testGroup.userConfig.realHost,callback:function(t){e.$set(e.testGroup.userConfig,"realHost",t)},expression:"testGroup.userConfig.realHost"}},[a("a-tooltip",{attrs:{slot:"addonAfter"},slot:"addonAfter"},[a("template",{slot:"title"},[e._v(" 保存到[公共配置]-[常用地址] ")]),a("a-icon",{attrs:{type:"arrow-right"},on:{click:function(t){return t.stopPropagation(),e.saveToCommonAddress(e.testGroup.userConfig.realHost,1)}}})],2)],1),e.personConfigs.length?a("a-menu",{staticStyle:{"max-height":"300px",overflow:"auto"},attrs:{slot:"overlay"},on:{click:function(t){return e.handleAddress(e.testGroup.userConfig.realHost,t.key,"testGroup.userConfig.realHost")}},slot:"overlay"},[e._l(e.personConfigs,(function(t){return[a("a-menu-item",{key:t,attrs:{value:t}},[e._v(" "+e._s(t)+" ")])]}))],2):e._e()],1)],1),a("a-form-model-item",{ref:"host",refInFor:!0,attrs:{label:"HOST:",prop:"userConfig.host"}},[a("a-dropdown",{attrs:{trigger:["click"]}},[a("a-input",{staticStyle:{width:"100%"},attrs:{placeholder:"目标服务地址；域名或IP:端口，多个英文分号分隔"},model:{value:e.testGroup.userConfig.host,callback:function(t){e.$set(e.testGroup.userConfig,"host",t)},expression:"testGroup.userConfig.host"}},[a("a-tooltip",{attrs:{slot:"addonAfter"},slot:"addonAfter"},[a("template",{slot:"title"},[e._v(" 保存到[公共配置]-[常用地址] ")]),a("a-icon",{attrs:{type:"arrow-right"},on:{click:function(t){return t.stopPropagation(),e.saveToCommonAddress(e.testGroup.userConfig.host,1)}}})],2)],1),e.personConfigs.length?a("a-menu",{staticStyle:{"max-height":"300px",overflow:"auto"},attrs:{slot:"overlay"},on:{click:function(t){return e.handleAddress(e.testGroup.userConfig.host,t.key,"testGroup.userConfig.host")}},slot:"overlay"},[e._l(e.personConfigs,(function(t){return[a("a-menu-item",{key:t,attrs:{value:t}},[e._v(" "+e._s(t)+" ")])]}))],2):e._e()],1)],1)],1)],1):e._e(),2===t.id?a("div",{staticClass:"setting-content"},[a("div",{staticClass:"global-setting-sub-title"},[e._v(" 公共配置 ")]),a("a-form-model",{ref:"publicSettingForm",refInFor:!0,attrs:{model:e.testGroup,"label-col":e.labelCol,"wrapper-col":e.wrapperCol}},[a("a-form-model-item",{ref:"realHost",refInFor:!0,attrs:{label:"zookeeper:",prop:"zkPath"}},[a("a-input",{attrs:{disabled:e.saveButtonShow,placeholder:"如：zookeeper://10.95.126.125:61003"},model:{value:e.testGroup.zkPath,callback:function(t){e.$set(e.testGroup,"zkPath",t)},expression:"testGroup.zkPath"}})],1),a("a-form-model-item",{ref:"host",refInFor:!0,attrs:{label:"registerPath:",prop:"registerPath"}},[a("a-input",{attrs:{disabled:e.saveButtonShow,placeholder:"如：register/10.48.55.162"},model:{value:e.testGroup.registerPath,callback:function(t){e.$set(e.testGroup,"registerPath",t)},expression:"testGroup.registerPath"}})],1)],1),a("div",{staticClass:"global-setting-sub-title"},[e._v(" 个人配置 "),a("span",{staticStyle:{"font-size":"10px",color:"firebrick"}},[a("a-icon",{attrs:{type:"alert",theme:"twoTone"}}),e._v(" 仅在当前用户测试case时生效 ")],1)]),a("a-form-model",{ref:"userConfigSettingForm",refInFor:!0,attrs:{model:e.testGroup,"label-col":e.labelCol,"wrapper-col":e.wrapperCol}},[a("a-form-model-item",{ref:"realHost",refInFor:!0,attrs:{label:"zookeeper:",prop:"userConfig.zkPath"}},[a("a-input",{attrs:{placeholder:"如：zookeeper://10.95.126.125:61003"},model:{value:e.testGroup.userConfig.zkPath,callback:function(t){e.$set(e.testGroup.userConfig,"zkPath",t)},expression:"testGroup.userConfig.zkPath"}})],1),a("a-form-model-item",{ref:"host",refInFor:!0,attrs:{label:"registerPath:",prop:"userConfig.registerPath"}},[a("a-input",{attrs:{placeholder:"如：register/10.48.55.162"},model:{value:e.testGroup.userConfig.registerPath,callback:function(t){e.$set(e.testGroup.userConfig,"registerPath",t)},expression:"testGroup.userConfig.registerPath"}})],1)],1)],1):e._e(),3===t.id?a("div",{staticClass:"setting-content"},[a("div",{staticClass:"global-setting-sub-title"},[e._v(" case默认信息设置 ")]),a("a-form-model",{ref:"publicSettingForm",refInFor:!0,attrs:{model:e.testGroup,"label-col":e.labelCol,"wrapper-col":e.wrapperCol}},[a("a-form-model-item",{ref:"apiOpName",refInFor:!0,attrs:{label:"Op默认名称:",prop:"caseDefaultSet.apiOpName"}},[a("a-input",{attrs:{placeholder:"选填，不填则默认Operation",disabled:e.saveButtonShow},model:{value:e.testGroup.caseDefaultSet.apiOpName,callback:function(t){e.$set(e.testGroup.caseDefaultSet,"apiOpName",t)},expression:"testGroup.caseDefaultSet.apiOpName"}})],1)],1),a("div",{staticClass:"global-setting-sub-title"},[e._v(" case存储条件设置 ")]),a("a-form-model",{ref:"publicSettingForm",refInFor:!0,attrs:{model:e.testGroup,"label-col":e.labelCol,"wrapper-col":e.wrapperCol}},[a("a-form-model-item",{ref:"ifConstraintSaveCase",refInFor:!0,attrs:{label:"是否开启存储条件约束:",prop:"caseDefaultSet.ifConstraintSaveCase"}},[a("a-switch",{attrs:{"checked-children":"启用","un-checked-children":"停用",disabled:e.saveButtonShow,"default-checked":""},model:{value:e.testGroup.ifConstraintSaveCase,callback:function(t){e.$set(e.testGroup,"ifConstraintSaveCase",t)},expression:"testGroup.ifConstraintSaveCase"}})],1)],1),a("div",{staticStyle:{margin:"5px 60px"}},e._l(e.conditionType,(function(t,i){return a("label",{key:i},[a("a-checkbox",{attrs:{value:t.id,disabled:e.saveButtonShow},model:{value:t.checked,callback:function(a){e.$set(t,"checked",a)},expression:"type.checked"}},[e._v(" "+e._s(t.name)+" ")])],1)})),0),a("div",{staticClass:"global-setting-sub-title"},[e._v(" case测试条件设置 ")]),a("a-form-model",{ref:"publicSettingForm",refInFor:!0,attrs:{model:e.testGroup,"label-col":e.labelCol,"wrapper-col":e.wrapperCol}},[a("a-form-model-item",{ref:"detectWithDebug",refInFor:!0,attrs:{label:"是否开启用例检测约束测试:",prop:"caseDefaultSet.detectWithDebug"}},[a("a-switch",{attrs:{"checked-children":"启用","un-checked-children":"停用",disabled:e.saveButtonShow,"default-checked":""},model:{value:e.testGroup.detectWithDebug,callback:function(t){e.$set(e.testGroup,"detectWithDebug",t)},expression:"testGroup.detectWithDebug"}})],1)],1)],1):e._e(),4===t.id?a("div",{staticClass:"setting-content"},[a("div",{staticStyle:{margin:"20px"}},[a("span",{staticStyle:{display:"inline-block",width:"100px"}},[e._v("配置环境: ")]),a("a-switch",{attrs:{"checked-children":"线上","un-checked-children":"线下","default-checked":""},model:{value:e.testGroup.userConfig.online,callback:function(t){e.$set(e.testGroup.userConfig,"online",t)},expression:"testGroup.userConfig.online"}}),a("span",{staticStyle:{"font-size":"10px",color:"firebrick","margin-left":"10px"}},[a("a-icon",{attrs:{type:"alert",theme:"twoTone"}}),e._v(" 仅在当前用户测试case时生效 ")],1)],1),a("div",{directives:[{name:"show",rawName:"v-show",value:e.testGroup.userConfig.online,expression:"testGroup.userConfig.online"}],staticStyle:{margin:"20px"}},[a("span",{staticStyle:{display:"inline-block",width:"100px"}},[e._v("sql校验: ")]),a("a-switch",{attrs:{"checked-children":"统一关闭","un-checked-children":"正常执行",disabled:e.saveButtonShow,"default-checked":""},model:{value:e.testGroup.userConfig.needSqlVerify,callback:function(t){e.$set(e.testGroup.userConfig,"needSqlVerify",t)},expression:"testGroup.userConfig.needSqlVerify"}})],1),a("div",{staticStyle:{margin:"20px"}},[a("span",{staticStyle:{display:"inline-block",width:"100px"}},[e._v("公共数据库: ")]),a("a-select",{staticStyle:{width:"80%"},attrs:{mode:"multiple",disabled:e.saveButtonShow,"filter-option":e.filterOption},model:{value:e.selectedValues,callback:function(t){e.selectedValues=t},expression:"selectedValues"}},e._l(e.databases,(function(t){return a("a-select-option",{key:t.id.toString()},[e._v(" "+e._s(t.name)+" ")])})),1)],1),a("div",{staticStyle:{margin:"20px"}},[a("span",{staticStyle:{display:"inline-block",width:"100px"}},[e._v("个人数据库: ")]),a("a-select",{staticStyle:{width:"80%"},attrs:{mode:"multiple","filter-option":e.filterOption},model:{value:e.selectedPersonValues,callback:function(t){e.selectedPersonValues=t},expression:"selectedPersonValues"}},e._l(e.databases,(function(t){return a("a-select-option",{key:t.id.toString()},[e._v(" "+e._s(t.name)+" ")])})),1)],1),a("div",{staticStyle:{margin:"20px"}},[a("div",{staticStyle:{display:"flex"}},[a("span",[e._v("默认权限信息: ")]),a("a-radio-group",{staticStyle:{"margin-bottom":"10px","margin-left":"20px"},attrs:{disabled:e.saveButtonShow},on:{change:e.onChangeAuthInfo},model:{value:e.loginType,callback:function(t){e.loginType=t},expression:"loginType"}},[a("a-radio",{key:-1,attrs:{value:-1}},[e._v(" 无 ")]),e._l(e.authTypes,(function(t){return a("a-radio",{key:t.id,attrs:{value:t.id}},[e._v(" "+e._s(t.name)+" ")])}))],2)],1),e.showAuthList?a("div",[a("span",{staticStyle:{display:"inline-block",width:"100px"}}),a("a-select",{staticStyle:{width:"80%"},attrs:{disabled:e.saveButtonShow},on:{change:e.selectChange},model:{value:e.testGroup.defaultLogin,callback:function(t){e.$set(e.testGroup,"defaultLogin",t)},expression:"testGroup.defaultLogin"}},e._l(e.loginInfo,(function(t){return a("a-select-option",{key:t.id},[e._v(" "+e._s(t.name)+" ")])})),1)],1):e._e()])]):e._e(),5===t.id?a("div",{staticClass:"setting-content"},[a("div",{staticStyle:{"margin-bottom":"10px"}},[a("span",{staticStyle:{display:"inline-block",width:"110px"}},[e._v("执行前等待时间:")]),a("a-input",{staticStyle:{width:"60%"},attrs:{disabled:e.saveButtonShow,placeholder:"秒"},model:{value:e.testGroup.timeSlot.before,callback:function(t){e.$set(e.testGroup.timeSlot,"before",t)},expression:"testGroup.timeSlot.before"}})],1),a("div",{staticStyle:{"margin-bottom":"10px"}},[a("span",{staticStyle:{display:"inline-block",width:"110px"}},[e._v("执行后等待时间:")]),a("a-input",{staticStyle:{width:"60%"},attrs:{disabled:e.saveButtonShow,placeholder:"秒"},model:{value:e.testGroup.timeSlot.after,callback:function(t){e.$set(e.testGroup.timeSlot,"after",t)},expression:"testGroup.timeSlot.after"}})],1),a("div",{staticStyle:{"margin-bottom":"10px"}},[a("span",{staticStyle:{display:"inline-block",width:"110px"}},[e._v("断言前等待时间:")]),a("a-input",{staticStyle:{width:"60%"},attrs:{disabled:e.saveButtonShow,placeholder:"秒"},model:{value:e.testGroup.timeSlot.verifywaittime,callback:function(t){e.$set(e.testGroup.timeSlot,"verifywaittime",t)},expression:"testGroup.timeSlot.verifywaittime"}})],1),a("div",{staticStyle:{"margin-bottom":"10px"}},[a("span",{staticStyle:{display:"inline-block",width:"110px"}},[e._v("sql断言轮询时间:")]),a("a-input",{staticStyle:{width:"60%"},attrs:{disabled:e.saveButtonShow,placeholder:"秒"},model:{value:e.testGroup.timeSlot.sqlPollingTime,callback:function(t){e.$set(e.testGroup.timeSlot,"sqlPollingTime",t)},expression:"testGroup.timeSlot.sqlPollingTime"}})],1)]):e._e(),6===t.id?a("div",{staticStyle:{"max-height":"750px",overflow:"auto"}},[a("div",{staticStyle:{margin:"10px"}},[e.showSysKey?a("a-alert",{attrs:{type:"success"}},[a("p",{attrs:{slot:"message"},slot:"message"},[e._v(" HTTP_REQUEST_TIMEOUT：针对http请求的timeout自定义配置点， 可以在全局配置的变量中建立名为“HTTP_REQUEST_TIMEOUT”的key， 并设置值，单位ms。如果不设置默认timeout时间是：60000 ms。"),a("br"),e._v(" HTTP_REQUEST_RETRY_TIME：针对case的失败重试次数自定义配置点， 可以在全局配置的变量中建立名为“HTTP_REQUEST_RETRY_TIME”的key， 并设置整数值。如果不设置默认不会重试，设置后，在测试计划运行时生效，case调试不生效。 ")])]):e._e()],1),a("a-collapse",[a("a-collapse-panel",{attrs:{header:"全局参数列表"}},[a("a",{staticStyle:{display:"inline-block",margin:"0 0 10px 10px"},on:{click:function(t){return e.addParams(e.vars)}}},[e._v(" 新增参数 ")]),a("div",[a("a-table",{attrs:{columns:e.selfDefineColumns,"data-source":e.vars,"row-key":function(e){return e.index},pagination:!1},scopedSlots:e._u([{key:"key",fn:function(t,i){return a("a-input",{staticStyle:{border:"none",padding:"0px"},attrs:{disabled:i.isShow,placeholder:"KEY"},model:{value:i.key,callback:function(t){e.$set(i,"key",t)},expression:"record.key"}})}},{key:"globalValue",fn:function(t,i){return a("a-input",{staticStyle:{border:"none",padding:"0px"},attrs:{disabled:i.isShow,placeholder:"VALUE"},model:{value:i.globalValue,callback:function(t){e.$set(i,"globalValue",t)},expression:"record.globalValue"}})}},{key:"onlineValue",fn:function(t,i){return a("a-input",{staticStyle:{border:"none",padding:"0px"},attrs:{disabled:i.isShow,placeholder:"VALUE"},model:{value:i.onlineValue,callback:function(t){e.$set(i,"onlineValue",t)},expression:"record.onlineValue"}})}},{key:"options",fn:function(t,i,s){return a("span",{},[a("a",{attrs:{disabled:e.saveButtonShow},on:{click:function(t){return e.removeItem(s,e.vars)}}},[e._v(" 移除 ")])])}}],null,!0)})],1)])],1),e._l(e.leafSuite,(function(t,i){return a("div",{key:i},[a("a-collapse",[t.scopeVars?a("a-collapse-panel",{attrs:{header:t.text}},[a("a",{staticStyle:{display:"inline-block",margin:"0 0 10px 10px"},attrs:{disabled:e.saveButtonShow},on:{click:function(a){return e.addParams(t.scopeVars)}}},[e._v(" 新增参数 ")]),a("a-table",{attrs:{columns:e.selfDefineColumns,"data-source":t.scopeVars,"row-key":function(e){return e.index},pagination:!1},scopedSlots:e._u([{key:"key",fn:function(t,i){return a("a-input",{staticStyle:{border:"none",padding:"0px"},attrs:{disabled:e.saveButtonShow,placeholder:"KEY"},model:{value:i.key,callback:function(t){e.$set(i,"key",t)},expression:"record.key"}})}},{key:"globalValue",fn:function(t,i){return a("a-input",{staticStyle:{border:"none",padding:"0px"},attrs:{disabled:e.saveButtonShow,placeholder:"VALUE"},model:{value:i.globalValue,callback:function(t){e.$set(i,"globalValue",t)},expression:"record.globalValue"}})}},{key:"onlineValue",fn:function(t,i){return a("a-input",{staticStyle:{border:"none",padding:"0px"},attrs:{disabled:e.saveButtonShow,placeholder:"VALUE"},model:{value:i.onlineValue,callback:function(t){e.$set(i,"onlineValue",t)},expression:"record.onlineValue"}})}},{key:"options",fn:function(i,s,n){return a("span",{},[a("a",{attrs:{disabled:e.saveButtonShow},on:{click:function(a){return e.removeItem(n,t.scopeVars)}}},[e._v(" 移除 ")])])}}],null,!0)})],1):e._e()],1)],1)}))],2):e._e()]):e._e()})),1)],1)],1),a("div",{staticClass:"global-setting-footer"},[e.saveButtonShow?e._e():a("a-button",{staticStyle:{width:"100px"},attrs:{type:"primary"},on:{click:function(){e.moreSettingVisible=!0}}},[e._v(" 更多配置 "),a("a-icon",{attrs:{type:"setting"}})],1),a("a-button",{staticClass:"save-button",staticStyle:{width:"100px","margin-left":"10px"},attrs:{type:"primary"},on:{click:function(t){return e.ok()}}},[e._v(" 保存 "),a("a-icon",{attrs:{type:"save"}})],1)],1),a("a-modal",{attrs:{width:"30%",title:"更多设置","ok-text":"保存","cancel-text":"取消"},on:{destroyOnClose:e.destroyOnClose,ok:e.hideModal},model:{value:e.moreSettingVisible,callback:function(t){e.moreSettingVisible=t},expression:"moreSettingVisible"}},e._l(e.tabData,(function(t){return a("div",{key:t.id},[a("a-checkbox",{model:{value:t.checked,callback:function(a){e.$set(t,"checked",a)},expression:"item.checked"}},[e._v(" "+e._s(t.title)+" ")])],1)})),0)],1):e._e()},sa=[];a("fb6a"),a("6c57");function na(e,t){var a=[];for(var i in e)if({}.hasOwnProperty.call(e,i)){var s={key:i,globalValue:e[i],isShow:!1};a.push(s)}for(var n in t)if({}.hasOwnProperty.call(t,n)){var o=a;for(var r in o)o[r].key===n&&Object.assign(o[r],{onlineValue:t[n]})}return a}var oa=[{id:0,name:"必有测试用途",checked:!1},{id:1,name:"必有断言",checked:!1}];var ra=function(e){return Object(y["a"])({url:"/itp/database?productId=".concat(e),method:"GET"})},ca=a("1d91"),la=function(e){return Object(y["a"])({url:"/itp/tasktrackergroup?productId=".concat(e),method:"GET"})},da=function(e){return Object(y["a"])({url:"/itp/user/product/".concat(e),method:"GET"})},ua=function(e){return Object(y["a"])({url:"/itp/testgroup/".concat(e),method:"GET"})},pa={data:function(){return{testGroup:null,vars:[],ExistVersion:[],conditionType:[],constraintConditionTypes:oa,authTypes:qe["i"],constraintTypes:[],databases:[],selectedValues:[],selectedPersonValues:[],loginInfoList:[],loginType:-1,showAuthList:void 0,loginInfo:[],machineGroups:[],selectedNodeInfo:{activeNodeType:void 0,suiteId:void 0},leafSuite:[],authArray:[],saveButtonShow:!1,disableScopeVars:void 0,commonConfigs:[],personConfigs:[],labelCol:{span:4},wrapperCol:{span:10},wrapperCol2:{span:16},isEdit:!1,versionInputVisible:!1,newVersionName:"",defaultLogin:"",showSysKey:!1,selfDefineColumns:[{title:"KEY",dataIndex:"key",align:"left",width:"15%",scopedSlots:{customRender:"key"}},{title:"globalValue",dataIndex:"globalValue",align:"left",width:"40%",scopedSlots:{customRender:"globalValue"},ellipsis:!0},{title:"onlineValue",dataIndex:"onlineValue",align:"left",width:"39%",scopedSlots:{customRender:"onlineValue"},ellipsis:!0},{title:"options",align:"center",width:"6%",scopedSlots:{customRender:"options"}}],tabData:[{title:"目标地址",id:1,checked:!1},{title:"StargateRPC",id:2,checked:!1},{title:"用例设置",id:3,checked:!1},{title:"数据库&权限",id:4,checked:!1},{title:"操作等待时间",id:5,checked:!1},{title:"自定义参数",id:6,checked:!1}],moreSettingVisible:!1,settingPopoverVisible:void 0}},computed:Object(l["a"])({},Object(d["b"])({currentSelectNode:function(e){return e.treenode.currentSelectTreeNode},currentSuite:function(e){return e.treenode.currentSuite},userName:function(e){return e.user.name}})),watch:{},mounted:function(){var e=window.localStorage.getItem("settingPopoverVisible")||"";this.settingPopoverVisible="isKnow"!==e},methods:{filterOption:function(e,t){return t.componentOptions.children[0].text.toLowerCase().indexOf(e.toLowerCase())>=0},handleKnow:function(){window.localStorage.setItem("settingPopoverVisible","isKnow"),this.settingPopoverVisible=!1},saveToCommonAddress:function(e,t){var a=this;if(e.indexOf("；")>-1)this.$message.warn("请使用英文逗号分隔！");else{var i=[],s=[];e.indexOf(";")>-1?i=e.split(";"):i.push(e);for(var n=0;n<i.length;n++)""!==i[n]&&s.push(i[n]);for(var o=!1,r=function(e){var i={};if(s[e].indexOf(":")>-1)if(s[e].indexOf("http")>-1){var n=s[e].split(":");i={address:n[1].split("//")[1],port:n[2],userName:a.userName,flag:t}}else{var r=s[e].split(":");i={address:r[0],port:r[1],userName:a.userName,flag:t}}else i={address:s[e],userName:a.userName,flag:t};Object(Ot["F"])(i,a.$route.query.productId).then((function(t){t.status&&(o=!0,a.$message.error("".concat(s[e],"保存失败！")))})).catch()},c=0;c<s.length;c++)r(c);o||this.$message.success("保存成功！"),this.getCommonAddress(t)}},handleAddress:function(e,t,a){if(e.indexOf("；")>-1)this.$message.warn("请使用英文逗号分隔！");else switch(a){case"testGroup.realHost":e.length&&";"===e[e.length-1]||!e.length?this.testGroup.realHost+=t+";":this.testGroup.realHost+=";"+t+";";break;case"testGroup.host":e.length&&";"===e[e.length-1]||!e.length?this.testGroup.host+=t+";":this.testGroup.host+=";"+t+";";break;case"testGroup.userConfig.realHost":e.length&&";"===e[e.length-1]||!e.length?this.testGroup.userConfig.realHost+=t+";":this.testGroup.userConfig.realHost+=";"+t+";";break;case"testGroup.userConfig.host":e.length&&";"===e[e.length-1]||!e.length?this.testGroup.userConfig.host+=t+";":this.testGroup.userConfig.host+=";"+t+";";break}},ok:function(){var e=this;-1===this.loginType&&(this.testGroup.defaultLogin=0);var t="";this.selectedValues.forEach((function(e){t=t+e+","}));var a="";this.selectedPersonValues.forEach((function(e){a=a+e+","})),this.testGroup.userConfig.databaseId=a.slice(0,a.length-1);for(var i={},s={},n=0;n<this.vars.length;n++)null!=this.vars[n].key&&""!==this.vars[n].key&&(i[this.vars[n].key]=this.vars[n].globalValue,s[this.vars[n].key]=this.vars[n].onlineValue);for(var o="",r=0;r<this.conditionType.length;r++)""===o&&this.conditionType[r].checked?o+=this.conditionType[r].id:this.conditionType[r].checked&&(o=o+","+this.conditionType[r].id);var c={host:this.testGroup.host,realHost:this.testGroup.realHost,defaultLogin:this.testGroup.defaultLogin,defaultDatabase:t.slice(0,t.length-1),machineGroup:this.testGroup.machineGroup,globalVars:JSON.stringify(i),onlineVars:JSON.stringify(s),timeSlot:JSON.stringify(this.testGroup.timeSlot),zkPath:this.testGroup.zkPath,registerPath:this.testGroup.registerPath,userConfig:this.testGroup.userConfig,ifExtraVersion:this.testGroup.ifExtraVersion,ifConstraintSaveCase:this.testGroup.ifConstraintSaveCase,detectWithDebug:this.testGroup.detectWithDebug,constraintTypes:o,caseDefaultSet:JSON.stringify(this.testGroup.caseDefaultSet)};if(Object(b["x"])(this.$route.params.id,c).then((function(t){t.status?e.$message.error(t.message||"保存失败，请重试！"):e.$message.success("保存成功！")})).catch(),"root"===this.currentSuite.data.type||"suite"===this.currentSuite.data.type){var l=this.leafSuite;for(var d in l){var u=l[d].scopeVars,p={},h={};for(var f in u)null!=u[f].key&&""!==u[f].key&&(p[u[f].key]=u[f].globalValue,h[u[f].key]=u[f].onlineValue);var y={globalVars:JSON.stringify(p),onlineVars:JSON.stringify(h)};Object(m["P"])(y,{id:l[d].id,typeTag:"suite"}).then().catch()}}},addParams:function(e){e.unshift({key:"",globalValue:"",onlineValue:"",isShow:!1,index:e[e.length-1].index++})},removeItem:function(e,t){t.splice(e,1)},clickKeyOrValue:function(e,t){e===t.length-1&&t.push({key:"",value:""})},getSystemKeyTipTitle:function(){var e=this.showSysKey?"关闭":"查看",t="点击"+e+"系统预留参数";return t},selectChange:function(e){this.testGroup.defaultLogin=e},onChangeAuthInfo:function(e){this.loginType=+e.target.value,-1===this.loginType?this.showAuthList=!1:(0!==this.loginInfoList[this.loginType].length?this.testGroup.defaultLogin=this.loginInfoList[this.loginType][0].id:this.testGroup.defaultLogin="",this.loginInfo=this.loginInfoList[this.loginType],this.showAuthList=!0)},showInput:function(){this.versionInputVisible=!0,this.newVersionName=""},handleInputConfirm:function(){var e=this;this.versionInputVisible=!1,this.verifyVersion(this.newVersionName)&&(this.newVersionName?qt({name:this.newVersionName,groupId:this.testGroup.id,productId:this.testGroup.productId}).then((function(t){t.status||e.ExistVersion.push({groupId:e.testGroup.id,id:t.data,name:e.newVersionName,productId:e.testGroup.productId,isEdit:!1})})).catch((function(e){})):this.$message.warn("版本名称不能为空！"))},cancleEditVersion:function(e){this.$set(e,"isEdit",!1),this.$forceUpdate()},verifyVersion:function(e){for(var t=0;t<this.ExistVersion.length;t++)if(this.ExistVersion[t].name===e)return this.$message.warn("现存版本中，已经存在当前版本，请确认后重新输入！"),!1;return!0},saveEditVersion:function(e){var t=this;jt(e.id,{id:e.id,name:e.name}).then((function(e){e.status||t.requestVersionList(t.testGroup.id)})).catch()},dbclickEdit:function(e){var t=this;this.$set(e,"isEdit",!0),this.$forceUpdate(),this.$nextTick((function(){t.$refs["version".concat(e.id)][0].focus()}))},deleteVersion:function(e){var t=this;this.$confirm({title:"提示",content:"确定要删除【".concat(e.name,"】,删除版本后索引该版本的case将删除"),onOk:function(){At(e.id).then((function(e){e.status||t.requestVersionList(t.testGroup.id)})).catch((function(e){}))},onCancel:function(){}})},open:function(){this.queryTestGroup(),this.requestAuthor(),this.getCommonAddress(0),this.getCommonAddress(1);try{setTimeout((function(){Object(xe["a"])({key:"save-button"}).setOptions({doneLabel:"知道了",prevLabel:"上一个",nextLabel:"下一个",exitOnOverlayClick:!1,exitOnEsc:!1,steps:[{element:document.querySelector(".save-button"),intro:"修改&添加公共配置记得点击这里保存哦~"}]}).start()}),1e3)}catch(e){}},getAuthorityMerberList:function(e){var t=this;return Object(o["a"])(regeneratorRuntime.mark((function a(){return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:return a.next=2,da(e).then((function(e){if(!e.status){var a=e.data;t.authArray=[];for(var i=a.admin.slice(0,3)||[],s=0;s<i.length;s++)t.authArray=t.authArray+i[s].user,s!==i.length-1&&(t.authArray+=",")}})).catch((function(e){}));case 2:case"end":return a.stop()}}),a)})))()},getGlobalAuthorityList:function(e){var t=this;return Object(o["a"])(regeneratorRuntime.mark((function a(){return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:return a.next=2,ua(e).then((function(e){if(!e.status){var a=e.data;t.saveButtonShow=!1;var i=a.globalNoAuth;if(i.indexOf(t.userName)>-1)for(var s in t.saveButtonShow=!0,t.vars)({}).hasOwnProperty.call(t.vars,s)&&(t.vars[s].isShow=!0)}})).catch((function(e){}));case 2:case"end":return a.stop()}}),a)})))()},requestAuthor:function(){this.getAuthorityMerberList(this.$route.query.productId),this.getGlobalAuthorityList(this.$route.params.id)},getCommonAddress:function(e){var t=this;return Object(o["a"])(regeneratorRuntime.mark((function a(){var i;return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:return i=[],a.next=3,Object(Ot["t"])(t.$route.query.productId,e).then((function(a){if(!a.status){for(var s="",n=a.data,o=0;o<n.length;o++)s=n[o].port?n[o].address+":"+n[o].port:n[o].address,i.push(s);e?t.personConfigs=i:t.commonConfigs=i}})).catch((function(e){}));case 3:case"end":return a.stop()}}),a)})))()},requestVersionList:function(e){var t=this;return Object(o["a"])(regeneratorRuntime.mark((function a(){return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:return a.next=2,Pt(e).then((function(e){e.status||(t.ExistVersion=e.data,t.ExistVersion.forEach((function(e){e=Object.assign(e,{isEdit:!1})})))})).catch((function(e){}));case 2:case"end":return a.stop()}}),a)})))()},getDataBases:function(e){var t=this;return Object(o["a"])(regeneratorRuntime.mark((function a(){return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:return a.next=2,ra(e).then((function(e){if(!e.status){t.databases=e.data;var a=t.testGroup.defaultDatabase.split(","),i=t.testGroup.userConfig.databaseId.split(",");t.selectedValues=[],t.selectedPersonValues=[];for(var s=0;s<a.length;s++)for(var n=0;n<t.databases.length;n++)+t.databases[n].id===+a[s]&&t.selectedValues.push(t.databases[n].id.toString());for(var o=0;o<i.length;o++)for(var r=0;r<t.databases.length;r++)+t.databases[r].id===+i[o]&&t.selectedPersonValues.push(t.databases[r].id.toString())}})).catch((function(e){}));case 2:case"end":return a.stop()}}),a)})))()},getLoginInfos:function(e){var t=this;return Object(o["a"])(regeneratorRuntime.mark((function a(){return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:return a.next=2,Object(ca["b"])(e).then((function(e){if(!e.status){var a=e.data;t.loginType=-1;for(var i=[],s=[],n=[],o=[],r=[],c=[],l=[],d=[],u=[],p=[],h=[],f=0;f<a.length;f++)switch(+a[f].type){case 0:i||(i=[]),i.push(a[f]);break;case 1:s||(s=[]),s.push(a[f]);break;case 2:n||(n=[]),n.push(a[f]);break;case 3:o||(o=[]),o.push(a[f]);break;case 4:r||(r=[]),r.push(a[f]);break;case 5:c||(c=[]),c.push(a[f]);break;case 6:l||(l=[]),l.push(a[f]);break;case 7:d||(d=[]),d.push(a[f]);break;case 8:u||(u=[]),u.push(a[f]);break;case 9:p||(p=[]),p.push(a[f]);break;case 10:h||(h=[]),h.push(a[f]);break}if(t.loginInfoList=[],t.loginInfoList.push(i||[]),t.loginInfoList.push(s||[]),t.loginInfoList.push(n||[]),t.loginInfoList.push(o||[]),t.loginInfoList.push(r||[]),t.loginInfoList.push(c||[]),t.loginInfoList.push(l||[]),t.loginInfoList.push(d||[]),t.loginInfoList.push(u||[]),t.loginInfoList.push(p||[]),t.loginInfoList.push(h||[]),0===t.testGroup.defaultLogin)t.showAuthList=!1,t.loginInfo=[];else for(var m=0;m<a.length;m++)if(a[m].id===t.testGroup.defaultLogin){t.loginType=a[m].type,t.loginInfo=t.loginInfoList[a[m].type],t.showAuthList=!0;break}}})).catch((function(e){}));case 2:case"end":return a.stop()}}),a)})))()},getTaskTrackerGroup:function(e){var t=this;return Object(o["a"])(regeneratorRuntime.mark((function a(){return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:return a.next=2,la(e).then((function(e){e.status||(t.machineGroups=e.data)})).catch((function(e){}));case 2:case"end":return a.stop()}}),a)})))()},querySuiteNode:function(e){var t=this;return Object(o["a"])(regeneratorRuntime.mark((function a(){return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:return a.next=2,Object(m["F"])(e).then((function(e){if(!e.status){var a=e.data,i=JSON.parse(a.globalVars),s=JSON.parse(a.onlineVars),n=na(i,s);null!==n&&0!==n.length||n.push({key:"",globalValue:"",onlineValue:"",isShow:!1}),a.scopeVars=n,t.leafSuite=[a];for(var o=0;o<t.leafSuite.length;o++)t.leafSuite[o].scopeVars&&t.addIndex(t.leafSuite[o].scopeVars);t.disableScopeVars=!1}})).catch((function(e){}));case 2:case"end":return a.stop()}}),a)})))()},getListLeafSuite:function(e){var t=this;return Object(o["a"])(regeneratorRuntime.mark((function a(){return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:return a.next=2,Object(m["q"])(e).then((function(e){if(!e.status){var a=e.data;for(var i in a)if({}.hasOwnProperty.call(a,i)){var s=JSON.parse(a[i].globalVars),n=JSON.parse(a[i].onlineVars),o=na(s,n);o&&0!==o.length&&(a[i].scopeVars=o)}t.leafSuite=a,"root"===t.selectedNodeInfo.activeNodeType?globalThis.disableScopeVars=!1:t.disableScopeVars=!0}})).catch((function(e){}));case 2:case"end":return a.stop()}}),a)})))()},addIndex:function(e){for(var t=0;t<e.length;t++)e[t].index=t},queryTestGroup:function(){var e=this;Object(b["q"])(this.$route.params.id).then((function(t){if(!t.status){var a=t.data,i=["before","after","verifywaittime","sqlPollingTime"];if(null==a.timeSlot||""===a.timeSlot)for(var s in a.timeSlot={},i)({}).hasOwnProperty.call(i,s)&&(a.timeSlot[i[s]]="");else for(var n in a.timeSlot=JSON.parse(a.timeSlot),i)null==a.timeSlot[i[n]]&&(a.timeSlot[i[n]]="");var o=["apiOpName"];if(null==a.caseDefaultSet||""===a.caseDefaultSet)for(var r in a.caseDefaultSet={},o)({}).hasOwnProperty.call(o,r)&&(a.caseDefaultSet[o[r]]="");else for(var c in a.caseDefaultSet=JSON.parse(a.caseDefaultSet),o)null==a.caseDefaultSet[o[c]]&&(a.caseDefaultSet[o[c]]="");e.testGroup=a;var l=JSON.parse(a.globalVars||"{}"),d=JSON.parse(a.onlineVars||"{}");e.vars=na(l,d),e.addIndex(e.vars),e.vars.length||e.vars.push({key:"",globalValue:"",onlineValue:"",isShow:!1}),e.requestVersionList(e.testGroup.id),e.conditionType=e.constraintConditionTypes,e.constraintTypes=e.testGroup.constraintTypes.split(",");for(var u=0;u<e.conditionType.length;u++){e.conditionType[u].checked=!1;for(var p=0;p<e.constraintTypes.length;p++)if(e.constraintTypes[p].toString()===e.conditionType[u].id.toString()){e.conditionType[u].checked=!0;break}}if(e.getDataBases(e.testGroup.productId),e.getLoginInfos(e.testGroup.productId),e.getTaskTrackerGroup(e.testGroup.productId),e.selectedNodeInfo.activeNodeType=["setup","teardown"].indexOf(e.currentSelectNode.data.type)>-1?"suite":e.currentSelectNode.data.type,e.selectedNodeInfo.suiteId=e.currentSuite.data.id,"root"!==e.selectedNodeInfo.activeNodeType){var h={id:e.selectedNodeInfo.suiteId,typeTag:"suite",versionId:""};e.querySuiteNode(h)}else e.getListLeafSuite(e.$route.params.id);var f=JSON.parse(a.globalType);f.forEach((function(t){e.tabData.forEach((function(e){e.id===t&&(e.checked=!0)}))}))}})).catch((function(e){}))},destroyOnClose:function(){this.moreSettingVisible=!1},hideModal:function(){var e=this,t=[];this.tabData.forEach((function(e){e.checked&&t.push(e.id)})),Object(b["s"])({id:this.$route.params.id},{globalType:JSON.stringify(t)}).then((function(t){t.status||e.$message.success("保存成功！")})).catch(),this.moreSettingVisible=!1}}},ha=pa,fa=(a("5997"),Object($["a"])(ha,ia,sa,!1,null,"4700f9b9",null)),ma=fa.exports,ya=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticStyle:{background:"#ECECEC",padding:"10px"}},[e.currentVersion?a("a-card",{attrs:{bordered:!1}},[a("div",{attrs:{slot:"title"},slot:"title"},[a("h3",[e._v("当前版本: "+e._s(e.currentVersion.name))])]),a("a-dropdown",{attrs:{slot:"extra"},slot:"extra"},[a("a",{staticClass:"ant-dropdown-link",on:{click:function(e){return e.preventDefault()}}},[e._v(" 切换版本 "),a("a-icon",{attrs:{type:"down"}})],1),a("a-menu",{attrs:{slot:"overlay"},on:{click:e.changeVersion},slot:"overlay"},[e._l(e.groupExistVersions,(function(t){return[a("a-menu-item",{key:t.id},[e._v(" "+e._s(t.name)+" ")])]}))],2)],1),a("case-group")],1):e._e()],1)},va=[],ga={components:{caseGroup:Wt},data:function(){return{groupExistVersions:[],groupSelectedName:"-1",currentVersion:null}},methods:{getCurrentVersion:function(e){var t=this;this.groupExistVersions.forEach((function(a){+a.id===+e&&(t.currentVersion=a,t.$store.dispatch("setVersionId",t.currentVersion.id),t.$router.push({path:"/testgroup/".concat(t.$route.params.id,"/").concat(t.$route.params.caseId),query:{productId:t.$route.query.productId,versionId:t.currentVersion.id}}))}))},changeVersion:function(e){this.getCurrentVersion(e.key)},open:function(){this.requestVersionGroupList()},requestVersionGroupList:function(){var e=this;return Object(o["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,Pt(e.$route.params.id).then((function(t){if(t.status)e.$message.error(t.message);else{var a=t.data;e.groupExistVersions=a;var i="undefined"===typeof e.$route.query.versionId?a[0].id:e.$route.query.versionId;e.groupSelectedName=i,e.getCurrentVersion(e.groupSelectedName)}})).catch();case 2:case"end":return t.stop()}}),t)})))()}}},ba=ga,Sa=Object($["a"])(ba,ya,va,!1,null,"303dcb24",null),ka=Sa.exports,xa={components:{caseGroup:Wt,History:aa,GlobalSetting:ma,VersionControl:ka},data:function(){return{activeKey:"testGroup",recordData:[],showVersionIcon:!0}},mounted:function(){this.$route.query.versionId&&this.handleVersion()},methods:{handleVersion:function(){this.showVersionIcon=!this.showVersionIcon,this.$refs.testGroup.handleVersion()},onChange:function(e){var t=this;this.activeKey=e,"history"===this.activeKey?this.getTestGroupHistory(this.$route.params.id):"globalSetting"===this.activeKey?this.$nextTick((function(){t.$refs.globalSetting.open()})):"testGroup"===this.activeKey&&this.$nextTick((function(){t.$refs.testGroup.open()}))},getTestGroupHistory:function(e,t,a){var i=this;return Object(o["a"])(regeneratorRuntime.mark((function s(){return regeneratorRuntime.wrap((function(s){while(1)switch(s.prev=s.next){case 0:return s.next=2,Object(b["r"])(e,t).then((function(e){var t=e.data;e.message,e.status;i.recordData=t})).catch((function(e){a&&a(e)}));case 2:case"end":return s.stop()}}),s)})))()}}},wa=xa,Ta=(a("53af"),Object($["a"])(wa,s,n,!1,null,"560d4549",null));t["default"]=Ta.exports},"2ca0":function(e,t,a){"use strict";var i=a("23e7"),s=a("06cf").f,n=a("50c4"),o=a("5a34"),r=a("1d80"),c=a("ab13"),l=a("c430"),d="".startsWith,u=Math.min,p=c("startsWith"),h=!l&&!p&&!!function(){var e=s(String.prototype,"startsWith");return e&&!e.writable}();i({target:"String",proto:!0,forced:!h&&!p},{startsWith:function(e){var t=String(r(this));o(e);var a=n(u(arguments.length>1?arguments[1]:void 0,t.length)),i=String(e);return d?d.call(t,i,a):t.slice(a,a+i.length)===i}})},"36f6":function(e,t,a){"use strict";a("b412")},4981:function(e,t,a){},"4b40":function(e,t,a){},"4d7f":function(e,t,a){(function(t){var a,i={},s={16:!1,18:!1,17:!1,91:!1},n="all",o={"⇧":16,shift:16,"⌥":18,alt:18,option:18,"⌃":17,ctrl:17,control:17,"⌘":91,command:91},r={backspace:8,tab:9,clear:12,enter:13,return:13,esc:27,escape:27,space:32,left:37,up:38,right:39,down:40,del:46,delete:46,home:36,end:35,pageup:33,pagedown:34,",":188,".":190,"/":191,"`":192,"-":189,"=":187,";":186,"'":222,"[":219,"]":221,"\\":220},c=function(e){return r[e]||e.toUpperCase().charCodeAt(0)},l=[];for(a=1;a<20;a++)r["f"+a]=111+a;function d(e,t){var a=e.length;while(a--)if(e[a]===t)return a;return-1}function u(e,t){if(e.length!=t.length)return!1;for(var a=0;a<e.length;a++)if(e[a]!==t[a])return!1;return!0}var p={16:"shiftKey",18:"altKey",17:"ctrlKey",91:"metaKey"};function h(e){for(a in s)s[a]=e[p[a]]}function f(e){var t,a,n,r,c,u;if(t=e.keyCode,-1==d(l,t)&&l.push(t),93!=t&&224!=t||(t=91),t in s)for(n in s[t]=!0,o)o[n]==t&&(v[n]=!0);else if(h(e),v.filter.call(this,e)&&t in i)for(u=w(),r=0;r<i[t].length;r++)if(a=i[t][r],a.scope==u||"all"==a.scope){for(n in c=a.mods.length>0,s)(!s[n]&&d(a.mods,+n)>-1||s[n]&&-1==d(a.mods,+n))&&(c=!1);(0!=a.mods.length||s[16]||s[18]||s[17]||s[91])&&!c||!1===a.method(e,a)&&(e.preventDefault?e.preventDefault():e.returnValue=!1,e.stopPropagation&&e.stopPropagation(),e.cancelBubble&&(e.cancelBubble=!0))}}function m(e){var t,a=e.keyCode,i=d(l,a);if(i>=0&&l.splice(i,1),93!=a&&224!=a||(a=91),a in s)for(t in s[a]=!1,o)o[t]==a&&(v[t]=!1)}function y(){for(a in s)s[a]=!1;for(a in o)v[a]=!1}function v(e,t,a){var s,n;s=C(e),void 0===a&&(a=t,t="all");for(var o=0;o<s.length;o++)n=[],e=s[o].split("+"),e.length>1&&(n=_(e),e=[e[e.length-1]]),e=e[0],e=c(e),e in i||(i[e]=[]),i[e].push({shortcut:s[o],scope:t,method:a,key:s[o],mods:n})}function g(e,t){var a,s,n,o,r,l=[];for(a=C(e),o=0;o<a.length;o++){if(s=a[o].split("+"),s.length>1&&(l=_(s),e=s[s.length-1]),e=c(e),void 0===t&&(t=w()),!i[e])return;for(n=0;n<i[e].length;n++)r=i[e][n],r.scope===t&&u(r.mods,l)&&(i[e][n]={})}}function b(e){return"string"==typeof e&&(e=c(e)),-1!=d(l,e)}function S(){return l.slice(0)}function k(e){var t=(e.target||e.srcElement).tagName;return!("INPUT"==t||"SELECT"==t||"TEXTAREA"==t)}for(a in o)v[a]=!1;function x(e){n=e||"all"}function w(){return n||"all"}function T(e){var t,a,s;for(t in i)for(a=i[t],s=0;s<a.length;)a[s].scope===e?a.splice(s,1):s++}function C(e){var t;return e=e.replace(/\s/g,""),t=e.split(","),""==t[t.length-1]&&(t[t.length-2]+=","),t}function _(e){for(var t=e.slice(0,e.length-1),a=0;a<t.length;a++)t[a]=o[t[a]];return t}function N(e,t,a){e.addEventListener?e.addEventListener(t,a,!1):e.attachEvent&&e.attachEvent("on"+t,(function(){a(window.event)}))}N(document,"keydown",(function(e){f(e)})),N(document,"keyup",m),N(window,"focus",y);var O=t.key;function I(){var e=t.key;return t.key=O,e}t.key=v,t.key.setScope=x,t.key.getScope=w,t.key.deleteScope=T,t.key.filter=k,t.key.isPressed=b,t.key.getPressedKeyCodes=S,t.key.noConflict=I,t.key.unbind=g,e.exports=v})(this)},5281:function(e,t,a){},"53af":function(e,t,a){"use strict";a("b48b")},"53ca1":function(e,t,a){"use strict";a("0690")},"53ff":function(e,t,a){e.exports=function(e){var t={};function a(i){if(t[i])return t[i].exports;var s=t[i]={i:i,l:!1,exports:{}};return e[i].call(s.exports,s,s.exports,a),s.l=!0,s.exports}return a.m=e,a.c=t,a.i=function(e){return e},a.d=function(e,t,i){a.o(e,t)||Object.defineProperty(e,t,{configurable:!1,enumerable:!0,get:i})},a.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return a.d(t,"a",t),t},a.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},a.p="",a(a.s=11)}([function(e,t){e.exports=function(e,t,a,i){var s,n=e=e||{},o=typeof e.default;"object"!==o&&"function"!==o||(s=e,n=e.default);var r="function"==typeof n?n.options:n;if(t&&(r.render=t.render,r.staticRenderFns=t.staticRenderFns),a&&(r._scopeId=a),i){var c=r.computed||(r.computed={});Object.keys(i).forEach((function(e){var t=i[e];c[e]=function(){return t}}))}return{esModule:s,exports:n,options:r}}},function(e,t,a){"use strict";function i(){var e=window.getSelection();if(e&&e.rangeCount>0)return e.getRangeAt(0)}t.f=function(e,t){if(e.scrollIntoViewIfNeeded)e.scrollIntoViewIfNeeded(!1);else{var a=e.offsetTop-t.scrollTop;(a<0||a>t.offsetHeight-e.offsetHeight)&&((t=t||e.parentElement).scrollTop=e.offsetTop)}},t.e=function(e){var t=window.getSelection();t&&(t.removeAllRanges(),t.addRange(e))},t.d=i,t.a=function(e,t){return t.map((function(t){return{at:t,index:e.lastIndexOf(t)}})).reduce((function(e,t){return e.index>t.index?e:t}))},t.b=function(e,t){t=t||window;for(var a={top:e.offsetTop,left:e.offsetLeft},i=e.offsetParent;null!=i&&i!=t;)a.left+=i.offsetLeft,a.top+=i.offsetTop,i=i.offsetParent;return a},t.g=function(e,t){do{if(t(e))return e}while(e=e&&e.parentNode)},t.c=function(){var e=i();if(e){var t=e.cloneRange();return t.collapse(!0),t.setStart(t.endContainer,0),t}}},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=a(1),s=a(6),n=a.n(s),o=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var i in a)Object.prototype.hasOwnProperty.call(a,i)&&(e[i]=a[i])}return e};t.default={name:"At",mixins:[n.a],props:{at:{type:String,default:null},ats:{type:Array,default:function(){return["@"]}},suffix:{type:String,default:" "},loop:{type:Boolean,default:!0},allowSpaces:{type:Boolean,default:!0},avoidEmail:{type:Boolean,default:!0},hoverSelect:{type:Boolean,default:!0},members:{type:Array,default:function(){return[]}},nameKey:{type:String,default:""},filterMatch:{type:Function,default:function(e,t,a){return e.toLowerCase().indexOf(t.toLowerCase())>-1}},deleteMatch:{type:Function,default:function(e,t,a){return t===e+a}},scrollRef:{type:String,default:""}},data:function(){return{hasComposition:!1,atwho:null}},computed:{atItems:function(){return this.at?[this.at]:this.ats},style:function(){if(this.atwho){var e=this.atwho,t=(e.list,e.cur,e.x),s=e.y,n=this.$refs.wrap;if(n){var o=a.i(i.b)(n),r=this.scrollRef?document.querySelector(this.scrollRef).scrollLeft:0,c=this.scrollRef?document.querySelector(this.scrollRef).scrollTop:0;return{left:t+r+window.pageXOffset-o.left+"px",top:s+c+window.pageYOffset-o.top+"px"}}}return null}},watch:{"atwho.cur":function(e){var t=this;null!=e&&this.$nextTick((function(){t.scrollToCur()}))},members:function(){this.handleInput(!0)}},methods:{itemName:function(e){var t=this.nameKey;return t?e[t]:e},isCur:function(e){return e===this.atwho.cur},handleItemHover:function(e){this.hoverSelect&&this.selectByMouse(e)},handleItemClick:function(e){this.selectByMouse(e),this.insertItem()},handleDelete:function(e){var t=a.i(i.c)();if(t){var s=this.atItems,n=this.members,o=this.suffix,r=this.deleteMatch,c=this.itemName,l=t.toString(),d=a.i(i.a)(l,s),u=d.at,p=d.index;if(p>-1){var h=l.slice(p+u.length);if(n.some((function(e){var t=c(e);return r(t,h,o)}))){e.preventDefault(),e.stopPropagation();var f=a.i(i.d)();f&&(f.setStart(f.endContainer,p),f.deleteContents(),a.i(i.e)(f),this.handleInput())}}}},handleKeyDown:function(e){var t=this;if(this.atwho){if(38===e.keyCode||40===e.keyCode)return void(e.metaKey||e.ctrlKey||(e.preventDefault(),e.stopPropagation(),this.selectByKeyboard(e)));if(13===e.keyCode)return this.insertItem(),e.preventDefault(),void e.stopPropagation();if(27===e.keyCode)return void this.closePanel()}(e.keyCode>=48&&e.keyCode<=90||8===e.keyCode)&&setTimeout((function(){t.handleInput()}),50),8===e.keyCode&&this.handleDelete(e)},handleCompositionStart:function(){this.hasComposition=!0},handleCompositionEnd:function(){this.hasComposition=!1,this.handleInput()},handleInput:function(e){if(!this.hasComposition){var t=a.i(i.c)();if(t){var s=this.atItems,n=this.avoidEmail,o=this.allowSpaces,r=!0,c=t.toString(),l=a.i(i.a)(c,s),d=l.at,u=l.index;u<0&&(r=!1);var p=c[u-1],h=c.slice(u+d.length,c.length);if(n&&/^[a-z0-9]$/i.test(p)&&(r=!1),!o&&/\s/.test(h)&&(r=!1),/^\s/.test(h)&&(r=!1),r){var f=this.members,m=this.filterMatch,y=this.itemName;!e&&h.length>0&&this.$emit("at",h);var v=f.filter((function(e){var t=y(e);return m(t,h,d)}));v.length?this.openPanel(v,t,u,d):this.closePanel()}else this.closePanel()}}},closePanel:function(){this.atwho&&(this.atwho=null)},openPanel:function(e,t,a,i){var s=this,n=function(){var n=t.cloneRange();n.setStart(n.endContainer,a+i.length);var o=n.getClientRects()[0];s.atwho={range:t,offset:a,list:e,x:o.left,y:o.top-4,cur:0}};this.atwho?n():setTimeout(n,10)},scrollToCur:function(){var e=this.$refs.cur[0],t=e.parentElement.parentElement;a.i(i.f)(e,t)},selectByMouse:function(e){var t=+a.i(i.g)(e.target,(function(e){return e.getAttribute("data-index")})).getAttribute("data-index");this.atwho=o({},this.atwho,{cur:t})},selectByKeyboard:function(e){var t=38===e.keyCode?-1:1,a=this.atwho,i=a.cur,s=a.list,n=this.loop?(i+t+s.length)%s.length:Math.max(0,Math.min(i+t,s.length-1));this.atwho=o({},this.atwho,{cur:n})},insertText:function(e,t){t.deleteContents();var s=t.endContainer;if(s.nodeType===Node.TEXT_NODE){var n=t.endOffset;s.data=s.data.slice(0,n)+e+s.data.slice(n),t.setEnd(s,n+e.length)}else{var o=document.createTextNode(e);t.insertNode(o),t.setEndAfter(o)}t.collapse(!1),a.i(i.e)(t)},insertItem:function(){var e=this.atwho,t=e.range,s=(e.offset,e.list),n=e.cur,o=this.suffix,r=this.atItems,c=this.itemName,l=t.cloneRange(),d=t.toString(),u=a.i(i.a)(d,r),p=u.at,h=u.index+p.length;l.setStart(l.endContainer,h),a.i(i.e)(l),a.i(i.e)(l);var f=c(s[n])+o;this.insertText(f,l),this.handleInput()}}}},function(e,t,a){(e.exports=a(4)()).push([e.i,".atwho-view{color:#000;border-radius:3px;box-shadow:0 0 5px rgba(0,0,0,.1);min-width:120px;z-index:11110!important}.atwho-ul{list-style:none}.atwho-li{display:block}.atwho-view{border-radius:6px;box-shadow:0 0 10px 0 hsla(211,9%,44%,.5)}.atwho-ul{max-height:135px;padding:0;margin:0}.atwho-li{box-sizing:border-box;height:27px;padding:0 12px;white-space:nowrap;display:flex;align-items:center}.atwho-li span{overflow:hidden;text-overflow:ellipsis}.atwho-cur{background:#5bb8ff;color:#fff}.atwho-wrap{position:relative}.atwho-panel{position:absolute}.atwho-inner{position:relative}.atwho-view{position:absolute;bottom:0;left:-.8em;cursor:default;background-color:hsla(0,0%,100%,.94);min-width:140px;max-width:180px;max-height:200px;overflow-y:auto}.atwho-view::-webkit-scrollbar{width:11px;height:11px}.atwho-view::-webkit-scrollbar-track{background-color:#f5f5f5}.atwho-view::-webkit-scrollbar-thumb{min-height:36px;border:2px solid transparent;border-top:3px solid transparent;border-bottom:3px solid transparent;background-clip:padding-box;border-radius:7px;background-color:#c4c4c4}",""])},function(e,t){e.exports=function(){var e=[];return e.toString=function(){for(var e=[],t=0;t<this.length;t++){var a=this[t];a[2]?e.push("@media "+a[2]+"{"+a[1]+"}"):e.push(a[1])}return e.join("")},e.i=function(t,a){"string"==typeof t&&(t=[[null,t,""]]);for(var i={},s=0;s<this.length;s++){var n=this[s][0];"number"==typeof n&&(i[n]=!0)}for(s=0;s<t.length;s++){var o=t[s];"number"==typeof o[0]&&i[o[0]]||(a&&!o[2]?o[2]=a:a&&(o[2]="("+o[2]+") and ("+a+")"),e.push(o))}},e}},function(e,t,a){var i=a(0)(a(2),null,null,null);e.exports=i.exports},function(e,t,a){a(9);var i=a(0)(null,a(7),null,null);e.exports=i.exports},function(e,t){e.exports={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{ref:"wrap",staticClass:"atwho-wrap",on:{compositionstart:e.handleCompositionStart,compositionend:e.handleCompositionEnd,input:function(t){e.handleInput()},keydown:e.handleKeyDown}},[e.atwho?a("div",{staticClass:"atwho-panel",style:e.style},[a("div",{staticClass:"atwho-inner"},[a("div",{staticClass:"atwho-view"},[a("ul",{staticClass:"atwho-ul"},e._l(e.atwho.list,(function(t,i){return a("li",{ref:e.isCur(i)&&"cur",refInFor:!0,staticClass:"atwho-li",class:e.isCur(i)&&"atwho-cur",attrs:{"data-index":i},on:{mouseenter:e.handleItemHover,click:e.handleItemClick}},[e._t("item",[a("span",{domProps:{textContent:e._s(e.itemName(t))}})],{item:t})],2)})))])])]):e._e(),e._v(" "),e._t("default")],2)},staticRenderFns:[]}},function(e,t){var a={},i=function(e){var t;return function(){return void 0===t&&(t=e.apply(this,arguments)),t}},s=i((function(){return/msie [6-9]\b/.test(window.navigator.userAgent.toLowerCase())})),n=i((function(){return document.head||document.getElementsByTagName("head")[0]})),o=null,r=0,c=[];function l(e,t){for(var i=0;i<e.length;i++){var s=e[i],n=a[s.id];if(n){n.refs++;for(var o=0;o<n.parts.length;o++)n.parts[o](s.parts[o]);for(;o<s.parts.length;o++)n.parts.push(p(s.parts[o],t))}else{var r=[];for(o=0;o<s.parts.length;o++)r.push(p(s.parts[o],t));a[s.id]={id:s.id,refs:1,parts:r}}}}function d(e){for(var t=[],a={},i=0;i<e.length;i++){var s=e[i],n=s[0],o={css:s[1],media:s[2],sourceMap:s[3]};a[n]?a[n].parts.push(o):t.push(a[n]={id:n,parts:[o]})}return t}function u(e){var t=document.createElement("style");return t.type="text/css",function(e,t){var a=n(),i=c[c.length-1];if("top"===e.insertAt)i?i.nextSibling?a.insertBefore(t,i.nextSibling):a.appendChild(t):a.insertBefore(t,a.firstChild),c.push(t);else{if("bottom"!==e.insertAt)throw new Error("Invalid value for parameter 'insertAt'. Must be 'top' or 'bottom'.");a.appendChild(t)}}(e,t),t}function p(e,t){var a,i,s;if(t.singleton){var n=r++;a=o||(o=u(t)),i=m.bind(null,a,n,!1),s=m.bind(null,a,n,!0)}else a=u(t),i=function(e,t){var a=t.css,i=t.media,s=t.sourceMap;if(i&&e.setAttribute("media",i),s&&(a+="\n/*# sourceURL="+s.sources[0]+" */",a+="\n/*# sourceMappingURL=data:application/json;base64,"+btoa(unescape(encodeURIComponent(JSON.stringify(s))))+" */"),e.styleSheet)e.styleSheet.cssText=a;else{for(;e.firstChild;)e.removeChild(e.firstChild);e.appendChild(document.createTextNode(a))}}.bind(null,a),s=function(){!function(e){e.parentNode.removeChild(e);var t=c.indexOf(e);t>=0&&c.splice(t,1)}(a)};return i(e),function(t){if(t){if(t.css===e.css&&t.media===e.media&&t.sourceMap===e.sourceMap)return;i(e=t)}else s()}}e.exports=function(e,t){if("undefined"!=typeof DEBUG&&DEBUG&&"object"!=typeof document)throw new Error("The style-loader cannot be used in a non-browser environment");void 0===(t=t||{}).singleton&&(t.singleton=s()),void 0===t.insertAt&&(t.insertAt="bottom");var i=d(e);return l(i,t),function(e){for(var s=[],n=0;n<i.length;n++){var o=i[n];(r=a[o.id]).refs--,s.push(r)}for(e&&l(d(e),t),n=0;n<s.length;n++){var r;if(0===(r=s[n]).refs){for(var c=0;c<r.parts.length;c++)r.parts[c]();delete a[r.id]}}}};var h,f=(h=[],function(e,t){return h[e]=t,h.filter(Boolean).join("\n")});function m(e,t,a,i){var s=a?"":i.css;if(e.styleSheet)e.styleSheet.cssText=f(t,s);else{var n=document.createTextNode(s),o=e.childNodes;o[t]&&e.removeChild(o[t]),o.length?e.insertBefore(n,o[t]):e.appendChild(n)}}},function(e,t,a){var i=a(3);"string"==typeof i&&(i=[[e.i,i,""]]),a(8)(i,{}),i.locals&&(e.exports=i.locals)},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=a(5),s=a.n(i),n=a(12),o=a.n(n),r=a(1);t.default={extends:s.a,name:"AtTextarea",computed:{style:function(){if(this.atwho){var e=this.atwho,t=(e.list,e.cur,e.x),a=e.y,i=this.$refs.wrap,s=this.$el.querySelector("textarea");if(i)return{left:t+s.offsetLeft-s.scrollLeft+"px",top:a+s.offsetTop-s.scrollTop+"px"}}return null}},methods:{handleDelete:function(e){var t=this.$el.querySelector("textarea"),i=t.value.slice(0,t.selectionEnd);if(i){var s=this.atItems,n=this.members,o=this.suffix,c=this.deleteMatch,l=this.itemName,d=a.i(r.a)(i,s),u=d.at,p=d.index;if(p>-1){var h=i.slice(p+u.length);n.some((function(e){var t=l(e);return c(t,h,o)}))&&(t.value=t.value.slice(0,p)+t.value.slice(t.selectionEnd-1),t.selectionStart=p+1,t.selectionEnd=p+1,this.handleInput())}}},handleInput:function(e){if(!this.hasComposition){var t=this.$el.querySelector("textarea"),i=t.value.slice(0,t.selectionEnd);if(i){var s=this.atItems,n=this.avoidEmail,o=this.allowSpaces,c=!0,l=a.i(r.a)(i,s),d=l.at,u=l.index;u<0&&(c=!1);var p=i[u-1],h=i.slice(u+d.length,i.length);if(n&&/^[a-z0-9]$/i.test(p)&&(c=!1),!o&&/\s/.test(h)&&(c=!1),/^\s/.test(h)&&(c=!1),c){var f=this.members,m=this.filterMatch,y=this.itemName;e||this.$emit("at",h);var v=f.filter((function(e){var t=y(e);return m(t,h,d)}));v.length?this.openPanel(v,h,u,d,e):this.closePanel()}else this.closePanel()}}},openPanel:function(e,t,a,i){var s=this,n=function(){var n=s.$el.querySelector("textarea"),r=a+i.length,c=o()(n,r);s.atwho={chunk:t,offset:a,list:e,atEnd:r,x:c.left,y:c.top-4,cur:0}};this.atwho?n():setTimeout(n,10)},insertText:function(e,t){var a=t.selectionStart,i=t.selectionEnd;t.value=t.value.slice(0,a)+e+t.value.slice(i);var s=a+e.length;t.selectionStart=s,t.selectionEnd=s},insertItem:function(){var e=this.atwho,t=(e.chunk,e.offset,e.list),i=e.cur,s=e.atEnd,n=this.suffix,o=this.atItems,c=this.itemName,l=this.$el.querySelector("textarea"),d=l.value.slice(0,s),u=a.i(r.a)(d,o),p=u.at,h=u.index+p.length;l.selectionStart=h,l.focus();var f=c(t[i])+n;this.insertText(f,l),this.handleInput()}}}},function(e,t,a){var i=a(0)(a(10),null,null,null);e.exports=i.exports},function(e,t){e.exports=a("a0ec")}])},"562d":function(e,t,a){},5997:function(e,t,a){"use strict";a("5281")},"6c57":function(e,t,a){var i=a("23e7"),s=a("da84");i({global:!0},{globalThis:s})},"6d16":function(e,t,a){"use strict";a("8c5b")},"6dbb":function(e,t,a){},"715e":function(e,t,a){"use strict";a("562d")},"841c9":function(e,t,a){"use strict";var i=a("d784"),s=a("825a"),n=a("1d80"),o=a("129f"),r=a("14c3");i("search",1,(function(e,t,a){return[function(t){var a=n(this),i=void 0==t?void 0:t[e];return void 0!==i?i.call(t,a):new RegExp(t)[e](String(a))},function(e){var i=a(t,e,this);if(i.done)return i.value;var n=s(e),c=String(this),l=n.lastIndex;o(l,0)||(n.lastIndex=0);var d=r(n,c);return o(n.lastIndex,l)||(n.lastIndex=l),null===d?-1:d.index}]}))},"8a60":function(e,t,a){},"8c5b":function(e,t,a){},"927e":function(e,t,a){"use strict";a("17eb")},a0ec:function(e,t,a){(function(){var t=["direction","boxSizing","width","height","overflowX","overflowY","borderTopWidth","borderRightWidth","borderBottomWidth","borderLeftWidth","borderStyle","paddingTop","paddingRight","paddingBottom","paddingLeft","fontStyle","fontVariant","fontWeight","fontStretch","fontSize","fontSizeAdjust","lineHeight","fontFamily","textAlign","textTransform","textIndent","textDecoration","letterSpacing","wordSpacing","tabSize","MozTabSize"],a="undefined"!==typeof window,i=a&&null!=window.mozInnerScreenX;function s(e,s,n){if(!a)throw new Error("textarea-caret-position#getCaretCoordinates should only be called in a browser");var o=n&&n.debug||!1;if(o){var r=document.querySelector("#input-textarea-caret-position-mirror-div");r&&r.parentNode.removeChild(r)}var c=document.createElement("div");c.id="input-textarea-caret-position-mirror-div",document.body.appendChild(c);var l=c.style,d=window.getComputedStyle?window.getComputedStyle(e):e.currentStyle,u="INPUT"===e.nodeName;l.whiteSpace="pre-wrap",u||(l.wordWrap="break-word"),l.position="absolute",o||(l.visibility="hidden"),t.forEach((function(e){u&&"lineHeight"===e?l.lineHeight=d.height:l[e]=d[e]})),i?e.scrollHeight>parseInt(d.height)&&(l.overflowY="scroll"):l.overflow="hidden",c.textContent=e.value.substring(0,s),u&&(c.textContent=c.textContent.replace(/\s/g," "));var p=document.createElement("span");p.textContent=e.value.substring(s)||".",c.appendChild(p);var h={top:p.offsetTop+parseInt(d["borderTopWidth"]),left:p.offsetLeft+parseInt(d["borderLeftWidth"]),height:parseInt(d["lineHeight"])};return o?p.style.backgroundColor="#aaa":document.body.removeChild(c),h}"undefined"!=typeof e.exports?e.exports=s:a&&(window.getCaretCoordinates=s)})()},a5fd:function(e,t,a){},b412:function(e,t,a){},b48b:function(e,t,a){},bd09:function(e,t,a){},c219:function(e,t,a){"use strict";a("c470")},c470:function(e,t,a){},c740:function(e,t,a){"use strict";var i=a("23e7"),s=a("b727").findIndex,n=a("44d2"),o="findIndex",r=!0;o in[]&&Array(1)[o]((function(){r=!1})),i({target:"Array",proto:!0,forced:r},{findIndex:function(e){return s(this,e,arguments.length>1?arguments[1]:void 0)}}),n(o)},cb7d:function(e,t,a){"use strict";a("4b40")},df28:function(e,t,a){},e0d7:function(e,t,a){"use strict";a("8a60")},ee83:function(e,t,a){"use strict";a("bd09")},f1b2:function(e,t,a){"use strict";a("4981")}}]);
//# sourceMappingURL=chunk-07568022.242b42f2.js.map